
<!DOCTYPE html>
<html lang="en-UK">
<head>
<meta charset="UTF-8" />
<meta name="generator" content="LaTeX Lwarp package" />
<meta name="description" content="Lecture notes for Hamiltonian Mechanics" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Hamiltonian Mechanics — Hamiltonian mechanics</title>
<link rel="stylesheet" type="text/css" href="lwarp.css" />

<script>
// Lwarp MathJax emulation code
//
// Based on code by Davide P. Cervone.
// Equation numbering: https://github.com/mathjax/MathJax/issues/2427
// Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
// \left, \right delimiters: https://github.com/mathjax/MathJax/issues/2535
//
// Modified by Brian Dunn to adjust equation numbering and add subequations.
//
// LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
// subequations? is 0 usually, 1 if inside subequations.
// section is a string printed as-is, or empty.
// number is auto-incremented by MathJax between equations.
//
MathJax = {
    subequations: "0",
    section: "",
    loader: {
         load: ['[tex]/tagformat', '[tex]/textmacros'],
    },
    startup: {
         ready() {
             //       These would be replaced by import commands if you wanted to make
             //       a proper extension.
             const Configuration = MathJax._.input.tex.Configuration.Configuration;
             const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
             const Macro = MathJax._.input.tex.Symbol.Macro;
             const TexError = MathJax._.input.tex.TexError.default;
             const ParseUtil = MathJax._.input.tex.ParseUtil.default;
             const expandable = MathJax._.util.Options.expandable;


             //       Insert the replacement string into the TeX string, and check
             //       that there haven't been too many maxro substitutions (prevents
             //       infinite loops).
             const useArgument = (parser, text) => {
                 parser.string = ParseUtil.addArgs(parser, text, parser.string.slice(parser.i));
                 parser.i = 0;
                 if (++parser.macroCount > parser.configuration.options.maxMacros) {
                     throw new TexError('MaxMacroSub1',
                     'MathJax maximum macro substitution count exceeded; ' +
                     'is there a recursive macro call?');
                 }
             }


             //       Create the command map for:
             //          \ifstar, \ifnextchar, \ifblank, \ifstrequal, \gsub, \seteqnumber
             new CommandMap('Lwarp-macros', {
                 ifstar: 'IfstarFunction',
                 ifnextchar: 'IfnextcharFunction',
                 ifblank: 'IfblankFunction',
                 ifstrequal: 'IfstrequalFunction',
                 gsubstitute: 'GsubstituteFunction',
                 seteqnumber: 'SeteqnumberFunction'
             }, {
                 //      This function implements an ifstar macro.
                 IfstarFunction(parser, name) {
                     const resultstar = parser.GetArgument(name);
                     const resultnostar = parser.GetArgument(name);
                     const star = parser.GetStar();                        // true if there is a *
                     useArgument(parser, star ? resultstar : resultnostar);
                 },


                 //      This function implements an ifnextchar macro.
                 IfnextcharFunction(parser, name) {
                     let whichchar = parser.GetArgument(name);
                     if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
                         // $ syntax highlighting
                         whichchar = String.fromCodePoint(parseInt(whichchar));
                     }
                     const resultnextchar = parser.GetArgument(name);
                     const resultnotnextchar = parser.GetArgument(name);
                     const gotchar = (parser.GetNext() === whichchar);
                     useArgument(parser, gotchar ? resultnextchar : resultnotnextchar);
                 },


                 // This function implements an ifblank macro.
                 IfblankFunction(parser, name) {
                     const blankarg = parser.GetArgument(name);
                     const resultblank = parser.GetArgument(name);
                     const resultnotblank = parser.GetArgument(name);
                     const isblank = (blankarg.trim() == "");
                     useArgument(parser, isblank ? resultblank : resultnotblank);
                 },


                 // This function implements an ifstrequal macro.
                 IfstrequalFunction(parser, name) {
                     const strequalfirst = parser.GetArgument(name);
                     const strequalsecond = parser.GetArgument(name);
                     const resultequal = parser.GetArgument(name);
                     const resultnotequal = parser.GetArgument(name);
                     const isequal = (strequalfirst == strequalsecond);
                     useArgument(parser, isequal ? resultequal : resultnotequal);
                 },


                 // This function implements a gsub macro.
                 GsubstituteFunction(parser, name) {
                     const gsubfirst = parser.GetArgument(name);
                     const gsubsecond = parser.GetArgument(name);
                     const gsubthird = parser.GetArgument(name);
                     let gsubresult=gsubfirst.replace(gsubsecond, gsubthird);
                     useArgument(parser, gsubresult);
                 },


                 //      This function modifies the equation numbers.
                 SeteqnumberFunction(parser, name) {
                         //   Get the macro parameters
                         const star = parser.GetStar();                       // true if there is a *
                         const optBrackets = parser.GetBrackets(name);        // contents of optional brackets
                         const newsubequations = parser.GetArgument(name);       // the subequations argument
                         const neweqsection = parser.GetArgument(name);       // the eq section argument
                         const neweqnumber = parser.GetArgument(name);        // the eq number argument
                         MathJax.config.subequations=newsubequations ;        // a string with boolean meaning
                         MathJax.config.section=neweqsection ;                // a string with numeric meaning
                         parser.tags.counter = parser.tags.allCounter = neweqnumber ;
                 }


             });


             //       Create the Lwarp-macros package
             Configuration.create('Lwarp-macros', {
                 handler: {macro: ['Lwarp-macros']}
             });


             MathJax.startup.defaultReady();


             // For forward references:
             MathJax.startup.input[0].preFilters.add(({math}) => {
                 if (math.inputData.recompile){
                         MathJax.config.subequations = math.inputData.recompile.subequations;
                         MathJax.config.section = math.inputData.recompile.section;
                 }
             });
             MathJax.startup.input[0].postFilters.add(({math}) => {
                 if (math.inputData.recompile){
                         math.inputData.recompile.subequations = MathJax.config.subequations;
                         math.inputData.recompile.section = MathJax.config.section;
                 }
             });


                 // For \left, \right with unicode-math:
                 const {DelimiterMap} = MathJax._.input.tex.SymbolMap;
                 const {Symbol} = MathJax._.input.tex.Symbol;
                 const {MapHandler} = MathJax._.input.tex.MapHandler;
                 const delimiter = MapHandler.getMap('delimiter');
                 delimiter.add('\\lBrack', new Symbol('\\lBrack', '\u27E6'));
                 delimiter.add('\\rBrack', new Symbol('\\rBrack', '\u27E7'));
                 delimiter.add('\\lAngle', new Symbol('\\lAngle', '\u27EA'));
                 delimiter.add('\\rAngle', new Symbol('\\rAngle', '\u27EB'));
                 delimiter.add('\\lbrbrak', new Symbol('\\lbrbrak', '\u2772'));
                 delimiter.add('\\rbrbrak', new Symbol('\\rbrbrak', '\u2773'));
                 delimiter.add('\\lbag', new Symbol('\\lbag', '\u27C5'));
                 delimiter.add('\\rbag', new Symbol('\\rbag', '\u27C6'));
                 delimiter.add('\\llparenthesis', new Symbol('\\llparenthesis', '\u2987'));
                 delimiter.add('\\rrparenthesis', new Symbol('\\rrparenthesis', '\u2988'));
                 delimiter.add('\\llangle', new Symbol('\\llangle', '\u2989'));
                 delimiter.add('\\rrangle', new Symbol('\\rrangle', '\u298A'));
                 delimiter.add('\\Lbrbrak', new Symbol('\\Lbrbrak', '\u27EC'));
                 delimiter.add('\\Rbrbrak', new Symbol('\\Rbrbrak', '\u27ED'));
                 delimiter.add('\\lBrace', new Symbol('\\lBrace', '\u2983'));
                 delimiter.add('\\rBrace', new Symbol('\\rBrace', '\u2984'));
                 delimiter.add('\\lParen', new Symbol('\\lParen', '\u2985'));
                 delimiter.add('\\rParen', new Symbol('\\rParen', '\u2986'));
                 delimiter.add('\\lbrackubar', new Symbol('\\lbrackubar', '\u298B'));
                 delimiter.add('\\rbrackubar', new Symbol('\\rbrackubar', '\u298C'));
                 delimiter.add('\\lbrackultick', new Symbol('\\lbrackultick', '\u298D'));
                 delimiter.add('\\rbracklrtick', new Symbol('\\rbracklrtick', '\u298E'));
                 delimiter.add('\\lbracklltick', new Symbol('\\lbracklltick', '\u298F'));
                 delimiter.add('\\rbrackurtick', new Symbol('\\rbrackurtick', '\u2990'));
                 delimiter.add('\\langledot', new Symbol('\\langledot', '\u2991'));
                 delimiter.add('\\rangledot', new Symbol('\\rangledot', '\u2992'));
                 delimiter.add('\\lparenless', new Symbol('\\lparenless', '\u2993'));
                 delimiter.add('\\rparengtr', new Symbol('\\rparengtr', '\u2994'));
                 delimiter.add('\\Lparengtr', new Symbol('\\Lparengtr', '\u2995'));
                 delimiter.add('\\Rparenless', new Symbol('\\Rparenless', '\u2996'));
                 delimiter.add('\\lblkbrbrak', new Symbol('\\lblkbrbrak', '\u2997'));
                 delimiter.add('\\rblkbrbrak', new Symbol('\\rblkbrbrak', '\u2998'));
                 delimiter.add('\\lvzigzag', new Symbol('\\lvzigzag', '\u29D8'));
                 delimiter.add('\\rvzigzag', new Symbol('\\rvzigzag', '\u29D9'));
                 delimiter.add('\\Lvzigzag', new Symbol('\\Lvzigzag', '\u29DA'));
                 delimiter.add('\\Rvzigzag', new Symbol('\\Rvzigzag', '\u29DB'));
                 delimiter.add('\\lcurvyangle', new Symbol('\\lcurvyangle', '\u29FC'));
                 delimiter.add('\\rcurvyangle', new Symbol('\\rcurvyangle', '\u29FD'));
                 delimiter.add('\\Vvert', new Symbol('\\Vvert', '\u2980'));
         }       // ready
    },           // startup


    tex: {
         packages: {'[+]': ['tagformat', 'Lwarp-macros', 'textmacros']},
         tags: "ams",
                 tagformat: {
                         number: function (n) {
                              if(MathJax.config.subequations==0)
                                     return(MathJax.config.section + n);
                              else
                                     return(MathJax.config.section + String.fromCharCode(96+n));
                         },
                 },
    }
}
</script>


<script
         id="MathJax-script"
         src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"
></script>

</head>
<body>


<a id="hm-autopage-157"></a>
<nav class="topnavigation"><a href="index.html" class="linkhome" >
Home</a></nav>


<div class="bodyandsidetoc">
<div class="sidetoccontainer">


<nav class="sidetoc">


<div class="sidetoctitle">

<p>
<span class="sidetocthetitle">Hamiltonian Mechanics</span>
</p>

<p>
Contents
</p>
</div>


<div class="sidetoccontents">

<p>
<a href="index.html" class="linkhome" >
Home</a>
</p>

<p>
<a href="chapter-1.html#autosec-7" class="tocchapter" >
<span class="sectionnumber">1</span>&#x2003;Classical mechanics</a>
</p>


<p>
<a href="chapter-1.html#autosec-8" class="tocsection" >
<span class="sectionnumber">1.1</span>&#x2003;Newtonian mechanics of point particles</a>
</p>


<p>
<a href="chapter-1.html#autosec-21" class="tocsection" >
<span class="sectionnumber">1.2</span>&#x2003;Hamilton’s variational principle</a>
</p>


<p>
<a href="chapter-1.html#autosec-47" class="tocsection" >
<span class="sectionnumber">1.3</span>&#x2003;First steps with conserved quantities</a>
</p>


<p>
<a href="chapter-1.html#autosec-68" class="tocsection" >
<span class="sectionnumber">1.4</span>&#x2003;Euler-Lagrange equations on smooth manifolds</a>
</p>


<p>
<a href="chapter-2.html#autosec-79" class="tocchapter" >
<span class="sectionnumber">2</span>&#x2003;Conservation Laws</a>
</p>


<p>
<a href="chapter-2.html#autosec-80" class="tocsection" >
<span class="sectionnumber">2.1</span>&#x2003;Noether theorem</a>
</p>


<p>
<a href="chapter-2.html#autosec-110" class="tocsection" >
<span class="sectionnumber">2.2</span>&#x2003;The spherical pendulum</a>
</p>


<p>
<a href="chapter-2.html#autosec-113" class="tocsection" >
<span class="sectionnumber">2.3</span>&#x2003;Intermezzo: small oscillations</a>
</p>


<p>
<a href="chapter-2.html#autosec-124" class="tocsection" >
<span class="sectionnumber">2.4</span>&#x2003;Motion in a central potential</a>
</p>


<p>
<a href="chapter-2.html#autosec-143" class="tocsection" >
<span class="sectionnumber">2.5</span>&#x2003;D’Alembert principle and systems with constraints</a>
</p>


<p>
<a href="chapter-3.html#autosec-158" class="tocchapter" >
<span class="sectionnumber">3</span>&#x2003;Hamiltonian mechanics</a>
</p>


<p>
<a href="chapter-3.html#autosec-159" class="tocsection" >
<span class="sectionnumber">3.1</span>&#x2003;The Legendre Transform in the euclidean plane</a>
</p>


<p>
<a href="chapter-3.html#autosec-161" class="tocsection" >
<span class="sectionnumber">3.2</span>&#x2003;Intermezzo: cotangent bundle and differential forms</a>
</p>


<p>
<a href="chapter-3.html#autosec-162" class="tocsection" >
<span class="sectionnumber">3.3</span>&#x2003;The Legendre Transform</a>
</p>


<p>
<a href="chapter-3.html#autosec-183" class="tocsection" >
<span class="sectionnumber">3.4</span>&#x2003;Poisson brackets and first integrals of motion</a>
</p>


<p>
<a href="chapter-3.html#autosec-196" class="tocsection" >
<span class="sectionnumber">3.5</span>&#x2003;Variational principles of hamiltonian mechanics</a>
</p>


<p>
<a href="chapter-3.html#autosec-209" class="tocsection" >
<span class="sectionnumber">3.6</span>&#x2003;Canonical transformations</a>
</p>


<p>
<a href="chapter-3.html#autosec-231" class="tocsection" >
<span class="sectionnumber">3.7</span>&#x2003;The symplectic structure on the cotangent bundle</a>
</p>


<p>
<a href="chapter-4.html#autosec-266" class="tocchapter" >
<span class="sectionnumber">4</span>&#x2003;Integrable systems</a>
</p>


<p>
<a href="chapter-4.html#autosec-267" class="tocsection" >
<span class="sectionnumber">4.1</span>&#x2003;Lagrangian submanifolds</a>
</p>


<p>
<a href="chapter-4.html#autosec-276" class="tocsection" >
<span class="sectionnumber">4.2</span>&#x2003;Canonical transformations revisited</a>
</p>


<p>
<a href="chapter-4.html#autosec-299" class="tocsection" >
<span class="sectionnumber">4.3</span>&#x2003;Hamilton-Jacobi equations</a>
</p>


<p>
<a href="chapter-4.html#autosec-313" class="tocsection" >
<span class="sectionnumber">4.4</span>&#x2003;The Liouville-Arnold theorem</a>
</p>


<p>
<a href="chapter-5.html#autosec-332" class="tocchapter" >
<span class="sectionnumber">5</span>&#x2003;Hamiltonian perturbation theory</a>
</p>


<p>
<a href="chapter-5.html#autosec-333" class="tocsection" >
<span class="sectionnumber">5.1</span>&#x2003;Small oscillations revisited</a>
</p>


<p>
<a href="chapter-5.html#autosec-341" class="tocsection" >
<span class="sectionnumber">5.2</span>&#x2003;Birkhoff normal forms</a>
</p>


<p>
<a href="chapter-5.html#autosec-345" class="tocsection" >
<span class="sectionnumber">5.3</span>&#x2003;A brief look at KAM theory</a>
</p>


<p>
<a href="chapter-5.html#autosec-349" class="tocsection" >
<span class="sectionnumber">5.4</span>&#x2003;Nekhoroshev theorem</a>
</p>


<p>
<a href="chapter-6.html#autosec-352" class="tocchapter" >
<span class="sectionnumber">6</span>&#x2003;Conclusion</a>
</p>


<p>
<a href="chapter-6.html#autosec-352" class="tocchapter" >
Bibliography</a>
</p>


</div>

</nav>

</div>


<main class="bodycontainer">


<section class="textbody">

<h1>Hamiltonian Mechanics</h1>

<!--MathJax customizations:-->
<div data-nosnippet
    style="display:none"
>

\(\newcommand{\footnotename}{footnote}\)

\(\def \LWRfootnote {1}\)

\(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\let \LWRorighspace \hspace \)

\(\renewcommand {\hspace }{\ifstar \LWRorighspace \LWRorighspace }\)

\(\newcommand {\mathnormal }[1]{{#1}}\)

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\arabic }[1]{}\)

\(\newcommand {\number }[1]{}\)

\(\newcommand {\noalign }[1]{\text {#1}\notag \\}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\protect }{}\)

\(\def \LWRabsorbnumber #1 {}\)

\(\def \LWRabsorbquotenumber &quot;#1 {}\)

\(\newcommand {\LWRabsorboption }[1][]{}\)

\(\newcommand {\LWRabsorbtwooptions }[1][]{\LWRabsorboption }\)

\(\def \mathchar {\ifnextchar &quot;\LWRabsorbquotenumber \LWRabsorbnumber }\)

\(\def \mathcode #1={\mathchar }\)

\(\let \delcode \mathcode \)

\(\let \delimiter \mathchar \)

\(\def \oe {\unicode {x0153}}\)

\(\def \OE {\unicode {x0152}}\)

\(\def \ae {\unicode {x00E6}}\)

\(\def \AE {\unicode {x00C6}}\)

\(\def \aa {\unicode {x00E5}}\)

\(\def \AA {\unicode {x00C5}}\)

\(\def \o {\unicode {x00F8}}\)

\(\def \O {\unicode {x00D8}}\)

\(\def \l {\unicode {x0142}}\)

\(\def \L {\unicode {x0141}}\)

\(\def \ss {\unicode {x00DF}}\)

\(\def \SS {\unicode {x1E9E}}\)

\(\def \dag {\unicode {x2020}}\)

\(\def \ddag {\unicode {x2021}}\)

\(\def \P {\unicode {x00B6}}\)

\(\def \copyright {\unicode {x00A9}}\)

\(\def \pounds {\unicode {x00A3}}\)

\(\let \LWRref \ref \)

\(\renewcommand {\ref }{\ifstar \LWRref \LWRref }\)

\( \newcommand {\multicolumn }[3]{#3}\)

\(\require {textcomp}\)

\(\newcommand {\toprule }[1][]{\hline }\)

\(\let \midrule \toprule \)

\(\let \bottomrule \toprule \)

\(\def \LWRbooktabscmidruleparen (#1)#2{}\)

\(\newcommand {\LWRbooktabscmidrulenoparen }[1]{}\)

\(\newcommand {\cmidrule }[1][]{\ifnextchar (\LWRbooktabscmidruleparen \LWRbooktabscmidrulenoparen }\)

\(\newcommand {\morecmidrules }{}\)

\(\newcommand {\specialrule }[3]{\hline }\)

\(\newcommand {\addlinespace }[1][]{}\)

\(\newcommand {\intertext }[1]{\text {#1}\notag \\}\)

\(\let \Hat \hat \)

\(\let \Check \check \)

\(\let \Tilde \tilde \)

\(\let \Acute \acute \)

\(\let \Grave \grave \)

\(\let \Dot \dot \)

\(\let \Ddot \ddot \)

\(\let \Breve \breve \)

\(\let \Bar \bar \)

\(\let \Vec \vec \)

\(\require {physics}\)

\(\newcommand {\nicefrac }[3][]{\mathinner {{}^{#2}\!/\!_{#3}}}\)

\(\newcommand {\unit }[2][]{#1 \mathinner {#2}}\)

\(\newcommand {\unitfrac }[3][]{#1 \mathinner {{}^{#2}\!/\!_{#3}}}\)

\(\newcommand {\tcbset }[1]{}\)

\(\newcommand {\tcbsetforeverylayer }[1]{}\)

\(\newcommand {\tcbox }[2][]{\boxed {\text {#2}}}\)

\(\newcommand {\tcboxfit }[2][]{\boxed {#2}}\)

\(\newcommand {\tcblower }{}\)

\(\newcommand {\tcbline }{}\)

\(\newcommand {\tcbtitle }{}\)

\(\newcommand {\tcbsubtitle [2][]{\mathrm {#2}}}\)

\(\newcommand {\tcboxmath }[2][]{\boxed {#2}}\)

\(\newcommand {\tcbhighmath }[2][]{\boxed {#2}}\)

\( \DeclareMathOperator {\D }{D} \DeclareMathOperator {\Id }{Id} \DeclareMathOperator {\diag }{diag} \DeclareMathOperator {\mod }{mod} \DeclareMathOperator {\Vol }{Vol} \)

</div>

<!--
...... chapter Hamiltonian mechanics ......
-->
<h3 id="autosec-158"><span class="sectionnumber">3&#x2003;</span>Hamiltonian mechanics</h3>
<a id="hm-autopage-158"></a>
<a id="hm-autofile-3"></a>

<p>
In this chapter we start our investigation of the hamiltonian formalism. We have already seen glimpses of it throughout some of the exercises and examples in the previous chapter, but only scratched the surface. We will see how this, seemingly
harmless, change of perspective will reveal much more about the geometric structure underlying classical dynamics.
</p>

<p>
In the lagrangian formulation for a system with \(n\) degrees of freedom and lagrangian function \(L=L(q, \dot q)\), we have seen that the equations of motion are encoded by the Euler-Lagrange equations, which are \(n\) second order differential
equations in \(q\), requiring \(2n\) initial conditions, say \(q(0)\) and \(\dot q(0)\).
</p>

<p>
In the previous chapters, we saw that the \(n\) generalized momenta
</p>

<span class="hidden"> \(\seteqnumber{0}{}{0}\)</span>

<!--

                                                                                                                         ∂L
                                                                                                                 pi =           ,   i = 1, . . . , n,                                                                                                 (3.1)
                                                                                                                         ∂ q̇ i

-->

<p>

\begin{equation}
p_i = \frac {\partial L}{\partial \dot q^i}, \quad i=1,\ldots ,n,
\end{equation}

</p>

<p>
play a relevant role in the first integrals at the core of Noether theorem, and in particular in the conservation of energy. If we then look at the Euler-Lagrange equations and revisit them in terms of the momenta, they acquire the nice form
</p>

<span class="hidden"> \(\seteqnumber{0}{}{1}\)</span>

<!--

                                                                                                                         ∂L
                                                                                                                 ṗi =        ,     i = 1, . . . , n.                                                                                                 (3.2)
                                                                                                                         ∂q i

-->

<p>

\begin{equation}
\dot p_i = \frac {\partial L}{\partial q^i}, \quad i=1,\ldots ,n.
\end{equation}

</p>

<p>
Which seems to bring a nice symmetry between the coordinates and the momenta, and seems to allow us to reduce the problem to a first order system of equations.
</p>

<p>
Our current quest is then to find a function of \(q\) and \(p\) (and not of \(\dot q\)) which contains the same information as the lagrangian \(L\), allowing us to determine the unique evolution of \(q\) and \(p\), but bringing the two variables to
more equal footings.
</p>

<p>
Theorem&nbsp;<a href="chapter-1.html#thm:ham1">1.6</a> and Theorem&nbsp;<a href="chapter-1.html#thm:conservationEnergy">1.7</a> provided us with some useful hints. Before entering into the gist of the matter, let’s reason in two
dimensions and mimic our derivation of Theorem&nbsp;<a href="chapter-1.html#thm:ham1">1.6</a>
</p>
<!--
...... section The Legendre Transform in the euclidean plane ......
-->
<h4 id="autosec-159"><span class="sectionnumber">3.1&#x2003;</span>The Legendre Transform in the euclidean plane</h4>
<a id="hm-autopage-159"></a>


<p>
In this section we’ll be a bit sloppy, please bear with me. Let’s start considering the total derivative of an arbitrary function \(f(x,y)\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{2}\)</span>

<!--

                                                                                                                            ∂f      ∂f
                                                                                                                     df =      dx +    dy,                                                                                                                 (3.3)
                                                                                                                            ∂x      ∂y

-->

<p>

\begin{equation}
\dd f = \frac {\partial f}{\partial x} \dd x + \frac {\partial f}{\partial y} \dd y,
\end{equation}

</p>

<p>
and defining a new function of three variables \(x,y,u\):
</p>

<span class="hidden"> \(\seteqnumber{0}{}{3}\)</span>

<!--


                                                                                                                   g(x, y, u) = ux − f (x, y).                                                                                                             (3.4)

-->

<p>

\begin{equation}
g(x,y,u) = ux - f(x,y).
\end{equation}

</p>

<p>
The total derivative of \(g\) is then given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{4}\)</span>

<!--

                                                                                                ∂f      ∂f
                                                               dg = d(ux) − df = udx + xdu −       dx −    dy.                                                               (3.5)                                          --><a id="eq:hamdgex"></a><!--
                                                                                                ∂x      ∂y

-->

<p>

\begin{equation}
\label {eq:hamdgex} \dd g = \dd (ux) - \dd f = u\dd x + x \dd u - \frac {\partial f}{\partial x} \dd x - \frac {\partial f}{\partial y} \dd y.
\end{equation}

</p>

<p>
Even though \(u\) is a free variable, let’s assume for the sake of the argument that we choose it to be a specific function of \(x\) and \(y\), say
</p>

<span class="hidden"> \(\seteqnumber{0}{}{5}\)</span>

<!--

                                                                                                                                     ∂f
                                                                                                                         u(x, y) =      .                                                                                                                  (3.6)
                                                                                                                                     ∂x
-->

<p>

\begin{equation}
u(x,y) = \frac {\partial f}{\partial x}.
\end{equation}

</p>

<p>
Then <span class="textup">(<a href="chapter-3.html#eq:hamdgex">3.5</a>)</span> simplifies into
</p>

<span class="hidden"> \(\seteqnumber{0}{}{6}\)</span>

<!--

                                                                                                                                     ∂f
                                                                                                                       dg = xdu −       dy,                                                                                                                (3.7)
                                                                                                                                     ∂y

-->

<p>

\begin{equation}
\dd g = x \dd u - \frac {\partial f}{\partial y} \dd y,
\end{equation}

</p>

<p>
i.e., \(g=g(y,u)\) could be considered a function of just \(y\) and \(u\). Inverting \(x = x(y,u)\), we could write down \(g\) explicitly as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{7}\)</span>

<!--


                                                                                                               g(y, u) = u x(y, u) − f (x(y, u), y).                                                                                                       (3.8)

-->

<p>

\begin{equation}
g(y,u) = u\, x(y,u) - f(x(y, u), y).
\end{equation}

</p>

<p>
We have just described an operation which takes a function \(f(x,y)\) to a different function \(g(y,u)\) where \(u = \frac {\partial f}{\partial x}\) <em>without losing any information</em>: we can recover \(f(x,y)\) from \(g(y,u)\) by
observing that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{8}\)</span>

<!--

                                                                                                                  ∂g                ∂g   ∂f
                                                                                                                     = x and           =− ,                                                                                                                (3.9)
                                                                                                                  ∂u                ∂y   ∂y

-->

<p>

\begin{equation}
\frac {\partial g}{\partial u} = x \quad \mbox {and}\quad \frac {\partial g}{\partial y} = - \frac {\partial f}{\partial y},
\end{equation}

</p>

<p>
which ensures that we can invert the transformation to get \(f(x,y) = \frac {\partial g}{\partial u}u - g\).
</p>

<p>
We have just described the Legendre transform. If you look carefully you may recognize it in Theorem&nbsp;<a href="chapter-1.html#thm:conservationEnergy">1.7</a>.
</p>

<p>
The geometrical meaning of the Legendre transform is best captured with a picture<sup>1</sup>, although I don’t believe this will justify it more or less than the description before. For a fixed \(y\), draw the curves \(f(x) = f(x,y)\) and \(ux\).
For each slope \(u\), the value of \(g(u) = g(u,y) = \max _x (ux - f(x))\) measures the maximal distance between the two curves \(f(x)\) and \(ux\): finding the maximum of such distance means computing
</p>

<span class="hidden"> \(\seteqnumber{0}{}{9}\)</span>

<!--

                                                                                                              ∂                                    ∂f
                                                                                                                 (ux − f (x)) = 0     →       u=      .                                                                                                   (3.10)
                                                                                                              ∂x                                   ∂x
-->

<p>

\begin{equation}
\frac {\partial }{\partial x}(ux - f(x)) = 0 \quad \rightarrow \quad u = \frac {\partial f}{\partial x}.
\end{equation}

</p>

<p>
Note that in the computation above we are assuming that a maximum exists: this hints to the fact that the Legendre transformation can only be applied to <em>convex functions</em>.
</p>

<p>
One advantage of this geometric approach is that the procedure is meaningful also on non-convex functions, even if this comes at the cost of losing involutivity, i.e. the function is the inverse of itself only on the space of convex (or concave) functions.
You can read more about this on convex optimization books<sup>2</sup>, where is often called convex conjugation or Legendre-Fenchel transform.
</p>

<p>
In the next section we will explicit this discussion rigorously and in greater generality.
</p>
<div role="note" class="footnotes">

<a id="hm-autopage-160"></a>
<p>
<sup>1</sup>&nbsp;Metaphorically, but I should probably add a sketch here.
</p>

<p>
<sup>2</sup>&nbsp;Or read <a href="https://web.archive.org/web/20211127141805/https://jmanton.wordpress.com/2010/11/21/introduction-to-the-legendre-transform/" target="_blank" >this rather detailed blog post</a> or <a
href="https://web.archive.org/web/20170407134235/http://www.physics.sun.ac.za/~htouchette/archive/notes/lfth2.pdf" target="_blank" >these notes</a>.
</p>


</div>
<!--
...... section Intermezzo: cotangent bundle and differential forms ......
-->
<h4 id="autosec-161"><span class="sectionnumber">3.2&#x2003;</span>Intermezzo: cotangent bundle and differential forms</h4>
<a id="hm-autopage-161"></a>


<p>
Again we will briefly present the basic concepts, you can refer to [<a href="chapter-6.html#LWR-ht-cite.0@book:lee">J.M13</a>] or [<a href="chapter-6.html#LWR-ht-cite.0@lectures:aom:seri">Ser20</a>, Chapters 5-7] for further details.
</p>

<p>
Given an \(n\)-dimensional vector space \(V\) spanned by a basis \(\{e_1, \ldots , e_n\}\), we can define its <em>dual</em> space as the space \(V^* = \{f : V \to \mathbb {R} \; \mbox {linear}\}\) of linear functions from \(V\) to
\(\mathbb {R}\). As a basis for the dual space we can define the dual basis \(\{e^1, \ldots , e^n\}\) as the linear maps such that \(e^i(e_j) = \delta ^i_j\). Since any linear function is determined by its action on a basis element, we can
determine any \(\sigma \in V^*\) by computing its coefficients \(\sigma _i = \sigma (e_i)\). Then \(\sigma = \sigma _i e^i\).
</p>

<p>
We have seen that tangent vectors at a point \(q\) on a smooth manifold \(P\) are elements of a \(n\)-dimensional vector space, the tangent space \(T_x P\), and in coordinates they take the form \(v^i \frac {\partial }{\partial x^i}\). We
can then use the theory of the previous paragraph to define the dual space to \(T_x P\), the <em>cotangent space</em> \(T^*_x P\). We call elements of the cotangent space at \(x\), <em>covectors</em> or one-forms at \(x\).
</p>

<p>
It is convenient to denote the dual basis to \(\{\frac {\partial }{\partial x^i} \mid 1\leq i \leq n\}\) by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{10}\)</span>

<!--

                                                                                                                                                               
                                                                                                                                                           ∂
                                                                                                                   {dxi | 1 ≤ i ≤ n},        dxi                    = δji .                                                                            (3.11)
                                                                                                                                                          ∂xj

-->

<p>

\begin{equation}
\{ \dd x^i \mid 1 \leq i \leq n \}, \quad \dd x^i\left (\frac {\partial }{\partial x^j}\right ) = \delta _j^i.
\end{equation}

</p>

<p>
Even though we settled on the pushforward notation \(\phi _*\) for differentials, we have already seen the \(\dd \) appearing as alternative notation in the definition of the differential of a function. How is it related to one-forms? Observe that for
\(f : P \to \mathbb {R}\), we have
</p>
<span class="hidden"> \(\seteqnumber{0}{}{11}\)</span>


<!--



                                                                                                                          dfx :Tx P → Tf (x) R ≃ R                                                                                                     (3.12)
                                                                                                                                            ∂        ∂f
                                                                                                                                vx = ẋi       7→ ẋi i .                                                                                              (3.13)
                                                                                                                                           ∂xi       ∂x


-->


<p>

\begin{align}
\dd f_x : &amp; T_x P \to T_{f(x)} \mathbb {R} \simeq \mathbb {R} \\ &amp; v_x = \dot x^i \frac {\partial }{\partial x^i} \mapsto \dot x^i \frac {\partial f}{\partial x^i}.
\end{align}
Since derivations are linear maps, identifying the one-dimensional vector space \(T_{f(x)}\mathbb {R} \simeq \mathbb {R}\) with the reals (it is really just about sending the local basis of the tangent space to \(1\) as done in the equation just
above), we can view \(\dd f_x\) as a linear map from \(T_x P \to \mathbb {R}\), that is as a differential one-form at \(x\). What are its coefficients? Let’s apply the recipe described at the beginning of the section and compute
</p>

<span class="hidden"> \(\seteqnumber{0}{}{13}\)</span>

<!--

                                                                                                                                                 
                                                                                                                                             ∂             ∂f (x)
                                                                                                                       (dfx )i = dfx                  =           .                                                                                    (3.14)
                                                                                                                                            ∂xi             ∂xi

-->

<p>

\begin{equation}
(\dd f_x)_i = \dd f_x\left (\frac {\partial }{\partial x^i}\right ) = \frac {\partial f(x)}{\partial x^i}.
\end{equation}

</p>

<p>
That is, \(\dd f_x = \frac {\partial f(x)}{\partial x^i} \dd x^i\). As you can see, this is directly generalizing the same concepts from multivariable analysis.
</p>

<p>
Analogously to tangent bundles, we can glue cotangent spaces and define the <em>cotangent bundle</em> as \(T^*P := \cup _{x\in P} \{x\}\times T^*_x P\). Also the cotangent bundle is a \(2n\)-dimensional smooth manifold. The concept of
differential forms extends to the cotangent bundle in a similar way as vector fields generalized the notion of tangent vectors to the level of the tangent bundle: a differential one-form on \(P\) is a map \(\sigma : x\in P \mapsto \sigma (x) \in
T^*_x P\).
</p>

<p>
We are almost there, we need just a few more concepts. First of all we will need to talk about differential two-forms, these are a particular family of antisymmetric bilinear maps \(TP \times TP \to \mathbb {R}\). Given two one-forms \(\sigma \)
and \(\nu \) we can define a two-form using an operation called <em>wedge product</em>: \(\sigma \wedge \nu \) is the antisymmetric bilinear map such that for all \(X,Y \in TP\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{14}\)</span>

<!--


                                                                                                                  σ ∧ ν(X, Y ) := σ(X)ν(Y ) − σ(Y )ν(X).                                                                                               (3.15)

-->

<p>

\begin{equation}
\sigma \wedge \nu (X,Y) := \sigma (X)\nu (Y) - \sigma (Y)\nu (X).
\end{equation}

</p>

<p>
Any two-form can be written in terms of the basis \(\{\dd x^i\wedge \dd x^j\}\). Due to antisymmetry \(dx^i \wedge \dd x^j = - \dd x^j \wedge \dd x^i\), so one can simplify formulas by summing over ordered indices \(i&lt;j\) and
considering only half of the terms. Also due to antisymmetry, \(\dd x^i \wedge \dd x^i = 0\). As a linear map, we can associate to any two-form \(\sigma \) an antisymmetric matrix \(S\) whose coefficient are computed by evaluating \(\sigma
\) over basis elements: \(S_{ij} = \sigma \left (\frac {\partial }{\partial x^i}, \frac {\partial }{\partial x^j}\right )\).
</p>

<p>
The <em>contraction</em> (or interior product) \(\iota _X\) of a one–form \(\theta = \theta _l(x)\dd x^l\) with a vector field \(X = X^l(x)\frac {\partial }{\partial x^l}\) is the natural pairing between the tangent and cotangent space:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{15}\)</span>

<!--


                                                                                                                ιX θ : P → R,       ιX θ := θ(X) = θl (x)X l (x).                                                                                      (3.16)

-->

<p>

\begin{equation}
\iota _X \theta : P \to \mathbb {R}, \quad \iota _X \theta := \theta (X) = \theta _l(x) X^l(x).
\end{equation}

</p>

<p>
Similarly, given a two-form \(\omega = \omega _{ij}(x) \dd x^i\wedge \dd x^j\), we can extend the contraction as the operation \(\iota _X\) that reduces it to a one–form by applying \(X\) as the first argument of \(\omega \), that is,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{16}\)</span>

<!--


                                                                   ιX ω := ω(X, ·) := ωij (x)(X i (x)dxj − X j (x)dxi ).                                                            (3.17)                           --><a id="eq:contraction"></a><!--

-->

<p>

\begin{equation}
\label {eq:contraction} \iota _X \omega := \omega (X, \cdot ) := \omega _{ij}(x)(X^i(x) \dd x^j - X^j(x) \dd x^i).
\end{equation}

</p>

<p>
We will see in later chapters how this simplifies our lives.
</p>

<p>
The last thing to know, is that we can construct two-forms out of one-forms using so-called <em>exterior products</em> and <em>exterior derivatives</em>. For what concerns us, we will only need to know that \(\dd (\sigma _i \dd x^i) = \frac
{\partial \sigma _i}{\partial x^j} \dd x^j \wedge \dd x^i\) and that \(\dd (\dd f) = 0\) for any \(f\).
</p>

<p>
We will also need to generalize the pull-back operation. Up until now we only encountered \(\Phi ^* : \mathcal {C}^\infty (T^*M) \to \mathcal {C}^\infty (T^*M)\), where \(\Phi \) is a diffeomorphism \(\Phi : T^*M \to T^*M\), defined
in terms of right-composition \(\Phi ^* f = f \circ \Phi \). Note that if \(x = \Phi (y)\) then the pullback maps \(f(x)\) into \(\Phi ^* f (y) = f \circ \Phi (y)\), so you can effectively use the pullback to change coordinates. If
\(\theta \) is a differential form on a manifold \(P\), then the diffeomorphism \(\Phi : P \to P\) induces a mapping on the space of differential forms on \(P\) defined \(\forall x\in P, X_j\in T_xP\) by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{17}\)</span>

<!--


                                                                                                          (Φ∗ θ)x (X1 , . . . , Xk ) = θΦ(x) (Φ∗ (x)X1 , . . . , Φ∗ (x)Xk ).                                                                           (3.18)

-->

<p>

\begin{equation}
(\Phi ^{*}\theta )_{x}(X_{1},\ldots ,X_{k})=\theta _{\Phi (x)}(\Phi _*(x)X_{1},\ldots ,\Phi _*(x)X_{k}).
\end{equation}

</p>

<p>
We call the map \(\Phi ^*\) the <em>pullback</em> of \(\theta \). We will only be interested in \(k=1,2\).
</p>

<p>
The pullback of differential forms satisfies two useful identities that will be handy later on.
</p>
<ul class="enumerate" style="list-style-type:none">

<li>
<p>
<span class="listmarker">1.</span> it is compatible with the exterior product, i.e., if \(\theta _1\) and \(\theta _2\) are differential forms on \(P\), then \(\Phi ^{*}(\theta _1 \wedge \theta _2) = \Phi ^{*}\theta _1 \wedge \Phi
^{*}\theta _2\);
</p>

</li>
<li>

<p>
<span class="listmarker">2.</span> it is compatible with the exterior derivative, i.e., if \(\theta \) is a differential form on \(P\), then \(\Phi ^{*}(\dd \theta ) = \dd (\Phi ^{*}\theta )\)
</p>
</li>
</ul>

<p>
Finally, an important operation in differential geometry is the Lie derivative, the concept is quite general but we will only need it in the context of differential forms. Given a vector field \(X\) on a manifold \(P\) and the one–parameter group of
diffeomorphisms \(\Phi _t\) that it generates, we define the <em>Lie derivative of a differential form \(\theta \) with respect to \(X\)</em> as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{18}\)</span>

<!--

                                                                                          d ∗
                                                                                 LX θ =      Φt θ     .                                                                         (3.19)                           --><a id="eq:lie-derivative"></a><!--
                                                                                          dt      t=0

-->

<p>

\begin{equation}
\label {eq:lie-derivative} \mathcal {L}_X \theta = \frac {\dd }{\dd t}\Phi _t^*\theta \Big |_{t=0}.
\end{equation}

</p>

<p>
The Lie derivative evaluates the change of a tensor field (including scalar function, vector field and differential forms), along the flow defined by another vector field.
</p>

<p>
The interior product is extremely useful when you want to compute something, as it relates the exterior derivative and Lie derivative of differential forms by the <em>Cartan (magic) formula</em>:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{19}\)</span>

<!--


                                                                                  LX Θ = d(ιX Θ) + ιX (dΘ).                                                                               (3.20)                           --><a id="eq:cartan"></a><!--

-->

<p>

\begin{equation}
\label {eq:cartan} \mathcal {L}_X \Theta = \dd (\iota _X \Theta ) + \iota _X (\dd {\Theta }).
\end{equation}

</p>

<p>
With all this new equipment at hand, we are ready to delve into the hamiltonian side of mechanics.
</p>
<!--
...... section The Legendre Transform ......
-->
<h4 id="autosec-162"><span class="sectionnumber">3.3&#x2003;</span>The Legendre Transform</h4>
<a id="hm-autopage-162"></a>


<p>
Let \(M\) be a smooth manifold. The evolution of the system with lagrangian \(L=L(q,\dot q)\) is given by the Euler-Lagrange equations: a system of second order equations on the tangent bundle \(TM\). Such dynamics can be reinterpreted in a
particularly symmetric way as a dynamical system on the cotangent bundle \(T^*M\). Poisson and Hamilton have formalized the transformation that we described in the previous section and that realizes such symmetry.
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
We call <em>Legendre transformation</em> the map from the tangent bundle \(TM\) to the cotangent bundle \(T^*M\) defined in local coordinates \((q^1, \ldots , q^n)\in M\) by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{20}\)</span>

<!--


                                                                             L : (q, q̇) 7→ (q, p),                                                                         (3.21)                          --><a id="eq:legrendreTrafo"></a><!--

-->

<p>

\begin{equation}
\label {eq:legrendreTrafo} \mathcal {L}: (q,\dot q) \mapsto (q,p),
\end{equation}

</p>

<p>
where \(p = (p_1, \ldots , p_n) \in T^*_q M\) is the conjugate momentum to \(q\) defined via \(p_i := \frac {\partial L(q,\dot q)}{\partial \dot q^i}\), \(i=1,\ldots ,n\).
</p>
</div>

</div>

<p>
It follows from Exercise&nbsp;<a href="chapter-1.html#exe:coordinatesInd">1.6</a> that the definition above does not depend on the choice of local coordinates.
</p>

<p>
If it is not yet clear to you how the momenta are associated to the cotangent bundle, I promise you will not have to wait long. But if you are really impatient you could already have a look at Remark&nbsp;<a
href="chapter-3.html#rem:ptocot">3.4</a>.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-163"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.1</span></span>. </span> The Legendre transform of a non–degenerate lagrangian is a local diffeomorphism.
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-164"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> It is enough to show that Jacobian determinant of \(\mathcal {L}\) is non zero. From the definition, see <span class="textup">(<a
href="chapter-3.html#eq:legrendreTrafo">3.21</a>)</span>, we have the block matrix
</p>

<span class="hidden"> \(\seteqnumber{0}{}{21}\)</span>

<!--


                                                                                                                           ∂q i    ∂q i
                                                                                                                                            !                                         !
                                                                                                                                                         δji                 0
                                                                                                              DL =         ∂q j
                                                                                                                           ∂pi
                                                                                                                                   ∂ q̇ j
                                                                                                                                   ∂pi
                                                                                                                                                =     ∂2L                 ∂2L
                                                                                                                                                                                          ,                                        (3.22)
                                                                                                                           ∂q j    ∂ q̇ j           ∂ q̇ i ∂q j         ∂ q̇ i ∂ q̇ j
                                                                                                                                                                                      ,

-->

<p>


\begin{equation}
D\mathcal {L} = \begin{pmatrix} \frac {\partial q^i}{\partial q^j} &amp; \frac {\partial q^i}{\partial \dot q^j} \\ \frac {\partial p_i}{\partial q^j} &amp; \frac {\partial p_i}{\partial \dot q^j} \end {pmatrix} =
\begin{pmatrix} \delta ^i_j &amp; 0 \\ \frac {\partial ^2 L}{\partial \dot q^i \partial q^j} &amp; \frac {\partial ^2 L}{\partial \dot q^i \partial \dot q^j}, \end {pmatrix},
\end{equation}


</p>

<p>
From which we get
</p>

<span class="hidden"> \(\seteqnumber{0}{}{22}\)</span>

<!--


                                                                                                                                                          ∂2L
                                                                                                                                                                       
                                                                                                                    det DL = (−1)n det                                      6= 0.                                                  (3.23)
                                                                                                                                                        ∂ q̇ i ∂ q̇ j

-->

<p>


\begin{equation}
\det D\mathcal {L} = (-1)^n \det \left (\frac {\partial ^2 L}{\partial \dot q^i \partial \dot q^j}\right ) \neq 0.
\end{equation}


</p>

<p>
<span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
It follows that for a non–degenerate lagrangian we can locally invert the equations
</p>

<span class="hidden"> \(\seteqnumber{0}{}{23}\)</span>

<!--

                                                                                                                                  ∂L(q, q̇)
                                                                                                                          pi =              , i = 1, . . . , n,                                                                    (3.24)
                                                                                                                                    ∂ q̇ i

-->

<p>

\begin{equation}
p_i = \frac {\partial L(q,\dot q)}{\partial \dot q^i}, \; i=1,\ldots ,n,
\end{equation}

</p>

<p>
and write
</p>

<span class="hidden"> \(\seteqnumber{0}{}{24}\)</span>

<!--


                                                                                                                                    q̇ i = q̇ i (q, p).                                                                            (3.25)

-->

<p>

\begin{equation}
\dot q^i = \dot q^i(q,p).
\end{equation}

</p>

<p>
In this way, every non–degenerate function on \(TM\) defines a function on \(T^* M\).
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
We call <em>hamiltonian</em> of a mechanical system with lagrangian \(L\), the Legendre transform \(H(q,p)\) of its energy \(E(q,\dot q)\) from <span class="textup">(<a href="chapter-1.html#eq:energy1">1.78</a>)</span>. In local
coordinates the hamiltonian of the system is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{25}\)</span>

<!--


                                                                         H(q, p) := pi q̇ i − L(q, q̇),   q̇ i = q̇ i (q, p).                                                                 (3.26)       --><a id="eq:defH"></a><!--

-->

<p>

\begin{equation}
\label {eq:defH} H(q,p) := p_i\dot q^i - L(q, \dot q), \quad \dot q^i = \dot q^i(q,p).
\end{equation}

</p>

</div>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-165"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">3.1</span></span>. </span> This is what is meant when you read that the hamiltonian is the lift of the total energy \(E(q,
\dot q)\) of the system to a function \(H(q,p)\) on the cotangent bundle \(T^*M\).
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-166"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">3.2</span></span>. </span> This is where the literature can disagree. Some textbooks define \(H\) to be the Legendre
transform of \(L\) instead. In this way the definition can be rewritten<sup>3</sup> as
</p>
<blockquote>

<p>
\(f\) is the Legendre transform of \(g\) if \(f&apos; = (g&apos;)^{-1}, \)
</p>
</blockquote>

<p>
which nicely emphasizes involutivity and duality between the two functions.
</p>

</li>

</ul>
<div role="note" class="footnotes">

<a id="hm-autopage-168"></a>

<p>
<sup>3</sup>&nbsp;This is very nicely discussed in <a href="https://web.archive.org/web/20211114232435/https://blog.jessriedel.com/2017/06/28/legendre-transform/" target="_blank" >this blog post</a>.
</p>



</div>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-169"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">3.3</span></span>. </span> Perhaps not surprisingly, the Legendre transform also comes with some interesting connections
to control theory and differential geometry. Here I will focus on the latter. For a more detailed discussion about the relations to control theory, you can refer to [<a href="chapter-6.html#LWR-ht-cite.0@book:gelfand">GF00</a>, Appendix II].
We will not go into the details here and instead only point out the bare-bones of the connection. Optimization problems can often be reduced to find a critical point of some functional, like the action, with respect to some extra external constraints,
called controls. In such context, it is natural to rely on the theory of Lagrange multipliers that we saw in Chapter&nbsp;<a href="chapter-2.html#sec:LagrangeConstraints">2.5</a> on D’Alembert principle. If one can consider the critical points
of the action \(S\) for a lagrangian \(L(x,v)\) with the constraint \(v=\dot x\), what one finds is that the momenta are the Lagrange multipliers of this problem.
</p>

<p>
The connection with differential geometry goes through the concept of fiber derivative. Once you see that term appearing, you can thing of it as a Legendre transform in disguise. We will just briefly discuss it in the this remark but you can look at
[<a href="chapter-6.html#LWR-ht-cite.0@book:marsdenratiu">MR99</a>, Chapter 7.2] or [<a href="chapter-6.html#LWR-ht-cite.0@book:amr">AMR88</a>, Chapter 3.5] for all the details and a more general definition. Let \(L:TM \to
\mathbb {R}\) be a non-degenerate lagrangian. The <em>fiber derivative</em> is a map
</p>
<span class="hidden"> \(\seteqnumber{0}{}{26}\)</span>



<!--



                                                                                                                      FL : T M → T ∗ M,                        v 7→ FL(v),                                                                             (3.27)



-->



<p>


\begin{align}
\mathbb {F}L : TM \to T^*M, \quad v \mapsto \mathbb {F}L(v),
\end{align}
such that for all \(v,w \in T_q M\)
</p>
<span class="hidden"> \(\seteqnumber{0}{}{27}\)</span>



<!--



                                                                                                                                          d
                                                                                                                       FL(v)w :=             L(q, v + sw) s=0 .                                                                                        (3.28)
                                                                                                                                          ds



-->



<p>


\begin{align}
\mathbb {F}L(v) w := \frac {\dd }{\dd s} L(q, v + s w) \big |_{s=0}.
\end{align}
That is, \(\mathbb {F}L(v) w\) is the derivative of \(L\) at \(v\) in the direction \(w\) along the fiber \(T_qM\). The last observation is crucial: the map is fiber-preserving in the sense that it maps the fiber \(T_qM\) to the fiber \(T^*_qM\). If we
denote local coordinates on \(M\) by \(q=(q^1, \ldots , q^n)\), vectors on \(T_qM\) take the form \(\dot q = \dot q^i \frac {\partial }{\partial q^i}\big |_q \simeq (\dot q^1, \ldots , \dot q^n)\) and the fiber derivative can be
written as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{28}\)</span>

<!--

                                                                                                                                                                                     
                                                                                                                                                                     ∂L          ∂L
                                                                                                  FL(q 1 , . . . , q n , q̇ 1 , . . . , q̇ n ) =    q1 , . . . , qn , 1 , . . . , n .                                                                  (3.29)
                                                                                                                                                                     ∂ q̇        ∂ q̇

-->

<p>


\begin{equation}
\mathbb {F}L(q^1, \ldots , q^n, \dot q^1, \ldots ,\dot q^n) = \left (q^1, \ldots , q^n, \frac {\partial L}{\partial \dot q^1}, \ldots , \frac {\partial L}{\partial \dot q^n}\right ).
\end{equation}


</p>

<p>
That is, the coefficients of the covector \(p = \mathbb {F}L(\dot q) \simeq p_i dq^i\) are given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{29}\)</span>

<!--


                                                                                                                                                    ∂L
                                                                                                                                         pi =              .                                                                                           (3.30)
                                                                                                                                                    ∂ q̇ i

-->

<p>


\begin{equation}
p_i = \frac {\partial L}{\partial \dot q^i}.
\end{equation}


</p>

<p>
For non-degenerate lagrangians the fiber derivative is a smooth morphism of fiber bundles.
</p>

<p>
The <em>energy function associated to \(L\)</em> is then defined as \(E(v) := \mathbb {F}L(v) v - L(v)\). When this is applied to physical systems, you can use the expressions derived above to check that \(\mathbb {F}L\) is the Legendre
transform and \(E\) is the corresponding hamiltonian.
</p>

</li>

</ul>

</div>

<p>
Leaving all these remarks aside, the crucial point of this whole construction lies in the new shape taken by the Euler-Lagrange equations once we revisit them on the cotangent bundle.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-170"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.2</span></span><span class="amsthmnoteplain"> (Hamilton’s equations)</span>. </span> <a id="thm:Hameqns"></a>
Euler-Lagrange equations for a lagrangian \(L(q,\dot q)\) are equivalent to <em>Hamilton’s equations</em>
</p>

<span class="hidden"> \(\seteqnumber{0}{}{30}\)</span>

<!--

                                                                       
                                                                          i   ∂H
                                                                       q̇ = ∂p
                                                                       
                                                                       
                                                                                                                                                            (3.31)
                                                                                i
                                                                                         i = 1, . . . , n,                                                                                  --><a id="eq:Hamsys"></a><!--
                                                                               ∂H
                                                                       ṗi = − i
                                                                       
                                                                       
                                                                               ∂q

-->

<p>


\begin{equation}
\label {eq:Hamsys} \left \lbrace \begin{aligned} \dot q^i &amp; = \frac {\partial H}{\partial p_i} \\ \dot p_i &amp; = -\frac {\partial H}{\partial q^i} \end {aligned} \right . \qquad i=1,\ldots ,n,
\end{equation}


</p>

<p>
for the corresponding hamiltonian \(H(q,p)\).
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-171"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> The differential of the hamiltonian,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{31}\)</span>

<!--


                                                                                     ∂H i ∂H
                                                                        dH(q, p) =        dq +     dpi ,                                                                    (3.32)                             --><a id="eq:dHlc"></a><!--
                                                                                     ∂q i      ∂pi

-->

<p>


\begin{equation}
\label {eq:dHlc} \dd H(q,p) = \frac {\partial H}{\partial q^i}\dd q^i + \frac {\partial H}{\partial p_i}\dd p_i,
\end{equation}


</p>

<p>
can be explicitly computed using its definition:
</p>
<span class="hidden"> \(\seteqnumber{0}{}{32}\)</span>



<!--


                                                                                                                                             
                                                                                                 dH(q, p) = d pi q̇ i (q, p) − L(q, q̇(q, p))                                                                                             (3.33)
                                                                                                                                               ∂L i     ∂L
                                                                                                           = q̇ i dpi + pi dq̇ i (q, p) −           dq − i dq̇ i                                                                          (3.34)
                                                                                                                                               ∂q i     ∂ q̇
                                                                                                           = q̇ i dpi − ṗi dq i ,                                 (3.35)                                    --><a id="eq:dHlc2"></a><!--



-->



<p>


\begin{align}
\dd H(q,p) &amp; = \dd {}\left ( p_i\dot {q}^i(q,p) - L(q, \dot {q}(q,p)) \right ) \\ &amp; = \dot {q}^i \dd {p_i} + p_i \dd {\dot {q}^i}(q,p) - \frac {\partial L}{\partial q^i} \dd {q^i} - \frac {\partial
L}{\partial \dot {q}^i} \dd {\dot {q}^i} \\ &amp; = \dot {q}^i \dd {p_i} - \dot {p}_i \dd {q^i}, \label {eq:dHlc2}
\end{align}
where we used the Euler-Lagrange equations to get
</p>

<span class="hidden"> \(\seteqnumber{0}{}{35}\)</span>

<!--


                                                                                                              ∂L                             d ∂L        ∂L
                                                                                                       pi =            and           ṗi =             =      .                                                                           (3.36)
                                                                                                              ∂ q̇ i                         dt ∂ q̇ i   ∂q i

-->

<p>


\begin{equation}
p_i = \frac {\partial L}{\partial \dot {q}^i} \qquad \mbox {and}\qquad \dot p_i = \frac {\dd }{\dd t}\frac {\partial L}{\partial \dot {q}^i} = \frac {\partial L}{\partial q^i}.
\end{equation}


</p>

<p>
The theorem follows comparing coefficients in <span class="textup">(<a href="chapter-3.html#eq:dHlc">3.32</a>)</span> and <span class="textup">(<a href="chapter-3.html#eq:dHlc2">3.35</a>)</span>. <span
class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
We call <em>hamiltonian system</em> a system of differential equations of the form <span class="textup">(<a href="chapter-3.html#eq:Hamsys">3.31</a>)</span> and, as one can expect, we say that \(H\) is its corresponding hamiltonian
function. Equations of the form <span class="textup">(<a href="chapter-3.html#eq:Hamsys">3.31</a>)</span> are usually called <em>canonical equations</em>.
</p>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-172"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.1</span></span><span class="amsthmnotedefinition"> (A particle in a potential)</span>. </span> <a
id="ex:hamPot"></a> Let’s start with a simple prototypical example: a particle in \(\mathbb {R}^3\) moving under the influence of a potential \(U(\vb *{x})\). We are, by now, very accustomed to the corresponding natural lagrangian
</p>

<span class="hidden"> \(\seteqnumber{0}{}{36}\)</span>

<!--


                                                                                                                             mẋ2
                                                                                                                L(x, ẋ) =        − U (x).                                                                                               (3.37)
                                                                                                                              2

-->

<p>


\begin{equation}
L(\vb *{x},\dot {\vb *{x}}) = \frac {m \dot {\vb *{x}}^2}{2} - U(\vb *{x}).
\end{equation}


</p>

<p>
In this case
</p>

<span class="hidden"> \(\seteqnumber{0}{}{37}\)</span>

<!--


                                                                                                                          ∂L
                                                                                                                     p=        = mẋ                                                                                                     (3.38)
                                                                                                                          ∂ ẋ

-->

<p>


\begin{equation}
\vb *{p} = \frac {\partial L}{\partial \dot {\vb *{x}}} = m \dot {\vb *{x}}
\end{equation}


</p>

<p>
coincides with what we usually call (kinetic) momentum in physics.
</p>

<p>
The hamiltonian is then given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{38}\)</span>

<!--


                                                                                                                                      p2
                                                                                                          H(p, x) = hp, ẋi − L =        + U (x),                                                                                        (3.39)
                                                                                                                                      2m

-->

<p>


\begin{equation}
H(\vb *{p},\vb *{x}) = \langle \vb *{p}, \dot {\vb *{x}}\rangle - L = \frac {\vb *{p}^2}{2m} + U(\vb *{x}),
\end{equation}


</p>

<p>
which should remind you of Theorem&nbsp;<a href="chapter-1.html#thm:ham1">1.6</a>. Hamilton’s equation are then simply
</p>

<span class="hidden"> \(\seteqnumber{0}{}{39}\)</span>

<!--

                                                                                                                 
                                                                                                                        ∂H    1
                                                                                                                 ẋ =      = p
                                                                                                                 
                                                                                                                 
                                                                                                                        ∂p    m
                                                                                                                                    ,                                                                                                    (3.40)
                                                                                                                  ṗ = − ∂H = − ∂U
                                                                                                                 
                                                                                                                 
                                                                                                                          ∂x     ∂x

-->

<p>


\begin{equation}
\left \lbrace \begin{aligned} \dot {\vb *{x}} &amp; = \frac {\partial H}{\partial \vb *{p}} = \frac 1m \vb *{p} \\ \dot {\vb *{p}} &amp; = - \frac {\partial H}{\partial \vb *{x}} = -\frac {\partial U}{\partial \vb
*{x}} \end {aligned} \right .,
\end{equation}


</p>

<p>
which should also be familiar: the first is just the definition of momentum while the second is Newton’s second law for the system.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-173"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.2</span></span><span class="amsthmnotedefinition"> (The hamiltonian for a natural lagrangian on a riemannian
manifold)</span>. </span> <a id="ex:nlrm"></a> Let \(L\) be a free lagrangian
</p>

<span class="hidden"> \(\seteqnumber{0}{}{40}\)</span>

<!--


                                                                                                                                      1
                                                                                                                     L(q, q̇) =         gij (q)q̇ i q̇ j                                                                                 (3.41)
                                                                                                                                      2

-->

<p>


\begin{equation}
L(q, \dot q) = \frac 12 g_{ij}(q) \dot q^i \dot q^j
\end{equation}


</p>

<p>
on the tangent bundle \(TM\) of a riemannian manifold \((M,g)\). Recall that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{41}\)</span>

<!--



                                                                                                                      ds2 = gij (q)dq i dq j .                                                                                           (3.42)

-->

<p>


\begin{equation}
\dd s^2 = g_{ij}(q)\dd q^i \dd q^j.
\end{equation}


</p>

<p>
Denote \((g^{ij}(q))\) the inverse of the metric matrix \((g_{ij}(q))\), i.e., the matrix such that \(g^{ik}(q)g_{kj}(q) = \delta ^i_j\) for all \(i,j=1,\ldots ,n\).
</p>

<p>
The Legendre transform of \(L\) is, then, the hamiltonian
</p>

<span class="hidden"> \(\seteqnumber{0}{}{42}\)</span>

<!--


                                                                                                        1 ij
                                                                                                  H=      g (q)pi pj ,    with pi := gij (q)q̇ j , i = 1, . . . , n,                                                                     (3.43)
                                                                                                        2

-->

<p>


\begin{equation}
H = \frac 12 g^{ij}(q) p_i p_j,\quad \mbox {with}\quad p_i := g_{ij}(q)\dot q^j, \; i = 1,\ldots , n,
\end{equation}


</p>

<p>
while the inverse transform gives \(L\) in terms of
</p>

<span class="hidden"> \(\seteqnumber{0}{}{43}\)</span>

<!--



                                                                                                                q̇ i = g ij (q)pj ,       i = 1, . . . , n.                                                                              (3.44)

-->

<p>


\begin{equation}
\dot q^i = g^{ij}(q) p_j, \quad i = 1,\ldots , n.
\end{equation}


</p>

<p>
As we saw when we defined the Legendre transform and in Exercise&nbsp;<a href="chapter-1.html#exe:coordinatesInd">1.6</a>, the behavior of the metric tensor under coordinate transformations implies that \(H\) is invariant under a change
of variable. Moreover, we saw in Exercise&nbsp;<a href="chapter-1.html#exe:geodesic1">1.7</a> that geodesics on \(M\) are the solutions of the Euler-Lagrange equation for the free lagrangian \(L\). But then, Theorem&nbsp;<a
href="chapter-3.html#thm:Hameqns">3.2</a> implies that geodesics should appear also from the flow of Hamilton’s equation
</p>

<span class="hidden"> \(\seteqnumber{0}{}{44}\)</span>

<!--


                                                              ∂H
                                                       
                                                          i          ij
                                                       q̇ = ∂pi = g (q)pj
                                                       
                                                       
                                                                            jk
                                                                                    i = 1, . . . , n.                                                                  (3.45)                             --><a id="eq:geoflowham"></a><!--
                                                       ṗi = − ∂H = − 1 ∂g pj pk
                                                       
                                                       
                                                                ∂q i    2 ∂q i

-->

<p>


\begin{equation}
\label {eq:geoflowham} \left \lbrace \begin{aligned} \dot q^i &amp; = \frac {\partial H}{\partial p_i} = g^{ij}(q) p_j \\ \dot p_i &amp; = -\frac {\partial H}{\partial q^i} = -\frac 12 \frac {\partial
g^{jk}}{\partial q^i} p_j p_k \end {aligned} \right . \qquad i=1,\ldots ,n.
\end{equation}


</p>

<p>
Indeed, we can describe the geodesics in terms of the flow determined by <span class="textup">(<a href="chapter-3.html#eq:geoflowham">3.45</a>)</span>, also called the <em>cogeodesic flow</em>: the geodesics are the projections of the
integral curves of the (co)geodesic flow onto the manifold \(M\).
</p>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-174"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.1</span></span>. </span> Show that a simple substitution allows to recover Euler-Lagrange equations of
Exercise&nbsp;<a href="chapter-1.html#exe:geodesic1">1.7</a>, which gives the geodesic flow on the tangent bundle \(TM\).
</p>

</li>

</ul>

</div>

<p>
As we know that the hamiltonian is the total energy of the system and that the total energy is conserved, this immediately implies that \(g_{ij}(q) \dot q^i \dot q^j = \langle \dot q, \dot q\rangle _g = \mathrm {const}\). Which was
one of our previous exercises.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-175"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">3.4</span></span>. </span> <a id="rem:ptocot"></a> The previous example provides a good opportunity to discuss the
nature of the momentum from yet another perspective. Let \((M, g)\) be a riemannian manifold. The riemannian metric, or riemannian metric tensor, is a bilinear form \(\langle \cdot , \cdot \rangle _g\) on the tangent spaces of \(M\). In
local coordinates \(q\in M\), we can associate to the metric a matrix \(g_{ij}(q)\). With an abuse of notation, we say that \(g_{ij}(q)\) is a \((0,2)\)-tensor.
</p>

<p>
Every \((0,2)\)-tensor \(g_{ij}(q)\) canonically defines a map<sup>4</sup>
</p>

<span class="hidden"> \(\seteqnumber{0}{}{45}\)</span>

<!--



                                                                                            ĝ : T M → T ∗ M,         Tq M 3 v 7→ ĝq (v) := p := hv, ·ig ∈ Tq∗ M.                                                                             (3.46)

-->

<p>


\begin{equation}
\hat g: TM \to T^*M, \qquad T_q M \ni v \mapsto \hat g_q(v) := p := \langle v, \cdot \rangle _g \in T^*_q M.
\end{equation}


</p>

<p>
Such tensor is called <em>non–degenerate</em> if the map \(T_qM \to T_q^* M\) is an isomorphism for all \(q\in M\). Such isomorphism allows one to identify tangent and cotangent spaces and, in particular, to define a dual bilinear form \(\langle
\cdot , \cdot \rangle _g^*\) on \(T^*M\) using the original form on \(TM\):
</p>

<span class="hidden"> \(\seteqnumber{0}{}{46}\)</span>

<!--



                                                                                                   hw1 , w2 i∗g = hĝq−1 w1 , ĝq−1 w2 ig ,    w1 , w2 ∈ Tq∗ M.                                                                                (3.47)

-->

<p>


\begin{equation}
\langle w_1, w_2\rangle _g^* = \langle \hat g_q^{-1} w_1, \hat g_q^{-1} w_2\rangle _g, \quad w_1,w_2 \in T^*_q M.
\end{equation}


</p>

<p>
The matrix of this dual form coincides with the inverse of the metric matrix:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{47}\)</span>

<!--



                                                                                                                     hdq i , dq j i∗g = g ij (q).                                                                                              (3.48)

-->

<p>


\begin{equation}
\langle \dd q^i, \dd q^j\rangle _g^* = g^{ij}(q).
\end{equation}


</p>

<p>
Which, in more algebraic terms and with the same abuse of notation, means that the inverse matrix \((g^{ij}(q))\) is a \((2,0)\)-tensor.
</p>

<p>
We can revisit Example&nbsp;<a href="chapter-3.html#ex:nlrm">3.2</a> in light of this remark. What we see is that a mechanical lagrangian \(L(q,\dot q) = \langle \dot q, \dot q\rangle _g - U(q)\) on some state space \(TM\) is
mapped via the Legendre transform into the hamiltonian \(H(q, p) = \langle p, p \rangle _g^* + U(q)\) on \(T^*M\), emphasizing the dual nature of the momentum with respect to the velocity without the need to look at the fiber derivative
construction.
</p>

</li>

</ul>
<div role="note" class="footnotes">

<a id="hm-autopage-176"></a>

<p>
<sup>4</sup>&nbsp;The isomorphisms between the tangent and cotangent spaces defined here are commonly known as <em>musical isomorphisms</em>: the <em>flat</em> and <em>sharp</em> maps respectively correspond to the mapping \(\beta
:TM\to T^*M\) and \(\sharp :T^*M\to TM\) such that \(v^\beta (w) = \langle v,w\rangle _g\) and \(\langle p^\sharp , v\rangle = p(v)\). See also [<a href="chapter-6.html#LWR-ht-cite.0@book:lee">J.M13</a>, Chapter 11] or [<a
href="chapter-6.html#LWR-ht-cite.0@lectures:aom:seri">Ser20</a>, Example 6.1.9].
</p>



</div>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-177"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.3</span></span>. </span> We saw in Example&nbsp;<a href="chapter-3.html#ex:hamPot">3.1</a> that the
hamiltonian of a free particle of mass \(m\) is, in cartesian coordinates,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{48}\)</span>

<!--


                                                                                                                        1
                                                                                                                 H=       (p2x + p2y + p2z ).                                                                                (3.49)
                                                                                                                       2m

-->

<p>


\begin{equation}
H = \frac {1}{2m}(p_x^2 + p_y^2 + p_z^2).
\end{equation}


</p>

<p>
The preliminary computations that we did in Section&nbsp;<a href="chapter-1.html#sec:lagrangianonmanifold">1.4</a> and Examples&nbsp;<a href="chapter-3.html#ex:nlrm">3.2</a> immediately tell us how to compute the corresponding
hamiltonian in cylindrical and spherical coordinates. Namely, we can invert the metric matrix to get
</p>
<span class="hidden"> \(\seteqnumber{0}{}{49}\)</span>



<!--


                                                                                                                                                                     !
                                                                                                                                          1               p2φ
                                                                                        cylindrical coordinates (r, φ, z)     →       H=             p2r + 2 + p2z       ,                                                   (3.50)
                                                                                                                                         2m                  r
                                                                                                                                                                              !
                                                                                                                                          1                     p2φ     p2θ
                                                                                          spherical coordinates (r, φ, θ)     →       H=             p2r +            +           .                                          (3.51)
                                                                                                                                         2m                  r2 sin θ
                                                                                                                                                                    2
                                                                                                                                                                        r2



-->



<p>


\begin{align}
\mbox {cylindrical coordinates } (r,\phi ,z) \quad &amp; \rightarrow \quad H = \frac 1{2m} \left (p_r^2 + \frac {p_\phi ^2}{r^2} + p_z^2\right ), \\ \mbox {spherical coordinates } (r,\phi ,\theta ) \quad &amp;
\rightarrow \quad H = \frac 1{2m} \left (p_r^2 + \frac {p_\phi ^2}{r^2\sin ^2\theta } + \frac {p_\theta ^2}{r^2} \right ).
\end{align}


</p>

<p>
More generally, a natural lagrangian
</p>

<span class="hidden"> \(\seteqnumber{0}{}{51}\)</span>

<!--


                                                                                                                            1
                                                                                                               L(q, q̇) =     gij (q)q̇ i q̇ j − U (q)                                                                       (3.52)
                                                                                                                            2

-->

<p>


\begin{equation}
L(q,\dot q) = \frac 12 g_{ij}(q) \dot q^i \dot q^j - U(q)
\end{equation}


</p>

<p>
on the tangent bundle of a riemannian manifold \((M,g)\) is transformed into a hamiltonian of the form
</p>

<span class="hidden"> \(\seteqnumber{0}{}{52}\)</span>

<!--


                                                                                                                            1 ij
                                                                                                              H(q, p) =       g (q)pi pj + U (q).                                                                            (3.53)
                                                                                                                            2

-->

<p>


\begin{equation}
H(q,p) = \frac 12 g^{ij}(q) p_i p_j + U(q).
\end{equation}


</p>

<p>
Of course, one can also obtain the formulas above directly using Example&nbsp;<a href="chapter-3.html#ex:nlrm">3.2</a> and Exercise&nbsp;<a href="chapter-1.html#exe:coordinatesInd">1.6</a>.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-178"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.2</span></span><span class="amsthmnotedefinition"> (Inverse Legendre transform)</span>. </span> Show that the
hamiltonian \(H\) defined by <span class="textup">(<a href="chapter-3.html#eq:defH">3.26</a>)</span> satisfies the non–degeneracy condition
</p>

<span class="hidden"> \(\seteqnumber{0}{}{53}\)</span>

<!--


                                                                                                                               ∂2H
                                                                                                                                       
                                                                                                                    det                     6= 0.                                                                      (3.54)
                                                                                                                              ∂pi ∂pj

-->

<p>


\begin{equation}
\det \left (\frac {\partial ^2 H}{\partial p_i\partial p_j}\right ) \neq 0.
\end{equation}


</p>

<p>
Moreover, the inverse Legendre transform can be written in local coordinates as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{54}\)</span>

<!--


                                                                                     ∂H(q, p)
                              L(q, q̇) = pi (q, q̇)q̇ i − H(q, p(q, q̇)),   q̇ i =            , i = 1, . . . , n.                       (3.55)                                       --><a id="eq:inverseLegendre"></a><!--
                                                                                       ∂pi

-->

<p>


\begin{equation}
\label {eq:inverseLegendre} L(q, \dot q) = p_i(q, \dot q) \dot q^i - H(q, p(q,\dot q)),\qquad \dot q^i = \frac {\partial H (q,p)}{\partial p_i}, \; i=1,\ldots ,n.
\end{equation}


</p>

<p>
Where we use the latter equation to obtain \(p_i(q, \dot q)\).
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-179"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.3</span></span>. </span> <a id="exe:timedep"></a> Show that the Legendre transform of a non–degenerate
time-dependent lagrangian \(L(q,\dot q, t)\) is well defined, the corresponding hamiltonian is
</p>

<span class="hidden"> \(\seteqnumber{0}{}{55}\)</span>

<!--



                                                                                                             H(q, p, t) := pi q̇ i − L(q, q̇, t),                                                                       (3.56)

-->

<p>


\begin{equation}
H(q,p,t) := p_i \dot q^i - L(q, \dot q, t),
\end{equation}


</p>

<p>
and Hamilton’s equations have the same form plus an additional equation
</p>

<span class="hidden"> \(\seteqnumber{0}{}{56}\)</span>

<!--


                                                                                                                       ∂H    ∂L
                                                                                                                          =−    .                                                                                       (3.57)
                                                                                                                       ∂t    ∂t

-->

<p>


\begin{equation}
\frac {\partial H}{\partial t} = - \frac {\partial L}{\partial t}.
\end{equation}


</p>

<p>
Note that such additional equation immediately implies that the total energy is not conserved for lagrangians or hamiltonians which are explicitly dependent on time.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-180"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.4</span></span><span class="amsthmnotedefinition"> (A particle in an electromagnetic field)</span>. </span> <a
id="exe:magneticH"></a> We saw the Lagrangian for charged particles in an electromagnetic field in Example&nbsp;<a href="chapter-1.html#exa:magnetic">1.7</a> and in Exercise&nbsp;<a href="chapter-1.html#exe:magnetic">1.2</a>. In
the simpler case of a single particle, the lagrangian takes the form
</p>

<span class="hidden"> \(\seteqnumber{0}{}{57}\)</span>

<!--


                                                                                                                  mẋ2          e
                                                                                                     L(x, ẋ) =        − U (x) + hA(x), ẋi.                                                                                   (3.58)
                                                                                                                   2            c

-->

<p>


\begin{equation}
L(\vb *{x},\dot {\vb *{x}}) = \frac {m \dot {\vb *{x}}^2}{2} - U(\vb *{x}) + \frac ec \langle \vb * A(\vb *{x}), \dot {\vb *{x}}\rangle .
\end{equation}


</p>

<p>
The conjugate momentum to the position is then given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{58}\)</span>

<!--


                                                               ∂L          e
                                                          p=        = mẋ + A(x)                                                       (3.59)                                                        --><a id="eq:magMom"></a><!--
                                                               ∂ ẋ        c

-->

<p>


\begin{equation}
\label {eq:magMom} \vb *{p} = \frac {\partial L}{\partial \dot {\vb *{x}}} = m \dot {\vb *{x}} + \frac {e}{c}\vb * A(\vb *{x})
\end{equation}


</p>

<p>
which now differs from what we usually call momentum by the additional term containing the magnetic vector potential \(\vb * A\).
</p>

<p>
Inverting <span class="textup">(<a href="chapter-3.html#eq:magMom">3.59</a>)</span>, we get
</p>

<span class="hidden"> \(\seteqnumber{0}{}{59}\)</span>

<!--


                                                                                                                    1     e    
                                                                                                             ẋ =       p − A(x) ,                                                                                             (3.60)
                                                                                                                    m      c

-->

<p>


\begin{equation}
\dot {\vb *{x}} = \frac 1m \left ( \vb *{p} - \frac {e}{c}\vb * A(\vb *{x}) \right ),
\end{equation}


</p>

<p>
so the hamiltonian is
</p>
<span class="hidden"> \(\seteqnumber{0}{}{60}\)</span>



<!--



                                                                                              H(x, p) = hp, ẋi − L                                                                                                            (3.61)
                                                                                                         1 D          e     E    1      e     2
                                                                                                      =       p, p − A(x) −          p − A(x)                                                                                  (3.62)
                                                                                                        m             cD        2m      c
                                                                                                                     e             e    E
                                                                                                        + U (x) −        A(x), p − A(x)                                                                                        (3.63)
                                                                                                                    mc             c
                                                                                                          1        e       2
                                                                                                      =        p − A(x) + U (x).                                                                                               (3.64)
                                                                                                        2m         c



-->



<p>


\begin{align}
H(\vb *{x}, \vb *{p}) &amp; = \langle \vb *{p}, \dot {\vb *{x}}\rangle - L \\ &amp; = \frac 1m\ \left \langle \vb *{p}, \vb *{p} - \frac {e}{c}\vb * A(\vb *{x})\right \rangle - \frac 1{2m}\left \|\vb *{p} - \frac
{e}{c}\vb * A(\vb *{x})\right \|^2 \\ &amp; \quad + U(\vb *{x}) - \frac e{mc} \left \langle \vb * A(\vb *{x}), \vb *{p} - \frac {e}{c}\vb * A(\vb *{x})\right \rangle \\ &amp; = \frac 1{2m}\left \|\vb *{p} - \frac
{e}{c}\vb * A(\vb *{x})\right \|^2 + U(\vb *{x}).
\end{align}
The corresponding Hamilton’s equation read
</p>

<span class="hidden"> \(\seteqnumber{0}{}{64}\)</span>

<!--


                                                                                                  ∂H     1        e
                                                                                                                         
                                                                                           ẋi =
                                                                                                     =      pi − (A(x))i
                                                                                                 ∂pi    m         c
                                                                                                                                           j
                                                                                                                                                                                                                               (3.65)
                                                                                            ṗ = − ∂H = − ∂U (x) + e p − e (A(x))j ∂(A(x))
                                                                                                                                 
                                                                                           
                                                                                               i       i         i          j            i
                                                                                                    ∂x        ∂x     mc       c       ∂x
-->

<p>


\begin{equation}
\left \lbrace \begin{aligned} \dot {\vb *{x}}^i &amp; = \frac {\partial H}{\partial \vb *{p}_i} = \frac 1m \left (\vb *{p}_i - \frac {e}{c}(\vb * A(\vb *{x}))^i\right ) \\ \dot {\vb *{p}}_i &amp; = -\frac {\partial
H}{\partial \vb *{x}^i} = -\frac {\partial U(\vb *{x})}{\partial \vb *{x}^i} + \frac {e}{mc} \left (\vb *{p}_j - \frac {e}{c}(\vb * A(\vb *{x}))^j\right )\frac {\partial (\vb * A(\vb *{x}))^j}{\partial \vb *{x}^i}
\end {aligned} \right .
\end{equation}


</p>

<p>
where \(i=1,2,3\).
</p>

<p>
With some additional work, one can show that these are equivalent to Newton’s second law with the additional Lorenz force as in Exercise&nbsp;<a href="chapter-1.html#exe:magnetic">1.2</a>.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-181"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.5</span></span><span class="amsthmnotedefinition"> (A particle in a constant magnetic field)</span>. </span> An
important special case of Example&nbsp;<a href="chapter-3.html#exe:magneticH">3.4</a> is the case of a uniform magnetic field pointing in the \(z\)-direction: \(\vb * B = (0,0,B)\). One convenient choice of vector potential for \(\vb * B\) is
</p>

<span class="hidden"> \(\seteqnumber{0}{}{65}\)</span>

<!--



                                                                                                                      A(x, y, z) = (−By, 0, 0).                                                                                             (3.66)

-->

<p>


\begin{equation}
\vb * A (x,y,z) = (-B y, 0, 0).
\end{equation}


</p>

<p>
Consider a particle moving in the \((x, y)\)-plane. Then, \(p_z = 0\) and the Hamiltonian for the system is
</p>

<span class="hidden"> \(\seteqnumber{0}{}{66}\)</span>

<!--


                                                                                                                         1     e  2  1 2
                                                                                                                   H=       px + By +    py .                                                                                               (3.67)
                                                                                                                        2m      c     2m

-->

<p>


\begin{equation}
H = \frac 1{2m}\left (p_x + \frac ec By\right )^2 + \frac 1{2m}p_y^2.
\end{equation}


</p>

<p>
Hamilton’s equations are four first order differential equations:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{67}\)</span>

<!--

                                                                    
                                                                    ṗx = 0
                                                                    
                                                                    
                                                                    
                                                                    
                                                                            1         e   
                                                                     ẋ =       px + By
                                                                    
                                                                    
                                                                             m          c
                                                                                                                                                                      (3.68)                                     --><a id="eq:magHeq"></a><!--
                                                                               eB        e    
                                                                      ṗ   = −      p   +   By
                                                                    
                                                                         y            x
                                                                    
                                                                               cm         c
                                                                    
                                                                    
                                                                    
                                                                     ẏ = py
                                                                    
                                                                    
                                                                    
                                                                             m
-->

<p>


\begin{equation}
\label {eq:magHeq} \left \lbrace \begin{aligned} \dot p_x &amp; = 0 \\ \dot x &amp; = \frac 1m\left (p_x + \frac ec By\right ) \\ \dot p_y &amp; = -\frac {eB}{cm} \left (p_x + \frac ec By\right ) \\ \dot y &amp; =
\frac {p_y} m \\ \end {aligned} \right .
\end{equation}


</p>

<p>
With some algebraic manipulations it is possible to show that there are the following additional conserved quantities (try to show it as an <b>exercise</b>):
</p>

<span class="hidden"> \(\seteqnumber{0}{}{68}\)</span>

<!--


                                                                                                        e                                  e
                                                                                                    py + Bx = α = const      and px = mẋ − By = β = const.                                                                                 (3.69)
                                                                                                        c                                  c

-->

<p>


\begin{equation}
p_y + \frac ec Bx = \alpha = \mathrm {const} \quad \mbox {and}\quad p_x = m\dot x - \frac ec By = \beta = \mathrm {const}.
\end{equation}


</p>

<p>
With these at hand, Hamilton’s equation become very easy to solve: we have
</p>

<span class="hidden"> \(\seteqnumber{0}{}{69}\)</span>

<!--


                                                                                                            cα                                  cβ
                                                                                                   x(t) =      + R sin(ωt + φ) and   y(t) = −      + R cos(ωt + φ),                                                                         (3.70)
                                                                                                            eB                                  eB

-->

<p>


\begin{equation}
x(t) = \frac {c \alpha }{e B} + R \sin (\omega t + \phi ) \quad \mbox {and}\quad y(t) = -\frac {c \beta }{e B} + R \cos (\omega t + \phi ),
\end{equation}


</p>

<p>
where \(\alpha , \beta , R, \phi \) are integration constants and
</p>

<span class="hidden"> \(\seteqnumber{0}{}{70}\)</span>

<!--


                                                                                                                                  eB
                                                                                                                             ω=      .                                                                                                      (3.71)
                                                                                                                                  mc

-->

<p>


\begin{equation}
\omega = \frac {e B}{m c}.
\end{equation}


</p>

<p>
We see that the particle move in circles (<em>gyration</em>) in the \((x,y)\)-plane with frequency \(\omega \), better known as <em>Larmor or cyclotron frequency</em>.
</p>

<p>
Finally, observe from the first equation in <span class="textup">(<a href="chapter-3.html#eq:magHeq">3.68</a>)</span> that \(x\) being a cyclic coordinate is reflected also in the hamiltonian formalism as the conservation of momentum.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-182"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.6</span></span><span class="amsthmnotedefinition"> (The relativistic hamiltonian)</span>. </span> If \(c&gt;0\)
denotes the speed of light, the hamiltonian \(H:\mathbb {R}^3\times \mathbb {R}^3\to \mathbb {R}\) of a free relativistic particle of mass \(m&gt;0\) is
</p>

<span class="hidden"> \(\seteqnumber{0}{}{71}\)</span>

<!--



                                                                                                                                                                                                                        (3.72)
                                                                                                                               p
                                                                                                                    H(q, p) = c p2 + m2 c2 .

-->

<p>


\begin{equation}
H(q,p) = c \sqrt {p^2 + m^2 c^2}.
\end{equation}


</p>

<p>
For \(p &lt; c\) we can expand it in Taylor series as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{72}\)</span>

<!--


                                                                                                                                    p2
                                                                                                                 H(q, p) = mc2 +       + O(p4 ).                                                                        (3.73)
                                                                                                                                    2m

-->

<p>


\begin{equation}
H(q,p) = mc^2 + \frac {p^2}{2m} + O(p^4).
\end{equation}


</p>

<p>
If we interpret \(H\) as the total energy, you can recognize a famous formula in the first term (also called <em>rest energy</em>), while the second term is the non-relativistic kinetic energy.
</p>

<p>
In this case, independently of the chosen momentum, the velocity
</p>

<span class="hidden"> \(\seteqnumber{0}{}{73}\)</span>

<!--


                                                                                                                           ∂H        p
                                                                                                                    q̇ =      = cp                                                                                      (3.74)
                                                                                                                           ∂p     p + m2 c2
                                                                                                                                   2


-->

<p>


\begin{equation}
\dot q = \frac {\partial H}{\partial p} = c \frac {p}{\sqrt {p^2 + m^2 c^2}}
\end{equation}


</p>

<p>
is always strictly smaller, in absolute value, than the speed of light \(c\). The corresponding Lagrangian \(L\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{74}\)</span>

<!--

                                                                                                                                                    r
                                                                                                                                                             q̇ 2
                                                                                                                                                2
                                                                                                       L(q, q̇) = (q̇, p(q̇)) − H(q, p(q̇)) = −mc       1−                                                              (3.75)
                                                                                                                                                             c2

-->

<p>


\begin{equation}
L(q,\dot q) = (\dot q, p(\dot q)) - H(q, p(\dot q)) = -mc^2 \sqrt {1-\frac {\dot q^2}{c^2}}
\end{equation}


</p>

<p>
is not defined on the whole \(\mathbb {R}^3\times \mathbb {R}^3\)!
</p>

</li>

</ul>

</div>
<!--
...... section Poisson brackets and first integrals of motion ......
-->
<h4 id="autosec-183"><span class="sectionnumber">3.4&#x2003;</span>Poisson brackets and first integrals of motion</h4>
<a id="hm-autopage-183"></a>


<a id="sec:poisson"></a>

<p>
One of the many advantages of the hamiltonian approach comes from an elegant algebraic description. This will play a central role in the study of conserved quantities, and provides a remarkable duality with the mathematical description of quantum
mechanics.
</p>

<p>
From now on, we will denote by \(q = (q^1, \ldots , q^n)\) the local coordinates on \(M\), and
</p>

<span class="hidden"> \(\seteqnumber{0}{}{75}\)</span>

<!--


                                                                                                            (q 1 , . . . , q n , p1 , . . . , pn ) ∈ T ∗ M                                                                                      (3.76)

-->

<p>

\begin{equation}
(q^1, \ldots , q^n, p_1, \ldots , p_n)\in T^*M
\end{equation}

</p>

<p>
the coordinates induced by \(q\) on \(T^*M\). We will, thus, write functions on the cotangent space as \(f=f(q,p)\).
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
Let \(f=f(q,p)\) and \(g=g(q,p)\) be two functions on the phase space \(T^*M\). Then the <em>Poisson bracket</em> is defined to be
</p>

<span class="hidden"> \(\seteqnumber{0}{}{76}\)</span>

<!--

                                                                           ∂f ∂g      ∂f ∂g
                                                                                                                                                             (3.77)                                               --><a id="def:Poisson"></a><!--
                                                              
                                                                  f, g =            −          ,
                                                                           ∂q i ∂pi   ∂pi ∂q i

-->

<p>

\begin{equation}
\label {def:Poisson} \big \{f,g\big \} = \frac {\partial f}{\partial q^i}\frac {\partial g}{\partial p_i} - \frac {\partial f}{\partial p_i}\frac {\partial g}{\partial q^i},
\end{equation}

</p>

<p>
where as usual we are summing repeated indices.
</p>
</div>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-184"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.4</span></span>. </span> Show that the definition of Poisson brackets on \(T^*M\) does not depend on the choice of the
local coordinates on \(M\).
</p>

</li>

</ul>

</div>

<p>
Since <a href="chapter-3.html#def:Poisson">3.77</a> is a kind of weird definition, let’s look at some of its properties.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-185"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.3</span></span>. </span> <a id="thm:PoissonLieAlgebra"></a> Poisson bracket defines a structure of infinite-dimensional Lie
algebra<sup>5</sup> on the space \(\mathcal {C}^\infty (T^*M)\) of smooth functions on the phase space.
</p>

<p>
More explicitly, the operation \(\mathcal {C}^\infty (T^*M)\times \mathcal {C}^\infty (T^*M) \to \mathcal {C}^\infty (T^*M)\) defined by \((f,g) \mapsto \big \{f,g\big \}\) satisfies the following properties for any \(f,g,h \in
\mathcal {C}^\infty (T^*M)\):
</p>
<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker">1.</span> it is antisymmetric, \(\big \{g,f\big \} = - \big \{f,g\big \}\);
</p>


</li>
<li>


<p>
<span class="listmarker">2.</span> it is bilinear, \(\big \{\alpha f + \beta g, h\big \} = \alpha \big \{f,h\big \} + \beta \big \{g,h\big \}\) and \(\big \{f, \alpha g + \beta h\big \} = \alpha \big \{f,g\big \} + \beta
\big \{f,h\big \}\) for any \(\alpha , \beta \in \mathbb {R}\);
</p>


</li>
<li>


<p>
<span class="listmarker">3.</span> it fulfills <em>Jacobi identity</em>:
</p>
<span class="hidden"> \(\seteqnumber{0}{}{77}\)</span>
<!--


                                                                                                                                               (3.78)                                                 --><a id="eq:JacobiId"></a><!--
                                                                                        
                                                             f, g , h +        h, f , g +        g, h , f = 0.

-->
<p>


\begin{equation}
\label {eq:JacobiId} \big \{\big \{f,g\big \},h\big \} + \big \{\big \{h,f\big \},g\big \} + \big \{\big \{g,h\big \},f\big \} = 0.
\end{equation}


</p>
<p>


</p>
</li>
</ul>

<p>
Finally, the Poisson bracket satisfies <em>Leibnitz rule</em> with respect to function products:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{78}\)</span>

<!--



                                                                                            f, g, h ∈ C ∞ (T ∗ M ).                          (3.79)                                                --><a id="eq:LeibnitzId"></a><!--
                                                                    
                                                   f g, h = g f, h + f g, h ,

-->

<p>


\begin{equation}
\label {eq:LeibnitzId} \big \{fg, h\big \} = g\big \{f, h\big \} + f \big \{g, h\big \}, \qquad f,g,h \in \mathcal {C}^\infty (T^*M).
\end{equation}


</p>

</li>

</ul>
<div role="note" class="footnotes">

<a id="hm-autopage-186"></a>

<p>
<sup>5</sup>&nbsp;The corresponding Lie group is the group of symplectomorphisms, a concept that will be introduced later.
</p>



</div>

</div>

<p>
The only property requiring a proof is the Jacobi identity. Here I quote [<a href="chapter-6.html#LWR-ht-cite.0@lectures:tong">Ton05</a>]:
</p>
<blockquote>

<p>
To prove this you need a large piece of paper and a hot cup of coffee. Expand out all 24 terms and watch them cancel one by one.
</p>
</blockquote>

<p>
What Theorem&nbsp;<a href="chapter-3.html#thm:PoissonLieAlgebra">3.3</a> is telling us, is that Poisson’s bracket define the same algebraic structure as matrix commutators and differential operators. There is a deep relationship between
what we are seeing here and Heisenberg’s and Schrödinger’s picture of quantum mechanics. This relationship is emphasized even more if we compute the Poisson bracket of the coordinate functions:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{79}\)</span>

<!--


                                                                                                                                           (3.80)                                                  --><a id="eq:coordcommutators"></a><!--
                                           i
                                           q , pj = δji ,
                                                             i j   
                                                             q , q = pi , pj = 0,      i, j = 1, . . . , n.

-->

<p>

\begin{equation}
\label {eq:coordcommutators} \big \{q^i,p_j\big \} = \delta ^i_j, \qquad \big \{q^i,q^j\big \} = \big \{p_i,p_j\big \} = 0, \qquad i,j = 1,\ldots ,n.
\end{equation}

</p>

<p>
One crucial property of the Poisson bracket is enunciated by the following theorem.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-188"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.4</span></span>. </span> <a id="thm:poissondtdF"></a> Let \(H=H(q,p)\) be the hamiltonian of an hamiltonian system <span
class="textup">(<a href="chapter-3.html#eq:Hamsys">3.31</a>)</span> and \(F=F(q,p)\in \mathcal {C}^\infty (T^*M)\). Then, along the flow \((q(t), p(t))\) of \(H\), we have
</p>

<span class="hidden"> \(\seteqnumber{0}{}{80}\)</span>

<!--


                                                                                                        d      ∂F i ∂F
                                                                                                                                                                                                                        (3.81)
                                                                                                                                  
                                                                                                           F =      q̇ +     ṗi = F, H .
                                                                                                        dt     ∂q i      ∂pi

-->

<p>


\begin{equation}
\frac {\dd }{\dd t} F = \frac {\partial F}{\partial q^i} \dot q^i + \frac {\partial F}{\partial p_i} \dot p_i = \big \{F,H\big \}.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>

<p>
We say that two functions \(H\) and \(F\) on \(T^* M\) <em>commute</em>, or <em>are in involution</em>, if
</p>

<span class="hidden"> \(\seteqnumber{0}{}{81}\)</span>

<!--


                                                                                                                                                                                                                        (3.82)
                                                                                                                  
                                                                                                                      H, F   = 0.

-->

<p>

\begin{equation}
\big \{H,F\big \} = 0.
\end{equation}

</p>

<p>
Then Theorem&nbsp;<a href="chapter-3.html#thm:poissondtdF">3.4</a> implies the following.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-189"></a>
<span class="amsthmnameplain">Corollary</span><span class="amsthmnumberplain"> <span class="textup">3.5</span></span>. </span> Given an hamiltonian system <span class="textup">(<a
href="chapter-3.html#eq:Hamsys">3.31</a>)</span> with hamiltonian \(H\) and a smooth function \(F\) on its phase space, then \(F\) is a first integral if and only if \(H\) and \(F\) are in involution.
</p>

</li>

</ul>

</div>

<p>
This corollary implies some further interesting corollaries.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-190"></a>
<span class="amsthmnameplain">Corollary</span><span class="amsthmnumberplain"> <span class="textup">3.6</span></span>. </span> The first integrals of a hamiltonian system form a subalgebra of the Lie algebra \(\mathcal {C}^\infty
(T^*M)\). Otherwise said, given two first integrals \(F\) and \(G\) of a hamiltonian system, then also the function \(\big \{F,G\big \}\) is a first integral of \(H\).
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-191"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> By the previous corollary \(\big \{F,H\big \} = \big \{G,H\big \} = 0\).
</p>

<p>
Jacobi identity then implies that \(\big \{\big \{F,G\big \},H\big \} = 0\), i.e., \(\big \{F,G\big \}\) is a first integral of \(H\). <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-192"></a>
<span class="amsthmnameplain">Corollary</span><span class="amsthmnumberplain"> <span class="textup">3.7</span></span>. </span> The hamiltonian function \(H\) is a first integral of the hamiltonian system <span class="textup">(<a
href="chapter-3.html#eq:Hamsys">3.31</a>)</span>.
</p>

</li>

</ul>

</div>

<p>
Which is the hamiltonian version of the conservation of energy, see Theorem&nbsp;<a href="chapter-1.html#thm:conservationEnergy">1.7</a>. In fact, we can reformulate this corollary as follows.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-193"></a>
<span class="amsthmnameplain">Corollary</span><span class="amsthmnumberplain"> <span class="textup">3.8</span></span>. </span> The integral curves \(p = p(t)\) and \(q=q(t)\) of the hamiltonian system <span class="textup">(<a
href="chapter-3.html#eq:Hamsys">3.31</a>)</span> belong to the levelset of the hamiltonian function, i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{}{82}\)</span>

<!--



                                                                                                            H(q(t), p(t)) = const.                                                                                         (3.83)

-->

<p>


\begin{equation}
H(q(t), p(t)) = \mathrm {const}.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<!--
...... subsection The symplectic matrix ......
-->
<h5 id="autosec-194"><span class="sectionnumber">3.4.1&#x2003;</span>The symplectic matrix</h5>
<a id="hm-autopage-194"></a>


<a id="sec:symplmat"></a>

<p>
Denote the \(2n\) coordinates on \(T^*M\) as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{83}\)</span>

<!--


                                                                                                            x = (x1 , . . . , x2n ) := (q 1 , . . . , q n , p1 , . . . , pn ).                                     (3.84)

-->

<p>

\begin{equation}
x=(x^1, \ldots , x^{2n}) := (q^1, \ldots , q^n, p_1, \ldots , p_n).
\end{equation}

</p>

<p>
With this notation, the hamiltonian system <span class="textup">(<a href="chapter-3.html#eq:Hamsys">3.31</a>)</span> takes the form
</p>

<span class="hidden"> \(\seteqnumber{0}{}{84}\)</span>

<!--


                                                                                                                    ẋk = xk , H ,                                                                                 (3.85)
                                                                                                                         
                                                                                                                                                 k = 1, . . . , 2n.

-->

<p>

\begin{equation}
\dot x^k = \big \{x^k, H\big \}, \qquad k=1,\ldots ,2n.
\end{equation}

</p>

<p>
We can write the Poisson bracket of the coordinate functions <span class="textup">(<a href="chapter-3.html#eq:coordcommutators">3.80</a>)</span> as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{85}\)</span>

<!--


                                                                                                                                                                                                                   (3.86)
                                                                                                                   k l
                                                                                                                   x , x = J kl ,               k, l = 1, . . . , 2n,

-->

<p>

\begin{equation}
\big \{x^k, x^l\big \} = J^{kl}, \qquad k,l = 1,\ldots ,2n,
\end{equation}

</p>

<p>
where \(J^{kl}\) are the matrix elements of the following antisymmetric matrix, called the <em>symplectic matrix</em>,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{86}\)</span>

<!--


                                                                                                  Idn
                                                                                                     
                                                                                          0
                                                          J = J kl                =                     .                                                                         (3.87)   --><a id="eq:symmat"></a><!--
                                                                      1≤k,l≤2n            − Idn    0

-->

<p>

\begin{equation}
\label {eq:symmat} J = \left (J^{kl}\right )_{1\leq k,l\leq 2n} = \begin{pmatrix}0 &amp; \Id _n \\ -\Id _n &amp; 0\end {pmatrix}.
\end{equation}

</p>

<p>
Then formula <span class="textup">(<a href="chapter-3.html#def:Poisson">3.77</a>)</span> for the Poisson bracket of two arbitrary functions takes the following form
</p>

<span class="hidden"> \(\seteqnumber{0}{}{87}\)</span>

<!--

                                                                                   ∂f ∂g
                                                                     f, g = J kl                                                                                                 (3.88)    --><a id="eq:coordPB"></a><!--
                                                                 
                                                                                           ,
                                                                                   ∂xk ∂xl
-->

<p>

\begin{equation}
\label {eq:coordPB} \big \{f,g\big \} = J^{kl} \frac {\partial f}{\partial x^k}\frac {\partial g}{\partial x^l},
\end{equation}

</p>

<p>
and the hamiltonian system <span class="textup">(<a href="chapter-3.html#eq:Hamsys">3.31</a>)</span> can be rewritten as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{88}\)</span>

<!--

                                                                                                                                  ∂H
                                                                                                                    ẋk = J kl        ,         k = 1, . . . , 2n,                                                 (3.89)
                                                                                                                                  ∂xl
-->

<p>

\begin{equation}
\dot x^k = J^{kl} \frac {\partial H}{\partial x^l}, \qquad k=1,\ldots ,2n,
\end{equation}

</p>

<p>
or, more compactly,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{89}\)</span>

<!--

                                                                                  ∂H
                                                                         ẋ = J      .                                                                                           (3.90)    --><a id="eq:hamsysJ"></a><!--
                                                                                  ∂x
-->

<p>

\begin{equation}
\label {eq:hamsysJ} \dot x = J \frac {\partial H}{\partial x}.
\end{equation}

</p>
<!--
...... subsection A brief detour on time-dependent hamiltonians ......
-->
<h5 id="autosec-195"><span class="sectionnumber">3.4.2&#x2003;</span>A brief detour on time-dependent hamiltonians</h5>
<a id="hm-autopage-195"></a>


<a id="sec:timedepH"></a>

<p>
<span
    class="textcolor"
    style="color:#FF0000"
>TODO: Imprecise and partially incorrect, rewrite</span>
</p>

<p>
Let \(L=L(q,\dot q,t): TM\times \mathbb {R}\to \mathbb {R}\), \(q=(q^1,\ldots ,q^n)\in M\), be the time-dependent lagrangian of some mechanical system as in Exercise&nbsp;<a href="chapter-3.html#exe:timedep">3.3</a>.
</p>

<p>
Also in this case we can arrive to canonical equations of the form <span class="textup">(<a href="chapter-3.html#eq:Hamsys">3.31</a>)</span>, however these will be on the extended space \(T^*M\times \mathbb {R}^2\). The local
coordinates \((q^1,\ldots ,q^n, p_1, \ldots ,p_n, q^{n+1}, p_{n+1})\) on \(T^*M\times \mathbb {R}^2\) are such that \(q^i, p_i\) remain the same for \(i\leq n\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{90}\)</span>

<!--


                                                                                                                    q n+1 = t,        and      pn+1 = E,                                                                                             (3.91)

-->

<p>

\begin{equation}
q^{n+1} = t, \quad \mbox {and}\quad p_{n+1} = E,
\end{equation}

</p>

<p>
where \(E\) is a new independent variable, and the new hamiltonian is
</p>
<span class="hidden"> \(\seteqnumber{0}{}{91}\)</span>


<!--



                                                                                                        Ĥ = H(q 1 , . . . , q n , p1 , . . . , pn , t) − pn+1 q̇ n+1                                                                                (3.92)
                                                                                                                        1        n
                                                                                                           = H(q , . . . , q , p1 , . . . , pn , t) − E.                                                                                             (3.93)



-->


<p>

\begin{align}
\hat H &amp; = H(q^1, \ldots , q^n, p_1, \ldots , p_n, t) - p_{n+1}\dot q^{n+1} \\ &amp; = H(q^1, \ldots , q^n, p_1, \ldots , p_n, t) - E.
\end{align}
Here, \(H\) is given by the usual formula
</p>

<span class="hidden"> \(\seteqnumber{0}{}{93}\)</span>

<!--

                                                                                                                n
                                                                                                                                                                                                                                                     (3.94)
                                                                                                                X
                                                                                                         H=             pi q̇ i − L(q, q̇, t),     q̇ i = q̇ i (q, p, t).
                                                                                                                  i=1


-->

<p>

\begin{equation}
H = \sum _{i=1}^n p_i \dot q^i - L(q, \dot q, t), \quad \dot q^i = \dot q^i(q,p,t).
\end{equation}

</p>

<p>
The corresponding hamiltonian system is
</p>
<span class="hidden"> \(\seteqnumber{0}{}{94}\)</span>


<!--



                                                                                                                    ∂ Ĥ                  ∂ Ĥ
                                                                                                           q̇ i =        ,     ṗi = −         ,    i = 1, . . . , n                                                                                 (3.95)
                                                                                                                    ∂pi                   ∂q i
                                                                                                                  ∂ Ĥ                        ∂ Ĥ
                                                                                                           ṫ =        = 1,          Ė = −        .                                                                                                 (3.96)
                                                                                                                  ∂E                           ∂t


-->


<p>

\begin{align}
&amp; \dot q^i = \frac {\partial \hat H}{\partial p_i}, \quad \dot p_i = -\frac {\partial \hat H}{\partial q^i}, \quad i=1,\ldots ,n \\ &amp; \dot t = \frac {\partial \hat H}{\partial E} = 1, \quad {\dot E} =
-\frac {\partial \hat H}{\partial t}.
\end{align}
The first \(2n\) equations above are equivalent to the Euler-Lagrange equations for \(L\), the equation for \(q^{n+1} = t\) tells us that \(t\) is the same as in the original lagrangian and the final equation is simply the variation of the energy
</p>

<span class="hidden"> \(\seteqnumber{0}{}{96}\)</span>

<!--

                                                                                                                                          ∂H
                                                                                                                                  Ė =       .                                                                                                       (3.97)
                                                                                                                                          ∂t
-->

<p>

\begin{equation}
\dot E = \frac {\partial H}{\partial t}.
\end{equation}

</p>

<p>
If we restrict ourselves to the zero levelset \(\hat H = H - E = 0\), then the hamiltonian system is equivalent to the Euler-Lagrange equations for \(L\) and the equation
</p>

<span class="hidden"> \(\seteqnumber{0}{}{97}\)</span>

<!--

                                                                                                                              n
                                                                                                                                                                                                                                                     (3.98)
                                                                                                                              X
                                                                                                                        E=           pi q̇ i − L(q, q̇, t),
                                                                                                                              i=1


-->

<p>

\begin{equation}
E = \sum _{i=1}^n p_i \dot q^i - L(q, \dot q, t),
\end{equation}

</p>

<p>
which completes the recovering of the original dynamics.
</p>

<p>
The duality between time and energy and the reason they enter in this picture with a negative sign becomes clearer once one looks at variational principles from the hamiltonian point of view, coming up in the next section.
</p>
<!--
...... section Variational principles of hamiltonian mechanics ......
-->
<h4 id="autosec-196"><span class="sectionnumber">3.5&#x2003;</span>Variational principles of hamiltonian mechanics</h4>
<a id="hm-autopage-196"></a>


<p>
Given a hamiltonian system \(h\), can we describe its solutions of \(q=q(t)\), \(p=p(t)\) in terms of a variational principle as we do in Lagrangian mechanics?
</p>

<p>
A natural way to approach this question is to go back to Hamilton’s variational principle, see Section&nbsp;<a href="chapter-1.html#sec:varpri">1.2</a>, and use <span class="textup">(<a
href="chapter-3.html#eq:inverseLegendre">3.55</a>)</span> to invert Legendre transformation. In fact, this is not in vane and one ends up showing the following theorem.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-197"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.9</span></span>. </span> <a id="thm:variationalHamilton"></a> The solutions of a hamiltonian system <span
class="textup">(<a href="chapter-3.html#eq:Hamsys">3.31</a>)</span> with hamiltonian \(H=H(q,p)\) are the critical points of the functional
</p>

<span class="hidden"> \(\seteqnumber{0}{}{98}\)</span>

<!--

                                                       Z t2                     
                                                  S=            pi q̇ i − H(q, p) dt,   q(t1 ) = q1 ,   q(t2 ) = q2 .                                      (3.99)                --><a id="eq:variationalHamilton"></a><!--
                                                        t1


-->

<p>


\begin{equation}
\label {eq:variationalHamilton} S = \int _{t_1}^{t_2} \left (p_i\dot q^i - H(q,p)\right ) \dd t, \quad q(t_1) = q_1, \quad q(t_2) = q_2.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>

<p>
Note that, even though \(p\) and \(q\) play a rather symmetric role, we only fix the values of \(q\) at the endpoints \(t=t_1\) and \(t=t_2\), while \(p\) can be arbitrary.
</p>
<div class="amsthmproof">

<a id="hm-autopage-198"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> Computing the variation of the action \(\delta S = S[q+\delta q, p + \delta p]\), one finds
</p>
<span class="hidden"> \(\seteqnumber{0}{}{99}\)</span>



<!--


                                                                                                      Z t2                                              
                                                                                                                                     ∂H i ∂H
                                                                                                δS =           i            i
                                                                                                             q̇ δpi + pi δ q̇ − i δq −                δpi dt                                                                                           (3.100)
                                                                                                      t1                             ∂q           ∂pi
                                                                                                                    Z  t2                                         
                                                                                                            t2                                    ∂H        ∂H
                                                                                                   = pi δq i +              q̇ i δpi − ṗi δq i − i δq i −      δpi dt                                                                                 (3.101)
                                                                                                            t1        t1                          ∂q        ∂pi
                                                                                                     Z t2                                            
                                                                                                                       ∂H                        ∂H
                                                                                                   =           q̇ i −           δpi − ṗi + i δq i dt.                                                                                                 (3.102)
                                                                                                      t1               ∂pi                       ∂q



-->



<p>


\begin{align}
\delta S &amp; = \int _{t_1}^{t_2} \left ( \dot q^i \delta p_i + p_i \delta \dot q^i - \frac {\partial H}{\partial q^i}\delta q^i - \frac {\partial H}{\partial p_i}\delta p_i \right ) \dd t \\ &amp; = p_i \delta
q^i\Big |_{t_1}^{t_2} + \int _{t_1}^{t_2} \left ( \dot q^i \delta p_i - \dot p_i \delta q^i - \frac {\partial H}{\partial q^i}\delta q^i - \frac {\partial H}{\partial p_i}\delta p_i \right ) \dd t \\ &amp; = \int
_{t_1}^{t_2} \left [ \left (\dot q^i - \frac {\partial H}{\partial p_i} \right ) \delta p_i - \left (\dot p_i + \frac {\partial H}{\partial q^i}\right ) \delta q^i \right ] \dd t.
\end{align}
In the second step we integrated by parts, while for the last step we used the fact that \(\delta q^i\) is zero at the endpoints. The statement now follows from the arbitrariness of \(\delta q\) and \(\delta p\). <span
class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
Note that often the action <span class="textup">(<a href="chapter-3.html#eq:variationalHamilton">3.99</a>)</span> above is written as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{102}\)</span>

<!--

                                                                                                                          Z t2
                                                                                                                     S=          (pi dq i − Hdt),                                                                                                      (3.103)
                                                                                                                            t1


-->

<p>

\begin{equation}
S = \int _{t_1}^{t_2} (p_i \dd q^i - H \dd t),
\end{equation}

</p>

<p>
where is implied that on the curves \(q=q(t)\), \(p=p(t)\) one makes the substitution \(p_i \dd q^i = p_i(t) \dot q^i (t) \dd t\).
</p>

<p>
Interestingly, this is not the only way to formulate a hamiltonian variational approach. An alternative approach, the so-called <em>Maupertuis variational principle</em> considers the curves that satisfy conservation of energy, resulting in the
following theorem.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-199"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.10</span></span>. </span> Given a function \(H=H(q,p)\) and a real number \(E\), then the (isoenergetic) <em>trajectories</em>
of the hamiltonian system with hamiltonian \(H\) are the critical points of the truncated action
</p>

<span class="hidden"> \(\seteqnumber{0}{}{103}\)</span>

<!--

                                                                  Z q2
                                                           S0 =          pi dq i                                          (3.104)                                                   --><a id="eq:variationalMaupertuis"></a><!--
                                                                   q1


-->

<p>


\begin{equation}
\label {eq:variationalMaupertuis} S_0 = \int _{q_1}^{q_2} p_i \dd q^i
\end{equation}


</p>

<p>
in the class of curves \(q=q(t)\), \(p=p(t)\) belonging to the levelset
</p>

<span class="hidden"> \(\seteqnumber{0}{}{104}\)</span>

<!--



                                                                                                          H(q(t), p(t)) = E                                                                                                  (3.105)

-->

<p>


\begin{equation}
H(q(t),p(t)) = E
\end{equation}


</p>

<p>
and connecting the initial point \(q=q_1\) with the final point \(q=q_2\).
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-200"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">3.5</span></span>. </span> Maupertuis principle is a variational principle in configuration space: it determines only the
trajectories of the motion, not the dynamics on the trajectories.
</p>

<p>
In fact, we cannot even fix the time \(t=t_2\) of arrival at the endpoint \(q=q_2\): it will be implicitly determined by the solution of the variational problem.
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-201"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> Being a variation with constraints, it is natural to apply the Lagrange multipliers method shown in Section&nbsp;<a
href="chapter-2.html#sec:LagrangeConstraints">2.5</a> and proceed similarly as the previous proof. We end up with the following equation
</p>

<span class="hidden"> \(\seteqnumber{0}{}{105}\)</span>

<!--

                                                                                                              Z h                            i
                                                                                                          δ      pi q̇ i − λ(t) (H(q, p) − E) dt = 0,                                                                                              (3.106)

-->

<p>


\begin{equation}
\delta \int \left [p_i \dot q^i - \lambda (t)\left (H(q,p) - E\right )\right ]\dd t = 0,
\end{equation}


</p>

<p>
which, again mimicking the previous proof, reduces to the equations
</p>

<span class="hidden"> \(\seteqnumber{0}{}{106}\)</span>

<!--


                                                                                                                   ∂H                       ∂H
                                                                                                     q̇ i = λ(t)       ,      ṗi = −λ(t)        ,   H(q, p) = E.                                                                                  (3.107)
                                                                                                                   ∂pi                      ∂q i

-->

<p>


\begin{equation}
\dot q^i = \lambda (t) \frac {\partial H}{\partial p_i}, \quad \dot p_i = -\lambda (t) \frac {\partial H}{\partial q^i}, \quad H(q,p) = E.
\end{equation}


</p>

<p>
The time reparametrization \(\dd s = \lambda (t)\dd t\) reduces the system to the canonical equation, proving the theorem. <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
An important application of Maupertuis principle is the determination of the projections \(q=q(t)\) on the configuration space \(M\) of the trajectories in the phase space \(T^*M\). To such end, one restricts the functional on the subset of curves
that satisfy the equations
</p>

<span class="hidden"> \(\seteqnumber{0}{}{107}\)</span>

<!--

                                                                                                                            ∂H(q, p)
                                                                                                                 q̇ i =              ,   i = 1, . . . , n.                                                                                         (3.108)
                                                                                                                              ∂pi

-->

<p>

\begin{equation}
\dot q^i = \frac {\partial H(q,p)}{\partial p_i}, \quad i=1,\ldots ,n.
\end{equation}

</p>

<p>
With the right choice of time parametrization, this ends up being a constraint which is compatible with the variational problem. Solving the equations in the form \(p_i = p_i(q,\dot q)\) and using them in the energy constraint \(H(q, p(q,\dot
q))=E\), we can find \(\dd t\) in terms of the coordinates \(q\) and their differentials \(\dd q\). Once we replace the values in <span class="textup">(<a href="chapter-3.html#eq:variationalMaupertuis">3.104</a>)</span>, we remain with
the variational problem
</p>

<span class="hidden"> \(\seteqnumber{0}{}{108}\)</span>

<!--


                                                                                                                                  ∂q ∂q i
                                                                                                                        Z          
                                                                                                                    δ       pi q,         dt = 0,                                                                                                  (3.109)
                                                                                                                                  ∂t ∂t

-->

<p>

\begin{equation}
\delta \int p_i\left (q, \frac {\partial q}{\partial t}\right ) \frac {\partial q^i}{\partial t} \dd t = 0,
\end{equation}

</p>

<p>
which characterizes the trajectories in configuration space.
</p>

<p>
Let’s try to clarify this with some important examples.
</p>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-202"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.7</span></span><span class="amsthmnotedefinition"> (Geodesics and the free motion on riemannian
manifolds)</span>. </span> Consider a riemannian manifold \((M, g)\), remember that the metric can be written as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{109}\)</span>

<!--



                                                                                                                         ds2 = gij (q)dq i dq j .                                                                    (3.110)

-->

<p>


\begin{equation}
\dd s^2 = g_{ij}(q)\dd q^i \dd q^j.
\end{equation}


</p>

<p>
Consider the free motion of a point particle of mass \(m\). As seen in Example&nbsp;<a href="chapter-3.html#ex:nlrm">3.2</a>, its hamiltonian is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{110}\)</span>

<!--


                                                                                                                                1 ij
                                                                                                                         H=       g (q)pi pj .                                                                       (3.111)
                                                                                                                               2m

-->

<p>


\begin{equation}
H = \frac 1{2m} g^{ij}(q) p_i p_j.
\end{equation}


</p>

<p>
The first group of equation of the hamiltonian system <span class="textup">(<a href="chapter-3.html#eq:Hamsys">3.31</a>)</span> gives the usual relation between momentum and velocity, which we can invert to get
</p>

<span class="hidden"> \(\seteqnumber{0}{}{111}\)</span>

<!--



                                                                                                                           pi = mgij (q)q̇ j .                                                                       (3.112)

-->

<p>


\begin{equation}
p_i = m g_{ij}(q)\dot q^j.
\end{equation}


</p>

<p>
Replacing them in the energy conservation law we get
</p>

<span class="hidden"> \(\seteqnumber{0}{}{112}\)</span>

<!--


                                                                                                                      m         dq i dq j
                                                                                                                        gij (q)           = E,                                                                       (3.113)
                                                                                                                      2          dt2

-->

<p>


\begin{equation}
\frac m2 g_{ij}(q)\frac {\dd q^i \dd q^j}{\dd t^2} = E,
\end{equation}


</p>

<p>
which gives
</p>

<span class="hidden"> \(\seteqnumber{0}{}{113}\)</span>

<!--

                                                                                                                                  r                           r
                                                                                                                                      mp                          m
                                                                                             pi q̇ i dt = 2Edt     and     dt =          gij (q)dq i dq j =          ds.                                             (3.114)
                                                                                                                                      2E                          2E

-->

<p>


\begin{equation}
p_i\dot q^i \dd t= 2E \dd t \quad \mbox {and}\quad \dd t = \sqrt {\frac {m}{2E}}\sqrt {g_{ij}(q)\dd q^i \dd q^j} = \sqrt {\frac {m}{2E}} \dd s.
\end{equation}


</p>

<p>
Gathering all together in <span class="textup">(<a href="chapter-3.html#eq:variationalMaupertuis">3.104</a>)</span> we obtain the variational problem
</p>

<span class="hidden"> \(\seteqnumber{0}{}{114}\)</span>

<!--


                                                                                                                                      √          Z q2
                                                                                                                 δS0 = 0,      S0 =       2mE           ds.                                                          (3.115)
                                                                                                                                                  q1


-->

<p>


\begin{equation}
\delta S_0 = 0, \quad S_0 = \sqrt {2mE}\int _{q_1}^{q_2} \dd s.
\end{equation}


</p>

<p>
Observing that the length functional \(S = \int \dd s\) is invariant with respect to reparametrization, we prove the following theorem.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-203"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.11</span></span>. </span> Given a riemannian manifold \((M,g)\), the trajectories of a free point particle on the manifold are the
geodesics of the metric.
</p>

</li>

</ul>

</div>

<p>
Among the curves connecting two points of the manifold, geodesics are the (piecewise) smooth curves that minimize the distance – in the sense that they are critical points of an action for a non–degenerate hamiltonian (or, equiv., lagrangian).
</p>

<p>
See also [<a href="chapter-6.html#LWR-ht-cite.0@Bolsinov_1995">BKF95</a>] for a more involved application of this.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-204"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.8</span></span><span class="amsthmnotedefinition"> (Jacobi metric)</span>. </span> Let’s consider a mechanical
system \((M,L)\), where \(L\) is a natural lagrangian for a particle of mass \(m\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{115}\)</span>

<!--


                                                                                                                 m
                                                                                                            L=     gij (q)q̇ i q̇ j − U (q),                                                                                              (3.116)
                                                                                                                 2

-->

<p>


\begin{equation}
L = \frac m2 g_{ij}(q) \dot q^i \dot q^j - U(q),
\end{equation}


</p>

<p>
on the tangent bundle of a riemannian manifold \((M,g)\), again like the ones seen in Example&nbsp;<a href="chapter-3.html#ex:hamPot">3.1</a>. As we saw, once we fix the energy level \(E\), the motion of the particle is constrained to remain
in the part of \(M\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{116}\)</span>

<!--



                                                                   U (q) < E.                                                                  (3.117)                                                   --><a id="eq:JacobiDomain"></a><!--

-->

<p>


\begin{equation}
\label {eq:JacobiDomain} U(q) &lt; E.
\end{equation}


</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-205"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.12</span></span>. </span> The trajectories of the mechanical system \((M,L)\) in the domain <span class="textup">(<a
href="chapter-3.html#eq:JacobiDomain">3.117</a>)</span> are the geodesic of the metric
</p>

<span class="hidden"> \(\seteqnumber{0}{}{117}\)</span>

<!--



                                                  ds2E = 2m(E − U (q))gij (q)dq i dq j .                                        (3.118)                                                    --><a id="eq:JacobiMetric"></a><!--

-->

<p>


\begin{equation}
\label {eq:JacobiMetric} \dd s^2_E = 2m (E-U(q)) g_{ij}(q)\dd q^i \dd q^j.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-206"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> As in the previous example, a direct computation shows that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{118}\)</span>

<!--


                                                                                                                                                   ds
                                                                                                                                           r
                                                                                                                                               m
                                                                                                   pi q̇ i dt = 2(E − U (q))dt,     dt =         p         .                                                                                     (3.119)
                                                                                                                                               2 E − U (q)

-->

<p>


\begin{equation}
p_i \dot q^i \dd t = 2 (E-U(q)) \dd t, \quad \dd t = \sqrt {\frac {m}{2}} \frac {\dd s}{\sqrt {E-U(q)}}.
\end{equation}


</p>

<p>
Then, for the action, one gets
</p>

<span class="hidden"> \(\seteqnumber{0}{}{119}\)</span>

<!--

                                                                                                                 Z p                            Z
                                                                                                          S0 =         2m(E − U (q))ds =            dsE ,                                                                                        (3.120)

-->

<p>


\begin{equation}
S_0 = \int \sqrt {2m(E-U(q))}\dd s = \int \dd s_E,
\end{equation}


</p>

<p>
which coincides with the length of the curve in the metric <span class="textup">(<a href="chapter-3.html#eq:JacobiMetric">3.118</a>)</span>. <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
The metric <span class="textup">(<a href="chapter-3.html#eq:JacobiMetric">3.118</a>)</span> is called <em>Jacobi metric</em>. The dynamics on geodesics of the Jacobi metric is determined by the quadrature
</p>

<span class="hidden"> \(\seteqnumber{0}{}{120}\)</span>

<!--


                                                                                                                                      dsE
                                                                                                                                Z
                                                                                                                            1
                                                                                                                 t − t0 =                     .                                                                                                  (3.121)
                                                                                                                            2       E − U (q)

-->

<p>


\begin{equation}
t - t_0 = \frac 12 \int \frac {\dd s_E}{E-U(q)}.
\end{equation}


</p>

<p>
Jacobi metric is often useful in practice, allowing to use the whole machinery around geodesic motions in riemannian manifolds to study properties of the hamiltonian dynamics. For an application to find periodic trajectories of the double pendulum,
developed in all the details, you can refer to [<a href="chapter-6.html#LWR-ht-cite.0@book:knauf">Kna18</a>, Example 8.32].
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-207"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.9</span></span><span class="amsthmnotedefinition"> (Fermat principle and geometric optics)</span>. </span>
Propagation of light in an isotropic medium is described by the hamiltonian
</p>

<span class="hidden"> \(\seteqnumber{0}{}{121}\)</span>

<!--



                                                                                                                H(x, p) = c(x)kpk,                                                                                    (3.122)

-->

<p>


\begin{equation}
H(\vb *{x}, \vb *{p}) = c(\vb *{x}) \|\vb *{p}\|,
\end{equation}


</p>

<p>
where \(c(\vb *{x}) &gt; 0\) gives the speed of light at the point \(\vb *{x}\). Using the procedure described above, one arrives at
</p>

<span class="hidden"> \(\seteqnumber{0}{}{122}\)</span>

<!--


                                                                                                                        p                E
                                                                                                           ẋ = c(x)       ,    kpk =        ,                                                                        (3.123)
                                                                                                                       kpk              c(x)

-->

<p>


\begin{equation}
\dot {\vb *{x}} = c(\vb *{x})\frac {\vb *{p}}{\|\vb *{p}\|}, \quad \|\vb *{p}\| = \frac {E}{c(\vb *{x})},
\end{equation}


</p>

<p>
which imply
</p>

<span class="hidden"> \(\seteqnumber{0}{}{123}\)</span>

<!--


                                                                                                                                     E
                                                                                                         hp, dxi = kpkk dx k =           k dx k.                                                                      (3.124)
                                                                                                                                    c(x)

-->

<p>


\begin{equation}
\langle \vb *{p}, \dd {\vb *{x}}\rangle = \|\vb *{p}\|\|\dd {\vb *{x}}\| = \frac {E}{c(\vb *{x})}\|\dd {\vb *{x}}\|.
\end{equation}


</p>

<p>
For the action <span class="textup">(<a href="chapter-3.html#eq:variationalMaupertuis">3.104</a>)</span> we end up with
</p>

<span class="hidden"> \(\seteqnumber{0}{}{124}\)</span>

<!--


                                                                                                                                 k dx k
                                                                                                                          Z x2
                                                                                                                S0 = E                  ,                                                                             (3.125)
                                                                                                                           x1     c(x)

-->

<p>


\begin{equation}
S_0 = E \int _{\vb *{x}_1}^{\vb *{x}_2} \frac {\|\dd {\vb *{x}}\|}{c(\vb *{x})},
\end{equation}


</p>

<p>
which is \(E\) multiplied by the time of propagation of light between the points \(\vb *{x}_1\) and \(\vb *{x}_2\).
</p>

<p>
In summary, we have shown the following.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-208"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.13</span></span>. </span> Light in an isotropic medium propagates in a way that minimizes the travel time. The trajectories
followed by the light are the geodesics of the metric
</p>

<span class="hidden"> \(\seteqnumber{0}{}{125}\)</span>

<!--


                                                                                                                             ds2
                                                                                                              ds2Fermat =                                                                                                     (3.126)
                                                                                                                            c2 (x)

-->

<p>


\begin{equation}
\dd s^2_{\mathrm {Fermat}} = \frac {\dd s^2}{c^2(\vb *{x})}
\end{equation}


</p>

<p>
where
</p>

<span class="hidden"> \(\seteqnumber{0}{}{126}\)</span>

<!--



                                                                                                        ds2 = dx2 = dx2 + dy 2 + dz 2 .                                                                                       (3.127)

-->

<p>


\begin{equation}
\dd s^2 = \dd {\vb *{x}}^2 = \dd x^2 + \dd y^2 + \dd z^2.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>

<p>
You can see how this is used to study mirages in [<a href="chapter-6.html#LWR-ht-cite.0@book:knauf">Kna18</a>, Example 8.34]. For a nice account of geometric optics refer to [<a
href="chapter-6.html#LWR-ht-cite.0@book:knauf">Kna18</a>, Chapter 8.7], an interesting historical take is presented in [<a href="chapter-6.html#LWR-ht-cite.0@book:broer">Bro16</a>].
</p>

</li>

</ul>

</div>
<!--
...... section Canonical transformations ......
-->
<h4 id="autosec-209"><span class="sectionnumber">3.6&#x2003;</span>Canonical transformations</h4>
<a id="hm-autopage-209"></a>


<p>
Let \(M\) be a smooth manifold. In Section&nbsp;<a href="chapter-3.html#sec:poisson">3.4</a> we saw that, thanks to the Poisson bracket, we can endow \(\mathcal {C}^\infty (T^*M)\) with a Lie algebra structure, see Theorem&nbsp;<a
href="chapter-3.html#thm:PoissonLieAlgebra">3.3</a>.
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
We call <em>canonical transformation</em> of \(T^*M\) a diffeomorphism \(\Phi : T^*M\to T^*M\) such that the function
</p>

<span class="hidden"> \(\seteqnumber{0}{}{127}\)</span>

<!--


                                                                                                     Φ∗ : C ∞ (T ∗ M ) → C ∞ (T ∗ M ),    Φ∗ f (x) := f (Φ(x)),                                                                      (3.128)

-->

<p>

\begin{equation}
\Phi ^*: \mathcal {C}^\infty (T^*M) \to \mathcal {C}^\infty (T^*M),\quad \Phi ^* f(x) := f(\Phi (x)),
\end{equation}

</p>

<p>
induced by \(\Phi \) on \(\mathcal {C}^\infty (T^*M)\), is an automorphism of the Lie algebra, i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{}{128}\)</span>

<!--


                                                                                                                                                         (3.129)                                       --><a id="eq:automorphism"></a><!--
                                              ∗
                                              Φ f, Φ∗ g = Φ∗ f, g ,          ∀f, g ∈ C ∞ (T ∗ M ).
                                                            


-->

<p>

\begin{equation}
\label {eq:automorphism} \big \{\Phi ^* f, \Phi ^* g\big \} = \Phi ^*\big \{f,g\big \}, \qquad \forall f,g\in \mathcal {C}^\infty (T^*M).
\end{equation}

</p>

</div>

</div>

<p>
In the coordinates \(x=(x^1, \ldots , x^{2n})\) on \(T^*M\) defined in Section&nbsp;<a href="chapter-3.html#sec:symplmat">3.4.1</a>, \(\Phi \) is described by \(2n\) functions of \(2n\) variables,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{129}\)</span>

<!--


                                                                                                       x(x1 , . . . , x2n ) 7→ Φ(x) = Φ1 (x), . . . , Φ2n (x) ,                                                                      (3.130)
                                                                                                                                                             


-->

<p>

\begin{equation}
x(x^1,\ldots ,x^{2n}) \mapsto \Phi (x) = \left (\Phi ^1(x), \ldots , \Phi ^{2n}(x)\right ),
\end{equation}

</p>

<p>
and <span class="textup">(<a href="chapter-3.html#eq:automorphism">3.129</a>)</span> takes the form (<b>exercise</b>)
</p>

<span class="hidden"> \(\seteqnumber{0}{}{130}\)</span>

<!--


                                               ∂Φk (x) ij ∂Φl (x)
                                                      J           = J kl ,   k, l = 1, . . . , 2n.                                                      (3.131)                                        --><a id="eq:cantrafocoord"></a><!--
                                                ∂xi        ∂xj
-->

<p>

\begin{equation}
\label {eq:cantrafocoord} \frac {\partial \Phi ^k(x)}{\partial x^i} J^{ij} \frac {\partial \Phi ^l(x)}{\partial x^j} = J^{kl},\quad k,l=1,\ldots ,2n.
\end{equation}

</p>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-210"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.10</span></span>. </span> The transformation \(\Phi : (q,p) \mapsto (p, -q)\) is a canonical transformation. To
show it, it is enough to verify how the Poisson bracket acts on the coordinate functions. Let, as usual,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{131}\)</span>

<!--



                                                                                                           x = (x1 , . . . , x2n ) = (q 1 , . . . , q n , p1 , . . . , pn )                                             (3.132)

-->

<p>


\begin{equation}
x=(x^1, \ldots ,x^{2n})=(q^1,\ldots ,q^n,p_1,\ldots ,p_n)
\end{equation}


</p>

<p>
and denote \(Q,P\) be the new coordinates, then \(Q^i := \Phi (x)^i = p_i\), \(P_i := \Phi (x)^{n+i} = -q^i\), \(i=1,\ldots , n\). We can immediately compute
</p>
<span class="hidden"> \(\seteqnumber{0}{}{132}\)</span>



<!--



                                                                                                               Qi , Qj = pi , pj = 0                                                                                    (3.133)
                                                                                                                        

                                                                                                               Pi , Pj = − q i , −q j = q i , q j = 0                                                                   (3.134)
                                                                                                                                      

                                                                                                                                                                                                                        (3.135)
                                                                                                              i
                                                                                                               Q , Pj = pi , −q j = q j , pi = δij
                                                                                                                                     




-->



<p>


\begin{align}
&amp; \big \{Q^i, Q^j\big \} = \big \{p_i, p_j\big \} = 0 \\ &amp; \big \{P_i, P_j\big \} = \big \{-q^i, -q^j\big \} = \big \{q^i, q^j\big \} = 0 \\ &amp; \big \{Q^i, P_j\big \} = \big \{p_i, -q^j\big \} = \big
\{q^j, p_i\big \} = \delta ^j_i
\end{align}
for any \(i,j=1,\ldots ,n\). If \(\widetilde x = (\widetilde x^1, \ldots , \widetilde x^{2n})= (Q^1, \ldots , Q^n, P_1,\ldots ,P_n)\), the above can be rewritten as \(\Phi ^*\big \{x^i, x^j\big \} = \Phi ^* J^{ij} = J^{ij}
= \big \{\widetilde x^i, \widetilde x^j\big \} = \big \{\Phi ^* x^i, \Phi ^* x^j\big \}\).
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-211"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.11</span></span>. </span> <a id="ex:hamlift1"></a> The cotangent lift \(\Phi \) of a diffeomorphism \(\phi \)
defined on the base manifold \(M\), as defined below, is a canonical transformation.
</p>
<span class="hidden"> \(\seteqnumber{0}{}{135}\)</span>



<!--



                                                                                                                  φ(q) = φ1 (q), . . . , φn (q)                                                                                    (3.136)
                                                                                                                                                  
                                                                                                   φ : M → M,
                                                                                                        ∗
                                                                                                   Φ : T M → T M, ∗
                                                                                                                         Φ(q, p) = (Q, P ),                                                                                        (3.137)



-->



<p>


\begin{align}
&amp; \phi :M\to M, \quad \phi (q) = \left (\phi ^1(q), \ldots , \phi ^n(q)\right ) \\ &amp; \Phi :T^*M\to T^*M, \quad \Phi (q,p) = (Q, P),
\end{align}
where \((Q,P)\) are given by
</p>
<span class="hidden"> \(\seteqnumber{0}{}{137}\)</span>



<!--



                                                                                                      Q = φ(q),                                                                                                                    (3.138)
                                                                                                                                      j
                                                                                                                                   ∂φ (q)
                                                                                                      φ∗ P = p,       (φ∗ P )i =          pj .                                                                                     (3.139)
                                                                                                                                    ∂q i



-->



<p>


\begin{align}
&amp; Q = \phi (q), \\ &amp; \phi ^* P = p, \qquad (\phi ^* P)_i = \frac {\partial \phi ^j(q)}{\partial q^i} p_j.
\end{align}
Here we are abusing slightly the notation, it is more conventional to write \(p = (\dd \phi _{q})^* P\). For a more detailed account, you can have a look at [<a href="chapter-6.html#LWR-ht-cite.0@book:marsdenratiu">MR99</a>, Chapter
6.3 and in particular formula (6.3.4)] or [<a href="chapter-6.html#LWR-ht-cite.0@lectures:aom:seri">Ser20</a>, Proposition 6.2.8].
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-212"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.5</span></span>. </span> Consider the linear transformations on \(\mathbb {R}^{2n}\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{139}\)</span>

<!--



                                                                                                                         x 7→ Ax,                                                                      (3.140)

-->

<p>


\begin{equation}
x \mapsto A x,
\end{equation}


</p>

<p>
were \(A\) is a \(2n\times 2n\) matrix. Show that the transformation is canonical if and only if \(A\) satisfies the identity
</p>

<span class="hidden"> \(\seteqnumber{0}{}{140}\)</span>

<!--



                                                                                                                        AJAT = J,                                                                      (3.141)

-->

<p>


\begin{equation}
A J A^T = J,
\end{equation}


</p>

<p>
where \(J\) is the symplectic matrix.
</p>

</li>

</ul>

</div>

<p>
The following theorem should clarify why canonical transformations are important for us.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-213"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.14</span></span>. </span> <a id="thm:canonicalmapping"></a> Let \(\Phi : T^*M \to T^* M\) be a canonical transformation.
Then, every solution \(x = x(t)\) of the hamiltonian system with hamiltonian \(H\) is mapped by \(\Phi \) into a solution \(\Phi (x(t))\) of the hamiltonian system with hamiltonian \((\Phi ^{-1})^* H\).
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-214"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> Let \(\widetilde x(t) := \Phi (x(t))\). Theorem&nbsp;<a href="chapter-3.html#thm:poissondtdF">3.4</a> implies that for any smooth function \(f\),
it holds
</p>

<span class="hidden"> \(\seteqnumber{0}{}{141}\)</span>

<!--


                                                                                                           d
                                                                                                                                                                                                                         (3.142)
                                                                                                                     
                                                                                                              f (x) = f (x), H(x)               .
                                                                                                           dt                          x=x(t)


-->

<p>


\begin{equation}
\frac {\dd }{\dd t} f(x) = \big \{f(x), H(x)\big \}\Big |_{x=x(t)}.
\end{equation}


</p>

<p>
Which for \(f(\widetilde x(t)) = f(\Phi (x(t))) = \Phi ^* f(x(t))\), reduces to
</p>

<span class="hidden"> \(\seteqnumber{0}{}{142}\)</span>

<!--


                                                                                                            d
                                                                                                                                                                                                                         (3.143)
                                                                                                                         
                                                                                                               f (e
                                                                                                                  x(t)) = f (Φ(x)), H(x) .
                                                                                                            dt

-->

<p>


\begin{equation}
\frac {\dd }{\dd t} f(\widetilde x(t)) = \big \{f(\Phi (x)), H(x)\big \}.
\end{equation}


</p>

<p>
By using \(x = \Phi ^{-1}(\Phi (x))\) and the definition of canonical transformations we can manipulate the right hand side as follows
</p>
<span class="hidden"> \(\seteqnumber{0}{}{143}\)</span>



<!--



                                                                                               f (Φ(x)), H(x) = f (Φ(x)), H(Φ−1 (Φ(x))                                                                                   (3.144)
                                                                                                               

                                                                                                              = Φ∗ f, Φ∗ (Φ−1 )∗ H                                                                                       (3.145)
                                                                                                                

                                                                                                              = Φ∗ f, (Φ−1 )∗ H = f, (Φ−1 )∗ H                                                                           (3.146)
                                                                                                                                  
                                                                                                                                                             .
                                                                                                                                                    x=e
                                                                                                                                                      x(t)




-->



<p>


\begin{align}
\big \{f(\Phi (x)), H(x)\big \} &amp; = \big \{f(\Phi (x)), H(\Phi ^{-1}(\Phi (x))\big \} \\ &amp; = \big \{\Phi ^* f, \Phi ^* (\Phi ^{-1})^* H\big \} \\ &amp; = \Phi ^* \big \{f, (\Phi ^{-1})^* H\big \} = \big
\{f, (\Phi ^{-1})^* H\big \}\Big |_{x=\widetilde x(t)}.
\end{align}
Collecting both sides, one gets
</p>

<span class="hidden"> \(\seteqnumber{0}{}{146}\)</span>

<!--


                                                                                                          d
                                                                                                                x(t)) = f, (Φ−1 )∗ H                                                                                     (3.147)
                                                                                                                       
                                                                                                             f (e
                                                                                                          dt                             x=e
                                                                                                                                           x(t)


-->

<p>


\begin{equation}
\frac {\dd }{\dd t} f(\widetilde x(t)) = \big \{f, (\Phi ^{-1})^* H\big \}\Big |_{x=\widetilde x(t)}
\end{equation}


</p>

<p>
<span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>
<!--
...... subsection Hamiltonian vector fields ......
-->
<h5 id="autosec-215"><span class="sectionnumber">3.6.1&#x2003;</span>Hamiltonian vector fields</h5>
<a id="hm-autopage-215"></a>


<p>
To investigate in more details the connections between canonical transformations and hamiltonian systems, it is convenient to introduce the infinitesimal version of <span class="textup">(<a
href="chapter-3.html#eq:automorphism">3.129</a>)</span>.
</p>

<p>
In the rest of this section we will show that hamiltonian flows can be associated to hamiltonian vector fields which define one–parameter groups of canonical transformations. These will allow us to define hamiltonian symmetries and state the
hamiltonian version of Noether theorem.
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
A vector field \(X\) on the manifold \(T^* M\) is called an <em>infinitesimal symmetry of the Poisson bracket</em> if for any two functions \(f,g \in \mathcal {C}^\infty (T^*M)\) it holds
</p>

<span class="hidden"> \(\seteqnumber{0}{}{147}\)</span>

<!--


                                                                                                                                                  (3.148)                                                            --><a id="eq:infsymm"></a><!--
                                                                        
                                                          X f, g = Xf, g + f, Xg .

-->

<p>

\begin{equation}
\label {eq:infsymm} X\big \{f,g\big \} = \big \{X f, g\big \} + \big \{f, X g\big \}.
\end{equation}

</p>

</div>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-216"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.6</span></span>. </span> <a id="exe:haminfsym"></a> Let \(\Phi _t:T^*M \to T^*M\) denote a one–parameter
group of canonical transformations, i.e \(\big \{\Phi _t^* f, \Phi _t^* g\big \} = \Phi _t^*\big \{f,g\big \}\) for all \(t\in \mathbb {R}\). Show that the vector field \(X\) which generates the group,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{148}\)</span>

<!--


                                                                                                                                 d
                                                                                                                     X(x) :=        Φt (x)     ,                                                                                                   (3.149)
                                                                                                                                 dt        t=0


-->

<p>


\begin{equation}
X(x) := \frac {\dd }{\dd t}\Phi _t(x)\Big |_{t=0},
\end{equation}


</p>

<p>
is an infinitesimal symmetry.
</p>

<p>
Moreover, this relation goes in both ways: show that the one–parameter group \(\Phi _t:T^*M \to T^*M\) associated to an arbitrary infinitesimal symmetry \(X\) acts as a canonical transformation.
</p>

</li>

</ul>

</div>

<p>
Given a function \(H\) on \(T^* M\), Leibnitz rule for the Poisson bracket <span class="textup">(<a href="chapter-3.html#eq:LeibnitzId">3.79</a>)</span> tells us that the mapping
</p>

<span class="hidden"> \(\seteqnumber{0}{}{149}\)</span>

<!--


                                                                            f ∈ C ∞ (T ∗ M ),                                                            (3.150)                                                      --><a id="eq:Hambrace"></a><!--
                                                               
                                                           f 7→ f, H ,

-->

<p>

\begin{equation}
\label {eq:Hambrace} f \mapsto \big \{f,H\big \}, \quad f\in \mathcal {C}^\infty (T^*M),
\end{equation}

</p>

<p>
is a first-order differential operator. Using the identification between derivations, i.e., first-order differential operators, and vector fields we can associate to the operator <span class="textup">(<a
href="chapter-3.html#eq:Hambrace">3.150</a>)</span> a vector field \(X_H\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{150}\)</span>

<!--


                                                                                                                                                                                                                                                   (3.151)
                                                                                                                              
                                                                                                                        XH f = f, H .

-->

<p>

\begin{equation}
X_H f = \big \{f, H\big \}.
\end{equation}

</p>

<p>
Such vector field \(X_H\) is called <em>hamiltonian vector field</em> generated by the <em>hamiltonian</em> \(H\). In local coordinates \(q,p\), the hamiltonian vector field \(X_H\) has the form
</p>

<span class="hidden"> \(\seteqnumber{0}{}{151}\)</span>

<!--

                                                                                                                          ∂H ∂      ∂H ∂
                                                                                                                   XH =            − i     .                                                                                                       (3.152)
                                                                                                                          ∂pi ∂q i  ∂q ∂pi

-->

<p>

\begin{equation}
X_H = \frac {\partial H}{\partial p_i} \frac {\partial }{\partial q^i} - \frac {\partial H}{\partial q^i}\frac {\partial }{\partial p_i}.
\end{equation}

</p>

<p>
In the coordinates \(x = (x^1, \ldots , x^{2n})\) on \(T^*M\), the field has the compact representation
</p>

<span class="hidden"> \(\seteqnumber{0}{}{152}\)</span>

<!--

                                                                                                                                   ∂H ∂
                                                                                                                       XH = J ij           .                                                                                                       (3.153)
                                                                                                                                   ∂xj ∂xi
-->

<p>

\begin{equation}
X_H = J^{ij}\frac {\partial H}{\partial x^j}\frac {\partial }{\partial x^i}.
\end{equation}

</p>

<p>
We have constructed a mapping of the space of smooth functions on \(T^*M\) into the space<sup>6</sup> \(\Gamma (TT^* M)\) of smooth vector fields on \(T^*M\)
</p>

<span class="hidden"> \(\seteqnumber{0}{}{153}\)</span>

<!--


                                                      C ∞ (T ∗ M ) → Γ(T T ∗ M ),   H 7→ XH .                                                         (3.154)                                                      --><a id="eq:antimapping"></a><!--

-->

<p>

\begin{equation}
\label {eq:antimapping} \mathcal {C}^\infty (T^*M) \to \Gamma (TT^* M), \quad H \mapsto X_H.
\end{equation}

</p>

<p>
The Lie bracket of vector fields on a smooth manifold \(N\) [<a href="chapter-6.html#LWR-ht-cite.0@book:lee">J.M13</a>],
</p>

<span class="hidden"> \(\seteqnumber{0}{}{154}\)</span>

<!--


                                                                                                [X, Y ]f := X(Y f ) − Y (Xf ),       f ∈ C ∞ (N ),   X, Y ∈ Γ(T N ),                                                                               (3.155)

-->

<p>

\begin{equation}
[X,Y] f := X(Y f) - Y(X f), \qquad f\in \mathcal {C}^\infty (N), \quad X,Y\in \Gamma (TN),
\end{equation}

</p>

<p>
defines a Lie algebra structure on the space \(\Gamma (TN)\) of vector fields on \(N\). In our case, \(N = T^* M\) and it seems perfectly reasonable to ask if and how this bracket can be related to Poisson bracket. Jacobi identity comes to the rescue,
leading to the following beautiful relation.
</p>
<div role="note" class="footnotes">

<a id="hm-autopage-217"></a>

<p>
<sup>6</sup>&nbsp;Don’t let the \(T\)s scare you, here \(TT^*M\) simply means the tangent bundle to the manifold \(T^*M\).
</p>


</div>



<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker">
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.15</span></span>. </span> <a id="thm:antihom"></a> The mapping <span class="textup">(<a
href="chapter-3.html#eq:antimapping">3.154</a>)</span> in an <em>anti-homomorphism</em> of Lie algebras, i.e., for any two functions \(F\) and \(G\) on \(T^*M\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{155}\)</span>

<!--



                                                                                                            [XF , XG ] = −X         .                                                        (3.156)
                                                                                                                               F,G


-->

<p>


\begin{equation}
[X_{F}, X_{G}] = - X_{\big \{F, G\big \}}.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-218"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> By definition of Lie bracket and of hamiltonian vector field, we have
</p>
<span class="hidden"> \(\seteqnumber{0}{}{156}\)</span>



<!--



                                                                                                          [XF , XG ]f = XF (XG f ) − XG (XF f )                (3.157)
                                                                                                                                                               (3.158)
                                                                                                                                    
                                                                                                                      = f, G , F − f, F , G .



-->



<p>


\begin{align}
[X_{F}, X_{G}] f &amp; = X_{F}(X_{G} f) - X_{G}(X_{F} f) \\ &amp; = \big \{\big \{f, G\big \}, F\big \} - \big \{\big \{f, F\big \}, G\big \}.
\end{align}
Jacobi identity <span class="textup">(<a href="chapter-3.html#eq:JacobiId">3.78</a>)</span> then gives
</p>
<span class="hidden"> \(\seteqnumber{0}{}{158}\)</span>



<!--



                                                                                                                                                               (3.159)
                                                                                                                                        
                                                                                                             f, G , F −        f, F , G = − f, F, G
                                                                                                                                       = −X         f.        (3.160)
                                                                                                                                               F,G




-->



<p>


\begin{align}
\big \{\big \{f, G\big \}, F\big \} - \big \{\big \{f, F\big \}, G\big \} &amp; = - \big \{f,\big \{F,G\big \}\big \} \\ &amp; = - X_{\big \{F, G\big \}} f.
\end{align}
<span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
A crucial property of hamiltonian vector fields is that they are infinitesimal symmetries of the Poisson bracket.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-219"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.16</span></span>. </span> <a id="thm:vf-infsym"></a> The hamiltonian vector field \(X_H\) associated to a smooth function
\(H\) on \(T^*M\) is an infinitesimal symmetry of Poisson bracket. Vice versa, for every infinitesimal symmetry \(X\) there exists a function \(H\) on \(T^*M\) such that \(X = X_H\).
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-220"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> The first part of the theorem follows from Jacobi identity:
</p>
<span class="hidden"> \(\seteqnumber{0}{}{160}\)</span>



<!--



                                                                                                                                                                                                                                            (3.161)
                                                                                                                            
                                                                                                                    XH f, g = f, g , H
                                                                                                                                                                                                                                            (3.162)
                                                                                                                                        
                                                                                                                            = f, H , g + f, g, H
                                                                                                                                                                                                                                            (3.163)
                                                                                                                                      
                                                                                                                            = XH f, g + f, XH g ,



-->



<p>


\begin{align}
X_H \big \{f,g\big \} &amp; = \big \{\big \{f,g\big \}, H\big \} \\ &amp; = \big \{\big \{f,H\big \},g\big \} + \big \{f,\big \{g,H\big \}\big \} \\ &amp; = \big \{X_Hf,g\big \} + \big \{f,X_Hg\big \},
\end{align}
which coincides with <span class="textup">(<a href="chapter-3.html#eq:infsymm">3.148</a>)</span>.
</p>

<p>
For the second part of the theorem we need to do more work. Given two indices \(1\leq i,j \leq 2n\), take the coordinate functions \(f(x) = x^i\) and \(g(x) = x^j\) and use <span class="textup">(<a
href="chapter-3.html#eq:coordPB">3.88</a>)</span> to rewrite <span class="textup">(<a href="chapter-3.html#eq:infsymm">3.148</a>)</span>:
</p>
<span class="hidden"> \(\seteqnumber{0}{}{163}\)</span>



<!--



                                                                                                                                                                                                                                            (3.164)
                                                                                                                                                    
                                                                                                                         0 = Xf, g + f, Xg − X f, g
                                                                                                                           = X i (x), xj + xi , X j (x)                                                                                     (3.165)
                                                                                                                                         

                                                                                                                                      i                j
                                                                                                                                   ∂X         ∂X
                                                                                                                          = J kj       + J ik     .                                                                                         (3.166)
                                                                                                                                   ∂xk        ∂xk



-->



<p>


\begin{align}
0 &amp; = \big \{X f,g\big \} + \big \{f, Xg\big \} - X \big \{f,g\big \} \\ &amp; = \big \{X^i(x),x^j\big \} + \big \{x^i,X^j(x)\big \} \\ &amp; = J^{kj} \frac {\partial X^i}{\partial x^k} + J^{ik} \frac {\partial
X^j}{\partial x^k}.
\end{align}
This has to hold true however we choose the indices, leading to the system of equations
</p>

<span class="hidden"> \(\seteqnumber{0}{}{166}\)</span>

<!--


                                                                       ∂X i        ∂X j
                                                                J kj      k
                                                                            + J ik      = 0,     i, j = 1, . . . , 2n.                                                          (3.167)                           --><a id="eq:systemvfH"></a><!--
                                                                       ∂x          ∂xk

-->

<p>


\begin{equation}
\label {eq:systemvfH} J^{kj} \frac {\partial X^i}{\partial x^k} + J^{ik} \frac {\partial X^j}{\partial x^k} = 0, \quad i,j = 1,\ldots ,2n.
\end{equation}


</p>

<p>
Define
</p>

<span class="hidden"> \(\seteqnumber{0}{}{167}\)</span>

<!--



                                                                                                                    ωi := Jij X j ,       where     (Jij ) := (J ij )−1 .                                                                   (3.168)

-->

<p>


\begin{equation}
\omega _i := J_{ij} X^j, \quad \mbox {where}\quad (J_{ij}) := (J^{ij})^{-1}.
\end{equation}


</p>

<p>
Multiplying <span class="textup">(<a href="chapter-3.html#eq:systemvfH">3.167</a>)</span> by \(J_{\alpha i} J_{\beta j}\), and summing over the repeated indices \(i,j\), we end up with
</p>

<span class="hidden"> \(\seteqnumber{0}{}{168}\)</span>

<!--


                                                                                                                         ∂ωα   ∂ωβ
                                                                                                                             −     = 0,           α, β = 1, . . . , 2n,                                                                     (3.169)
                                                                                                                         ∂xβ   ∂xα

-->

<p>


\begin{equation}
\frac {\partial \omega _\alpha }{\partial x^\beta } - \frac {\partial \omega _\beta }{\partial x^\alpha } = 0, \quad \alpha ,\beta = 1, \ldots , 2n,
\end{equation}


</p>

<p>
which is equivalent to say that the one–form
</p>

<span class="hidden"> \(\seteqnumber{0}{}{169}\)</span>

<!--



                                                                                                                                          ω = ωi dxi                                                                                        (3.170)

-->

<p>


\begin{equation}
\omega = \omega _i \dd x^i
\end{equation}


</p>

<p>
is closed, \(\dd \omega = 0\).
</p>

<p>
Poincaré lemma [<a href="chapter-6.html#LWR-ht-cite.0@book:lee">J.M13</a>] then implies that, <em>locally</em>, there exists a function \(H\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{170}\)</span>

<!--


                                                                                                                                                 ∂H
                                                                                                                  ω = dH,      i.e.       ωi =       ,     i = 1, . . . , 2n.                                                               (3.171)
                                                                                                                                                 ∂xi

-->

<p>


\begin{equation}
\omega = \dd H, \quad \mbox {i.e.}\quad \omega _i = \frac {\partial H}{\partial x^i}, \quad i=1,\ldots ,2n.
\end{equation}


</p>

<p>
Solving the equations \(J_{ij} X^j = \frac {\partial H}{\partial x^i}\) with respect to \(X\), we get
</p>

<span class="hidden"> \(\seteqnumber{0}{}{171}\)</span>

<!--


                                                                                              ∂H
                                                                                 X j = J ji       ,                                                                             (3.172)                           --><a id="eq:hamsysJ-1"></a><!--
                                                                                              ∂xi

-->

<p>


\begin{equation}
\label {eq:hamsysJ-1} X^j = J^{ji} \frac {\partial H}{\partial x^i},
\end{equation}


</p>

<p>
which, recall equation <span class="textup">(<a href="chapter-3.html#eq:hamsysJ">3.90</a>)</span>, is exactly the hamiltonian vector field \(X_H\). <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
Given a one–parameter group of canonical transformations \(\Phi _t:T^*M\to T^*M\), we call <em>hamiltonian generator</em> of the group the hamiltonian \(H\) on \(T^*M\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{172}\)</span>

<!--

                                                                                                                              d
                                                                                                                                 Φt (x)     = XH (x).                                                                                       (3.173)
                                                                                                                              dt        t=0

-->

<p>

\begin{equation}
\frac {\dd }{\dd t}\Phi _t(x)\Big |_{t=0} = X_H(x).
\end{equation}

</p>

</div>

</div>

<p>
Even though we only proved the local existence of the hamiltonian generator there are many examples of globally defined generators of the group – as was the case for the generators of symmetries in the Lagrangian setting.
</p>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-221"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.7</span></span>. </span> Let \(\Phi _t\) the one–parameter group of canonical transformations generated by the
quadratic hamiltonian
</p>

<span class="hidden"> \(\seteqnumber{0}{}{173}\)</span>

<!--

                                                                                                              n
                                                                                                           1 X 2            
                                                                                                     H=          pi + (q i )2 .                                                                                            (3.174)
                                                                                                           2 i=1

-->

<p>


\begin{equation}
H = \frac 12 \sum _{i=1}^n\left (p_i^2 + (q^i)^2\right ).
\end{equation}


</p>

<p>
Show that the transformation \(\Phi _{t=\frac \pi 2}\) acts as follows
</p>

<span class="hidden"> \(\seteqnumber{0}{}{174}\)</span>

<!--



                                                                                                      Φt= π2 : (q, p) 7→ (p, −q)                                                                                           (3.175)

-->

<p>


\begin{equation}
\Phi _{t=\frac \pi 2} : (q,p) \mapsto (p, -q)
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-222"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.8</span></span>. </span> Let \(\phi _t:M\to M\) denote a one–parameter group of diffeomorphisms of the base \(M\)
of the cotangent bundle \(T^*M\). Consider, as in Example&nbsp;<a href="chapter-3.html#ex:hamlift1">3.11</a>, its cotangent lift
</p>

<span class="hidden"> \(\seteqnumber{0}{}{175}\)</span>

<!--

                                                                                                                                                      
                                                                                                                                                                                                                          (3.176)
                                                                                                                                                    −1
                                                                                                Φt : T ∗ M → T ∗ M,       Φt (q, p) = φt (q), (φ∗t ) p .

-->

<p>


\begin{equation}
\Phi _t:T^*M\to T^*M, \quad \Phi _t(q,p) = \left (\phi _t(q), \left (\phi _t^*\right )^{-1}p\right ).
\end{equation}


</p>

<p>
Show that the hamiltonian generator of the canonical transformations \(\Phi _t\) depends linearly on the coordinates \(p_1, \ldots , p_n\) and is given by the following formula
</p>
<span class="hidden"> \(\seteqnumber{0}{}{176}\)</span>



<!--



                                                                                                H(q, p) = hp, X(q)i = pi X i (q),                          (3.177)                               --><a id="eq:linhamp"></a><!--
                                                                                                                                           d
                                                                                                X(q) = (X 1 (q), . . . , X n (q)),   X(q) = φt (q)     .                                                                  (3.178)
                                                                                                                                           dt      t=0




-->



<p>


\begin{align}
&amp; H(q,p) = \langle p, X(q) \rangle = p_i X^i(q), \label {eq:linhamp} \\ &amp; X(q) = (X^1(q), \ldots , X^n(q)), \quad X(q) = \frac {\dd }{\dd t} \phi _t(q)\Big |_{t=0}.
\end{align}


</p>

</li>

</ul>

</div>
<!--
...... subsection The hamiltonian Noether theorem ......
-->
<h5 id="autosec-223"><span class="sectionnumber">3.6.2&#x2003;</span>The hamiltonian Noether theorem</h5>
<a id="hm-autopage-223"></a>


<p>
With all these results at hand we are finally able to give a meaningful definition of hamiltonian symmetries. Note that, until now, in this chapter we have been discussing symmetries associated to the Poisson structure on the space \(C^\infty
(T^*M)\) of smooth real-valued functions on the cotangent bundle. We have not yet considered the symmetries of a specific hamiltonian function. To recover Noether we need to introduce precisely such concept.
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
Fix a hamiltonian system on \(T^*M\) with hamiltonian \(H\). A diffeomorphism \(\Phi :T^*M\to T^* M\) is a <em>symmetry</em> of the hamiltonian system if \(\Phi \) is a canonical transformation and<sup>7</sup> \(\Phi ^* H = H\).
</p>
</div>
<div role="note" class="footnotes">

<a id="hm-autopage-224"></a>
<p>
<sup>7</sup>&nbsp;This should be compared with a symmetry of a lagrangian \(L:TM \to \mathbb {R}\), i.e. a diffeomorphism \(\phi : M \to M\) such that \(\phi ^* L = L\). Note that even though the formula looks very similar, the
symmetry of the hamiltonian is defined on the whole phase space and not induced by a symmetry on the base as in the Lagrangian case. In the hamiltonian formalism, position and momentum are really on equal footings.
</p>


</div>

</div>

<p>
Theorem&nbsp;<a href="chapter-3.html#thm:canonicalmapping">3.14</a> then implies that symmetries map solutions of the hamiltonian system to other solutions.
</p>

<p>
We can finally state the hamiltonian counterpart of Noether theorem.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-225"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.17</span></span><span class="amsthmnoteplain"> (Hamiltonian Noether theorem)</span>. </span> Let \(H\) be a hamiltonian
on \(T^*M\) and \(F\) be a first integral of the hamiltonian system, then \(F\) generates a one–parameter group of symmetries of the hamiltonian system \(H\).
</p>

<p>
Vice versa, given a one–parameter group of symmetries of the hamiltonian system \(\Phi _t:T^*M\to T^* M\), then <em>locally</em> there exists a first integral \(F\) of \(H\) which generates the group.
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-226"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> The first part of the proof follows from Theorem&nbsp;<a href="chapter-3.html#thm:vf-infsym">3.16</a> and the following corollary of Theorem&nbsp;<a
href="chapter-3.html#thm:antihom">3.15</a>.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-227"></a>
<span class="amsthmnameplain">Corollary</span><span class="amsthmnumberplain"> <span class="textup">3.18</span></span><span class="amsthmnoteplain"> (of Theorem&nbsp;<a
href="chapter-3.html#thm:antihom">3.15</a>)</span>. </span> Let \(H, F \in \mathcal {C}^\infty (T^*M)\) be two hamiltonian functions in involution, i.e., \(\{H,F\}=0\). Then, their flows, respectively denoted here by \(\Phi _t^H\) and
\(\Phi _s^F\), commute:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{178}\)</span>

<!--



                                                                                                            ΦH    F    F    H
                                                                                                             t ◦ Φs = Φs ◦ Φt .                                                                                                         (3.179)

-->

<p>


\begin{equation}
\Phi _t^H \circ \Phi _s^F = \Phi _s^F \circ \Phi _t^H.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>

<p>
For the second part of the theorem, it is enough to observe that the hamiltonian generator of the group constructed in the second part of the proof of Theorem&nbsp;<a href="chapter-3.html#thm:vf-infsym">3.16</a> commutes with the
hamiltonian, i.e., it is a first integral. <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-228"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.12</span></span>. </span> Consider \((q,p) = (x,y,z,p_x,p_y,p_z)\in T^* \mathbb {R}^3\) and the infinitesimal
generator \(M_z = x p_y - y p_x\) (which you may recognize as the \(z\)-component of the angular momentum).
</p>

<p>
Parametrize the transformations with \(\theta \), as the parameter will turn out to correspond to an angle. Then the corresponding evolution in \(\theta \) is
</p>

<span class="hidden"> \(\seteqnumber{0}{}{179}\)</span>

<!--


                                                                                                   dq                               dp
                                                                                                                                                                                                                                                  (3.180)
                                                                                                                                       
                                                                                                      = q, Mz = (−y, x, 0),            = p, Mz = (−py , px , 0),
                                                                                                   dθ                               dθ

-->

<p>


\begin{equation}
\frac {\dd q}{\dd \theta } = \big \{q, M_z\big \} = (-y, x, 0),\qquad \frac {\dd p}{\dd \theta } = \big \{p, M_z\big \} = (-p_y, p_x, 0),
\end{equation}


</p>

<p>
which is readily solved by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{180}\)</span>

<!--

                                                                                                                                          
                                                                                                                                              cos θ   − sin θ
                                                                                                                                                                  
                                                                                                                                                                0
                                                                                                                                          sin θ       cos θ                                                                                      (3.181)
                                                                                                                                                                 
                                                                                                   q(θ) = Rq(0),    p(θ) = Rp(0),   R :=                       0.
                                                                                                                                               0        0       1

-->

<p>


\begin{equation}
q(\theta )= R q(0), \quad p(\theta ) = R p(0), \quad R := \begin{pmatrix} \cos \theta &amp; -\sin \theta &amp; 0 \\ \sin \theta &amp; \cos \theta &amp; 0 \\ 0 &amp; 0 &amp; 1 \end {pmatrix}.
\end{equation}


</p>

<p>
We see that the one parameter group of transformations \(\Phi _\theta (q,p) = (Rq, Rp)\) generated by \(M_z\) is the one of a clockwise rotation about the \(z\) axis.
</p>

<p>
In an analogous way, one can see that \(M_x = yp_z-zp_y\) and \(M_y = zp_x - xp_z\) generate rotations about the coordinate axes, respectively \(x\) and \(y\). We can use the Poisson bracket to show that any hamiltonian
</p>

<span class="hidden"> \(\seteqnumber{0}{}{181}\)</span>

<!--


                                                                                                                    1                     p                
                                                                                                                      p2x + p2y + p2z + V                                                                                                         (3.182)
                                                                                                                                     
                                                                                                       H(q, p) =                             x2 + y 2 + z 2
                                                                                                                   2m

-->

<p>


\begin{equation}
H(q,p) = \frac 1{2m}\left (p_x^2 + p_y^2 + p_z^2\right ) + V\left (\sqrt {x^2 + y^2 + z^2}\right )
\end{equation}


</p>

<p>
is in involution with the three components of the angular momentum. Indeed,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{182}\)</span>

<!--



                                                                                                                                                                                                                                                  (3.183)
                                                                                                                              
                                                                                                                 H, Mx = H, My = H, Mz = 0,

-->

<p>


\begin{equation}
\big \{H,M_x\big \} = \big \{H,M_y\big \} = \big \{H,M_z\big \} = 0,
\end{equation}


</p>

<p>
which at the same time is a way to represent the conservation of angular momentum
</p>

<span class="hidden"> \(\seteqnumber{0}{}{183}\)</span>

<!--



                                                                                                                       Ṁx = Ṁy = Ṁz = 0.                                                                                                       (3.184)

-->

<p>


\begin{equation}
\dot M_x = \dot M_y = \dot M_z = 0.
\end{equation}


</p>

<p>
Note that even though the three generators of the angular momentum components are independent, in the sense of being all in involution with the same hamiltonian, they do not mutually commute:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{184}\)</span>

<!--



                                                                                                                                                                       (3.185)                                          --><a id="eq:commM"></a><!--
                                                                                           
                                                    Mx , M y = Mz ,        My , M z = Mx ,       Mz , Mx = My .

-->

<p>


\begin{equation}
\label {eq:commM} \big \{M_x, M_y\big \} = M_z, \quad \big \{M_y, M_z\big \} = M_x, \quad \big \{M_z, M_x\big \} = M_y.
\end{equation}


</p>

<p>
In fact, the Poisson bracket relations above are the commutation relations of the basis of the Lie algebra of \(SO(3)\). Once we define action–angle coordinates, we will see that this non-commutativity implies that we cannot employ all the three
momenta simultaneously as configuration–space coordinates.
</p>

<p>
In quantum mechanics one can observe something similar: the three angular momentum components are linear self-adjoint operators generating a unitary representation of the group of rotations in Hilbert space. In that setting, however, their
non-commutation means that they cannot be simultaneously measured.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-229"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.9</span></span>. </span> Let \(X(q), Y(q)\) denote two vector fields on \(M\) and define two hamiltonians linear in
the momenta as in <span class="textup">(<a href="chapter-3.html#eq:linhamp">3.177</a>)</span>:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{185}\)</span>

<!--



                                                                                                  HX = hp, X(q)i,     HY = hp, Y (q)i.                                                                                        (3.186)

-->

<p>


\begin{equation}
H_X = \langle p, X(q)\rangle ,\quad H_Y = \langle p, Y(q) \rangle .
\end{equation}


</p>

<p>
Show that their Poisson bracket is also linear in the momenta and is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{186}\)</span>

<!--



                                                                                                                                                                                                                              (3.187)
                                                                                                       
                                                                                                           HX , HY   = −H[X,Y ] .

-->

<p>


\begin{equation}
\big \{H_X, H_Y\big \} = - H_{[X,Y]}.
\end{equation}


</p>

<p>
Where \([X,Y]\) is the Lie bracket of the vector fields.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-230"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.10</span></span>. </span> Given a mechanical system which is invariant with respect to space translations, show that
the components of the total momentum
</p>

<span class="hidden"> \(\seteqnumber{0}{}{187}\)</span>

<!--



                                                                                                                                                                                                                              (3.188)
                                                                                                                                 X
                                                                                                         P = (Px , Py , Pz ) =       pi
                                                                                                                                 i


-->

<p>


\begin{equation}
\vb * P = (P_x, P_y, P_z) = \sum _i \vb *{p}_i
\end{equation}


</p>

<p>
are mutually commuting:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{188}\)</span>

<!--



                                                                                                                                                                                                                              (3.189)
                                                                                                                      
                                                                                                     Px , Py = Py , Pz = Pz , Px = 0.

-->

<p>


\begin{equation}
\big \{P_x, P_y\big \} =\big \{P_y, P_z\big \} =\big \{P_z, P_x\big \} =0.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<!--
...... section The symplectic structure on the cotangent bundle ......
-->
<h4 id="autosec-231"><span class="sectionnumber">3.7&#x2003;</span>The symplectic structure on the cotangent bundle</h4>
<a id="hm-autopage-231"></a>


<p>
There is a beautiful geometric description that underlies everything that we have seen so far. This not only allows a coordinate free description of Hamiltonian mechanics, but provides the framework to develop many of our future discussions on
integrability and perturbation theory. For a deeper geometric investigation than what we can discuss in this course, you can refer to [<a href="chapter-6.html#LWR-ht-cite.0@book:dasilva">Sil08</a>].
</p>

<p>
In fact, we have already encountered the symplectic form in disguise twice. Recall equations <span class="textup">(<a href="chapter-3.html#eq:hamsysJ">3.90</a>)</span> and <span class="textup">(<a
href="chapter-3.html#eq:hamsysJ-1">3.172</a>)</span>. Especially in the latter case, we have been in front of a mapping that relates
</p>

<span class="hidden"> \(\seteqnumber{0}{}{189}\)</span>

<!--

                                                                                                                                                        
                                                                                                                    ∂H ∂H                       ∂H    ∂H
                                                                                                         dH =           ,          ↔ XH =           ,− i       ,                                                                                 (3.190)
                                                                                                                    ∂q i ∂pi                    ∂pi   ∂q

-->

<p>

\begin{equation}
\dd H = \left (\frac {\partial H}{\partial q^i}, \frac {\partial H}{\partial p_i}\right ) \leftrightarrow X_H = \left (\frac {\partial H}{\partial p_i}, - \frac {\partial H}{\partial q^i}\right ),
\end{equation}

</p>

<p>
that is, a mapping that associates a vector field \(X_H\) to a differential \(\dd H\) via the matrix \(J\).
</p>

<p>
Since \(J\) is antisymmetric, we can describe antisymmetric bilinear maps in terms of two-forms and we can generate one-forms out of two-forms with the contraction, it may be curious to see if we can actually use these concepts to connect the dots.
We look for an antisymmetric form, say \(\alpha \), on a cotangent bundle \(T^*M\) such that \(\iota _{X_H} \alpha \) can be related to \(\dd H\). Let’s compute it!
</p>

<p>
In terms of the basis elements \(dq^i\wedge dq^j\), \(dp_i\wedge dp_j\), \(dp_i\wedge dq^j\), we have
</p>
<span class="hidden"> \(\seteqnumber{0}{}{190}\)</span>


<!--



                                                                                                          ιXH α = αij (dq i (XH )dq j − dq j (XH )dq i )                                                                                         (3.191)
                                                                                                                        ij
                                                                                                                    + α (dpi (XH )dpj − dpj (XH )dpi )                                                                                           (3.192)
                                                                                                                   + αji (dpi (XH )dq j − dq j (XH )dpi )                                                                                        (3.193)
                                                                                                                                            
                                                                                                                          ∂H j ∂H i
                                                                                                                 = αij         dq −      dq                                                                                                      (3.194)
                                                                                                                          ∂pi        ∂pj
                                                                                                                                                
                                                                                                                               ∂H         ∂H
                                                                                                                   + αij − i dpj + j dpi                                                                                                         (3.195)
                                                                                                                               ∂q         ∂q
                                                                                                                                                
                                                                                                                              ∂H         ∂H
                                                                                                                   + αji − i dq j −          dpi ,                                                                                               (3.196)
                                                                                                                              ∂q         ∂pj


-->


<p>

\begin{align}
\iota _{X_H} \alpha &amp;= \alpha _{ij} (\dd q^i(X_H) \dd q^j - \dd q^j(X_H) \dd q^i) \\ &amp;\quad + \alpha ^{ij} (dp_i(X_H) \dd p_j - dp_j(X_H) \dd p_i) \\ &amp;\quad + \alpha ^i_j( dp_i(X_H) \dd q^j - dq^j(X_H)
\dd p_i) \\ &amp;= \alpha _{ij}\left (\frac {\partial H}{\partial p_i} \dd q^j - \frac {\partial H}{\partial p_j}\dd q^i\right ) \\ &amp;\quad + \alpha ^{ij}\left (-\frac {\partial H}{\partial q^i} \dd p_j + \frac
{\partial H}{\partial q^j} \dd p_i\right ) \\ &amp;\quad + \alpha ^i_j\left (-\frac {\partial H}{\partial q^i} \dd q^j - \frac {\partial H}{\partial p_j} \dd p_i\right ),
\end{align}
where the sum was over all indices \(i\leq j\). This should be equal to
</p>

<span class="hidden"> \(\seteqnumber{0}{}{196}\)</span>

<!--

                                                                                                                               ∂H i ∂H
                                                                                                                     dH =           dq +     dpi .                                                                                               (3.197)
                                                                                                                               ∂q i      ∂pi

-->

<p>

\begin{equation}
dH = \frac {\partial H}{\partial q^i} \dd q^i + \frac {\partial H}{\partial p_i} \dd p_i.
\end{equation}

</p>

<p>
That is, \(\alpha ^{ij}=\alpha _{ij} = 0\) and \(\alpha ^i_j = -\delta ^i_j\). Rewriting everything explicitly, we have computed
</p>

<span class="hidden"> \(\seteqnumber{0}{}{197}\)</span>

<!--


                                                                                                                     ιXH (dpi ∧ dq i ) = −dH.                                                                                                    (3.198)

-->

<p>

\begin{equation}
\iota _{X_H}(\dd p_i\wedge \dd q^i) = - \dd H.
\end{equation}

</p>

<p>
As it turns out, \(\dd p_i \wedge \dd q^i\) is a symplectic form, and the equation above is an alternative definition for the hamiltonian vector field (see Exercise&nbsp;<a href="chapter-3.html#exe:altdefomega">3.12</a>).
</p>

<p>
Without further ado, let’s dig into it. Instead of working on the cotangent bundle \(T^*M\) over a smooth manifold \(M\), we will consider at first a generic smooth manifold \(P\).
</p>

<p>
Let \(\omega \) be a two–form on \(P\), that is, for each \(x\in P\), the map \(\omega _x: T_x P \times T_x P \to \mathbb {R}\) is a skew-symmetric bilinear map on the tangent space to \(P\) at \(x\). As we mentioned, in terms of
coordinates and linear algebra, bilinear means that it corresponds to some \(\dim P\times \dim P\) matrix \(\Omega (x) = \left (\omega _{ij}(x)\right )_{1\leq i,j\leq \dim P}\) and skew-symmetric means that the matrix \(\Omega
(x)\) is antisymmetric. I.e. \(\omega \), seen as a matrix, acts on vectors \(X,Y\) as \(X^T \Omega Y\).
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
We say that a two–form \(\omega \) on \(P\) defines a <em>symplectic structure</em> on \(P\) if it is closed<sup>8</sup> and non–degenerate<sup>9</sup>. We call <em>symplectic manifold</em> the pair \((P, \omega )\) of a smooth manifold
\(P\) with a symplectic structure \(\omega \) on \(P\).
</p>
</div>
<div role="note" class="footnotes">

<a id="hm-autopage-232"></a>
<p>
<sup>8</sup>&nbsp;I.e. \(\dd \omega = 0\)
</p>

<p>
<sup>9</sup>&nbsp;I.e. \(\omega \neq 0\). Note that this means \(\omega _x \neq 0\) for all \(x \in P\).
</p>


</div>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-233"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">3.6</span></span>. </span> The fact that \(\omega \) is closed and non-degenerate, in coordinates, can be translated into
</p>

<span class="hidden"> \(\seteqnumber{0}{}{198}\)</span>

<!--



                                                                                                       det(Ω(x)) 6= 0   ∀x ∈ P.                                                                                              (3.199)

-->

<p>


\begin{equation}
\det (\Omega (x)) \neq 0 \quad \forall x\in P.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-234"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">3.7</span></span>. </span> Note that for an \(n\times n\) antisymmetric matrix \(A = - A^T\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{199}\)</span>

<!--

                                                                                                               
                                                                                                 det A = det −AT = (−1)n det AT = (−1)n det A,                                                                                               (3.200)

-->

<p>


\begin{equation}
\det A = \det (-A^T) = (-1)^n \det A^T = (-1)^n \det A,
\end{equation}


</p>

<p>
therefore non–degeneracy implies that \(\dim P\) must be even.
</p>

</li>

</ul>

</div>

<p>
If we go back to our example of an \(n\)-dimensional manifold \(M\), we can construct a symplectic structure on its cotangent bundle \(T^*M = P\) using the coordinates \(q,p\) associated to the local coordinates \(q^1, \ldots , q^n\) on \(M\).
Then, the symplectic form is defined by the following formula
</p>

<span class="hidden"> \(\seteqnumber{0}{}{200}\)</span>

<!--


                                                                      ω = dpi ∧ dq i ,                                                                    (3.201)                                         --><a id="eq:canonical2form"></a><!--

-->

<p>

\begin{equation}
\label {eq:canonical2form} \omega = \dd p_i \wedge \dd q^i,
\end{equation}

</p>

<p>
where as usual we are summing the repeated indices.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-235"></a>
<span class="amsthmnameplain">Lemma</span><span class="amsthmnumberplain"> <span class="textup">3.19</span></span>. </span> The matrix of the two–form \(\omega \) defined by <span class="textup">(<a
href="chapter-3.html#eq:canonical2form">3.201</a>)</span> in the coordinates \(q,p\) is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{201}\)</span>

<!--


                                                                              − Idn
                                                                                      !
                                                                         0
                                                           Ω(x) = Ω =                     .                                               (3.202)                                     --><a id="eq:symmatpqcoords"></a><!--
                                                                        Idn     0

-->

<p>


\begin{equation}
\label {eq:symmatpqcoords} \Omega (x) = \Omega = \begin{pmatrix} 0 &amp; -\Id _n \\ \Id _n &amp; 0 \end {pmatrix}.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-236"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> Denote the basis vectors of \(T_x P\) with
</p>

<span class="hidden"> \(\seteqnumber{0}{}{202}\)</span>

<!--

                                                                                                                                                                
                                                                                                                         ∂         ∂  ∂         ∂
                                                                                                                             ,..., n,    ,...,                        .                                          (3.203)
                                                                                                                        ∂q 1      ∂q ∂p1       ∂pn

-->

<p>


\begin{equation}
\left ( \frac {\partial }{\partial q^1}, \ldots , \frac {\partial }{\partial q^n}, \frac {\partial }{\partial p_1}, \ldots , \frac {\partial }{\partial p_n} \right ).
\end{equation}


</p>

<p>
The expression of <span class="textup">(<a href="chapter-3.html#eq:symmatpqcoords">3.202</a>)</span> follows by using the expressions of the action of the differentials on the basis vectors,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{203}\)</span>

<!--

                                                                                                                                                                                  
                                                                                                      ∂                      ∂                              ∂                      ∂
                                                                                          dq i                  = dpi                 = δji ,   dq i                 = dpi                   = 0,                (3.204)
                                                                                                     ∂q j                   ∂pj                            ∂pj                    ∂q j

-->

<p>


\begin{equation}
\dd q^i\left (\frac {\partial }{\partial q^j}\right ) = \dd p_i\left (\frac {\partial }{\partial p_j}\right ) =\delta ^i_j, \qquad \dd q^i\left (\frac {\partial }{\partial p_j}\right ) = \dd p_i\left (\frac
{\partial }{\partial q^j}\right ) = 0,
\end{equation}


</p>

<p>
together with the definition of the action of a wedge product of two 1-forms \(\alpha , \beta \) on two tangent vectors \(X, Y\)
</p>

<span class="hidden"> \(\seteqnumber{0}{}{204}\)</span>

<!--

                                                                                                                                                                     !
                                                                                                                                                α(X)        α(Y )
                                                                                                                  α ∧ β(X, Y ) = det                                      .                                      (3.205)
                                                                                                                                                β(X)        β(Y )

-->

<p>


\begin{equation}
\alpha \wedge \beta (X, Y) = \det \begin{pmatrix} \alpha (X) &amp; \alpha (Y) \\ \beta (X) &amp; \beta (Y) \end {pmatrix}.
\end{equation}


</p>

<p>
<span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
Note that \(\Omega \) is the inverse to the matrix \(J = (J^{ij})\) introduced in <span class="textup">(<a href="chapter-3.html#eq:symmat">3.87</a>)</span>.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-237"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.20</span></span>. </span> <a id="thm:propc2f"></a> The two–form \(\omega \) defined by <span class="textup">(<a
href="chapter-3.html#eq:canonical2form">3.201</a>)</span> does not depend from the local choice of coordinates \(q^1, \ldots , q^n\) on the base \(M\) of the cotangent bundle \(T^* M\). This two–form is closed and non–degenerate,
therefore defining a symplectic structure on the manifold \(T^*M\).
</p>

</li>

</ul>

</div>

<p>
The proof is not hard, but it is more convenient if we first prove the following lemma.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-238"></a>
<span class="amsthmnameplain">Lemma</span><span class="amsthmnumberplain"> <span class="textup">3.21</span></span>. </span> Let \(q^1, \ldots , q^n\) be a choice of local coordinates on a smooth manifold \(M\). Then the
<em>tautological one–form</em>
</p>

<span class="hidden"> \(\seteqnumber{0}{}{205}\)</span>

<!--



                                                                                                                    η = pi dq i                                                                                           (3.206)

-->

<p>


\begin{equation}
\eta = p_i \dd q^i
\end{equation}


</p>

<p>
is a one–form on \(T^* M\) which does not depend on the choice of local coordinates. Moreover, the differential of such one–form coincides with the two–form <span class="textup">(<a
href="chapter-3.html#eq:canonical2form">3.201</a>)</span>:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{206}\)</span>

<!--



                                                                                                                     dη = ω.                                                                                              (3.207)

-->

<p>


\begin{equation}
\dd \eta = \omega .
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-239"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> The formula \(\dd \eta = \omega \) is immediate. It only remains to show the invariance of \(\omega \) with respect to coordinate transformations on \(M\):
</p>

<span class="hidden"> \(\seteqnumber{0}{}{207}\)</span>

<!--


                                                                                                                                          ∂q k
                                                                                                   q i 7→ qei = qei (q),    pi 7→ pei =         pk .                                                                              (3.208)
                                                                                                                                          ∂ qei

-->

<p>


\begin{equation}
q^i \mapsto \widetilde q^i = \widetilde q^i(q), \qquad p_i \mapsto \widetilde p_i = \frac {\partial q^k}{\partial \widetilde q^i} p_k.
\end{equation}


</p>

<p>
Using the definition, we have
</p>

<span class="hidden"> \(\seteqnumber{0}{}{208}\)</span>

<!--


                                                                                                            ∂q k ∂ qei l
                                                                                                pei de
                                                                                                     qi =        pk    dq = δlk pk dq l = pk dq k .                                                                               (3.209)
                                                                                                            ∂ qei ∂q l

-->

<p>


\begin{equation}
\widetilde {p}_i \dd {\widetilde {q}^i} = \frac {\partial q^k}{\partial \widetilde {q}^i} p_k \frac {\partial \widetilde {q}^i}{\partial q^l} \dd {q^l} = \delta ^k_l p_k \dd {q^l} = p_k \dd {q^k}.
\end{equation}


</p>

<p>
<span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-240"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof of Theorem <a href="chapter-3.html#thm:propc2f">3.20</a>.</span></span> Any differential form with constant coefficients is closed. The matrix <span
class="textup">(<a href="chapter-3.html#eq:symmatpqcoords">3.202</a>)</span> is non–degenerate. The invariance of \(\omega \) follows immediately from the invariance of \(\eta \). <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
The tautological one–form, also called canonical one–form, Liouville one–form, the Poincaré one–form and possibly in many other ways, provides a natural way to endow \(T^*M\) with a symplectic structure.
</p>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-241"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">3.8</span></span><span class="amsthmnotedefinition"> (A coordinate free explanation of the tautological
one–form)</span>. </span> The name tautological comes from the physical intuition that velocity and momenta are necessarily proportional to one-another, but the connection between the two concepts runs deep as previous remarks have shown.
The tautological one-form enter into this picture as a foundational concept.
</p>

<p>
If you open the relative wikipedia page at the time of writing these lecture notes, you will read some variation of the following text.
</p>
<blockquote>

<p>
The tautological one-form is a device that converts velocities into momenta. That is, it assigns a numerical value to the momentum \(p\) for each velocity \(\dot {q}\)” Moreover, it does it so that they point “in the same direction” and it does it
linearly, such that the magnitudes grow in proportion. Finally, the choice of the assignment is unique: each momentum vector corresponds to only one velocity vector, by definition. In this respect, the tautological one–form can be thought of as a
device to convert from Lagrangian mechanics to Hamiltonian mechanics.
</p>
</blockquote>

<p>
In what follows, we will try to understand what the aforementioned quote really means.
</p>

<p>
Let \(P = T^* M\) be the cotangent bundle over the smooth manifold \(M\). The simplest map from the cotangent bundle to the base manifold is the canonical bundle projection
</p>

<span class="hidden"> \(\seteqnumber{0}{}{209}\)</span>

<!--



                                                                                                                π : P → M,    π(q, p) = q.                                                                                                        (3.210)

-->

<p>


\begin{equation}
\pi :P\to M,\quad \pi (q,p) = q.
\end{equation}


</p>

<p>
Its differential defines a map
</p>

<span class="hidden"> \(\seteqnumber{0}{}{210}\)</span>

<!--



                                                                                                                     π∗ : T P → T M                                                                                                               (3.211)

-->

<p>


\begin{equation}
\pi _* : TP \to TM
\end{equation}


</p>

<p>
between tangent bundles. We have seen this multiple times, so nothing new for now.
</p>

<p>
Let \(x\) be a point on \(P\). Since \(P = T^*M\) is the cotangent bundle over \(M\), we can think of points \(x = (q,p)\) as linear maps
</p>

<span class="hidden"> \(\seteqnumber{0}{}{211}\)</span>

<!--



                                                                                                                      x : Tq M → R                                                                                                                (3.212)

-->

<p>


\begin{equation}
x : T_q M \to \mathbb {R}
\end{equation}


</p>

<p>
of the tangent space of \(M\) at \(q := \pi (x)\). That is, \(x\) is in the fiber \(T^*_qM\) of \(q\).
</p>

<p>
Since \(\pi _*(x): T_x P \to T_q M\), we could compose it with \(x\) to get a linear map over \(TP\). Indeed,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{212}\)</span>

<!--



                                                                                                                    η(x) = x ◦ π∗ (x),                                                                                                            (3.213)

-->

<p>


\begin{equation}
\eta (x) = x \circ \pi _*(x),
\end{equation}


</p>

<p>
defines a linear map
</p>

<span class="hidden"> \(\seteqnumber{0}{}{213}\)</span>

<!--



                                                                                                                    η(x) : Tx P → R.                                                                                                              (3.214)

-->

<p>


\begin{equation}
\eta (x):T_xP\to \mathbb {R}.
\end{equation}


</p>

<p>
Recalling that \(T_x^*P = \big \{\phi : T_x P \to \mathbb {R} \mid \phi \mbox { linear}\big \}\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{214}\)</span>

<!--



                                                                                                                    η(x) : P → Tx∗ P.                                                                                                             (3.215)

-->

<p>


\begin{equation}
\eta (x) : P \to T^*_x P.
\end{equation}


</p>

<p>
The map \(\eta \) we just defined is the tautological one–form.
</p>

</li>

</ul>

</div>

<p>
With these new concepts at hand, we have defined two natural geometric structures on \(T^* M\): the Poisson bracket and the symplectic structure. In coordinates, these two structures arise from two antisymmetric tensors: the \((2,0)\)-tensor
\(J^{ij}\) from the Poisson bracket (a bilinear form on the cotangent space) and the \((0,2)\)-tensor \(\omega _{ij}\) of the symplectic form (a bilinear form on the tangent space). You may have observed by now that these two tensors are
strictly related: their associated matrices are inverse of each other:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{215}\)</span>

<!--


                                                                  ωil J lj = δij ,   i, j = 1, . . . , 2n.                                                    (3.216)                                          --><a id="eq:omegaJinverse"></a><!--

-->

<p>

\begin{equation}
\label {eq:omegaJinverse} \omega _{il}J^{lj} = \delta _i^j, \quad i,j = 1,\ldots , 2n.
\end{equation}

</p>

<p>
In canonical coordinates \(q,p\), these matrices take respectively the constant form of <span class="textup">(<a href="chapter-3.html#eq:symmat">3.87</a>)</span> and <span class="textup">(<a
href="chapter-3.html#eq:symmatpqcoords">3.202</a>)</span>.
</p>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-243"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.11</span></span>. </span> Show that \(\big \{f,g\big \} = -\mathcal {L}_{X_f} g = \mathcal {L}_{X_g} f\),
where \(\mathcal {L}\) is the Lie derivative defined in <span class="textup">(<a href="chapter-3.html#eq:lie-derivative">3.19</a>)</span>. Remember that the inner product of a vector field with a function is zero by definition.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-244"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.12</span></span>. </span> <a id="exe:altdefomega"></a> Let \(X_H\) be an hamiltonian vector field on \(T^*M\).
Show that the following holds
</p>

<span class="hidden"> \(\seteqnumber{0}{}{216}\)</span>

<!--



                                                                           ιXH ω = −dH.                                                                             (3.217)                                          --><a id="eq:symXHdef"></a><!--

-->

<p>


\begin{equation}
\label {eq:symXHdef} \iota _{X_H}\omega = -\dd H.
\end{equation}


</p>

<p>
You can do it in one line with Cartan’s magic formula <span class="textup">(<a href="chapter-3.html#eq:cartan">3.20</a>)</span>.
</p>

<p>
In symplectic geometry courses, equation <span class="textup">(<a href="chapter-3.html#eq:symXHdef">3.217</a>)</span> is usually given as the definition of a hamiltonian vector field. Indeed, show that if \(\iota _{X}\omega = -\dd H\),
then \(X=X_H\) and
</p>

<span class="hidden"> \(\seteqnumber{0}{}{217}\)</span>

<!--



                                                                                                               {f, g} = Xg f = ω(Xg , Xf ).                                                                                                       (3.218)

-->

<p>


\begin{equation}
\{f,g\} = X_g f = \omega (X_g, X_f).
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>

<p>
In the rest of this section we will construct a mapping between the notions that we introduced in the previous chapters with the Poisson bracket and the new language of symplectic manifolds. As we will see ,this will allow us to discover a range of
new interesting properties.
</p>
<!--
...... subsection Symplectomorphisms and generating functions ......
-->
<h5 id="autosec-245"><span class="sectionnumber">3.7.1&#x2003;</span>Symplectomorphisms and generating functions</h5>
<a id="hm-autopage-245"></a>


<p>
We start by looking back at the canonical transformations.
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
Let \(\Phi : P \to P\) be a diffeomorphism on a symplectic manifold \((P,\omega )\). We say that \(\Phi \) is a <em>symplectic transformation</em>, or <em>symplectomorphism</em>, if it leaves the symplectic form \(\omega \) invariant:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{218}\)</span>

<!--


                                                                     Φ∗ ω = ω.                                                                     (3.219)                                        --><a id="eq:symplectomorphism"></a><!--

-->

<p>

\begin{equation}
\label {eq:symplectomorphism} \Phi ^* \omega = \omega .
\end{equation}

</p>

</div>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-246"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.22</span></span>. </span> <a id="thm:ctiffs"></a> Let \(\Phi : T^*M \to T^*M\) be a diffeomorphism, then \(\Phi \) is a
canonical transformation if and only if it is a symplectomorphism.
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-247"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> With our usual notation, let
</p>

<span class="hidden"> \(\seteqnumber{0}{}{219}\)</span>

<!--



                                                                                                                 y k = Φk (x),          k = 1, . . . , 2n.                                                                                       (3.220)

-->

<p>


\begin{equation}
y^k = \Phi ^k(x),\quad k=1,\ldots ,2n.
\end{equation}


</p>

<p>
Then the definition of canonical transformation in the local coordinates \(x\), see <span class="textup">(<a href="chapter-3.html#eq:cantrafocoord">3.131</a>)</span>, becomes
</p>

<span class="hidden"> \(\seteqnumber{0}{}{220}\)</span>

<!--


                                                                                                                 ∂y k ∂y l
                                                                                                          J ij             = J kl ,        k, l = 1, . . . , 2n.                                                                                 (3.221)
                                                                                                                 ∂xi ∂xj

-->

<p>


\begin{equation}
J^{ij}\frac {\partial y^k}{\partial x^i}\frac {\partial y^l}{\partial x^j} = J^{kl}, \quad k,l = 1,\ldots ,2n.
\end{equation}


</p>

<p>
Inverting the Jacobian in the formula above and using <span class="textup">(<a href="chapter-3.html#eq:omegaJinverse">3.216</a>)</span>, we get
</p>

<span class="hidden"> \(\seteqnumber{0}{}{221}\)</span>

<!--


                                                                                                          ∂xi ∂xj
                                                                                                                    ωij = ωkl ,            k, l = 1, . . . , 2n.                                                                                 (3.222)
                                                                                                          ∂y k ∂y l

-->

<p>


\begin{equation}
\frac {\partial x^i}{\partial y^k}\frac {\partial x^j}{\partial y^l} \omega _{ij}= \omega _{kl}, \quad k,l = 1,\ldots ,2n.
\end{equation}


</p>

<p>
Consider now the inverse transformation
</p>

<span class="hidden"> \(\seteqnumber{0}{}{222}\)</span>

<!--



                                                                                                                                                                                                                                                 (3.223)
                                                                                                                            k
                                                                                                            xk = Φ−1             (y),      k = 1, . . . , 2n.

-->

<p>


\begin{equation}
x^k = \left (\Phi ^{-1}\right )^k(y),\quad k=1,\ldots ,2n.
\end{equation}


</p>

<p>
By the equations above, we have
</p>
<span class="hidden"> \(\seteqnumber{0}{}{223}\)</span>



<!--



                                                                                                                                              1
                                                                                                                       ωkl dxk ∧ dxl =          ωkl dxk ∧ dxl                                                                                    (3.224)
                                                                                                                 X
                                                                                                         ω=
                                                                                                                                              2
                                                                                                                 k<l

                                                                                                            1    ∂xk ∂xl i
                                                                                                           =  ωkl i        dy ∧ dy j                                                                                                             (3.225)
                                                                                                            2    ∂y ∂y j
                                                                                                            1
                                                                                                           = ωij dy i ∧ dy j                                                                                                                     (3.226)
                                                                                                            2



-->



<p>


\begin{align}
\omega &amp; = \sum _{k&lt;l} \omega _{kl}\dd x^k \wedge \dd x^l = \frac 12 \omega _{kl} \dd x^k \wedge \dd x^l \\ &amp; = \frac 12 \omega _{kl} \frac {\partial x^k}{\partial y^i}\frac {\partial x^l}{\partial y^j}
\dd y^i \wedge \dd y^j \\ &amp; = \frac 12 \omega _{ij} \dd y^i \wedge \dd y^j
\end{align}
In other words,
</p>

<span class="hidden"> \(\seteqnumber{0}{}{226}\)</span>

<!--


                                                                                                                                  ∗
                                                                                                                           Φ−1          ω = ω,                                                                                                   (3.227)

-->

<p>


\begin{equation}
\left (\Phi ^{-1}\right )^* \omega = \omega ,
\end{equation}


</p>

<p>
and by applying \(\Phi ^*\) we immediately get the invariance of \(\omega \) with respect to \(\Phi \). Repeating the computations from bottom to top, one proves the second part of the theorem. <span
class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
If you have looked carefully, you may have noticed that the proof above carefully avoids any use of the structure of cotangent bundle. It is then worth asking ourselves what happens if we consider the tautological one–form \(\eta \) instead of
\(\omega \).
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-248"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.23</span></span>. </span> <a id="thm:genfun"></a> Let \(\Phi : T^*M \to T^*M\) be a symplectomorphism, then locally there
exists a function \(S:T^*M\to \mathbb {R}\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{227}\)</span>

<!--



                                                                    Φ∗ η − η = dS.                                                                    (3.228)                                  --><a id="eq:Sfungen"></a><!--

-->

<p>


\begin{equation}
\label {eq:Sfungen} \Phi ^*\eta - \eta = \dd S.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-249"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> The definition of symplectomorphism, the identity \(\dd \eta = \omega \) and the commutativity of the pullback and the exterior differential imply
</p>

<span class="hidden"> \(\seteqnumber{0}{}{228}\)</span>

<!--



                                                                                                       0 = Φ∗ ω − ω = Φ∗ (dη) − dη = d(Φ∗ η − η) ,                                                                                                 (3.229)

-->

<p>


\begin{equation}
0 = \Phi ^*\omega - \omega = \Phi ^*(\dd \eta ) - \dd \eta = \dd (\Phi ^*\eta - \eta ),
\end{equation}


</p>

<p>
which means that \(\Phi ^*\eta - \eta \) is a closed one–form. Poincaré lemma, then, implies local existence of the function \(S\). <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
The function \(S\) appearing in <span class="textup">(<a href="chapter-3.html#eq:Sfungen">3.228</a>)</span> is called <em>generating function</em> of the symplectic transformation. The name stems from the fact that we can effectively use
\(S\) to construct canonical transformations and effectively compute the corresponding transformed positions or momentums. Put slightly differently, equation <span class="textup">(<a href="chapter-3.html#eq:Sfungen">3.228</a>)</span> is
telling us that canonical transformations can be identified with a generating function. We will leave it as a vague remark for the time being but we will come back to it, and study its consequences, in more details once we start discussing integrable
systems. For now, lets keep drawing parallels between the Poisson bracket and the symplectic formalism.
</p>

<p>
We have shown in Theorem&nbsp;<a href="chapter-3.html#thm:vf-infsym">3.16</a> that the hamiltonian flow is an infinitesimal symmetry of the Poisson bracket, which in particular means that it defines a one–parameter group of canonical
transformations. The following result comes, thus, as an immediate consequence of Theorem <a href="chapter-3.html#thm:ctiffs">3.22</a>.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-250"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.24</span></span>. </span> Let \(H\) be a function on the manifold \(T^*M\), then the hamiltonian flow \(\Phi _t\) generated by
\(H\) is a one–parameter group of symplectomorphisms of \((T^*M, \omega )\).
</p>

</li>

</ul>

</div>

<p>
We can now see the implications of the converse part of Theorem&nbsp;<a href="chapter-3.html#thm:vf-infsym">3.16</a>.
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
Let \(X\) be a vector field on a symplectic manifold \((P,\omega )\). We say that \(X\) is a <em>infinitesimal symplectomorphism</em> if the Lie derivative of the symplectic form \(\omega \) with respect to \(X\) is zero:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{229}\)</span>

<!--


                                                                              LX ω = 0.                                                                             (3.230)                                      --><a id="eq:infsymplcf"></a><!--

-->

<p>

\begin{equation}
\label {eq:infsymplcf} \mathcal {L}_X \omega = 0.
\end{equation}

</p>

</div>

</div>

<p>
The reason of name of the transformation may become clearer if we observe that <span class="textup">(<a href="chapter-3.html#eq:infsymplcf">3.230</a>)</span> means that, if \(\Phi _t\) is the flow of \(X\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{230}\)</span>

<!--

                                                                                                                         Φ∗t ω − ω
                                                                                                                     lim           = 0.                                                                                                     (3.231)
                                                                                                                     t→0      t

-->

<p>

\begin{equation}
\lim _{t\to 0} \frac {\Phi _t^*\omega - \omega }{t} = 0.
\end{equation}

</p>

<p>
That is, \(\Phi _t^*\omega = \omega \) along the flow of \(X\).
</p>

<p>
Checking that hamiltonian vector fields satisfy this property is a matter of applying Cartan’s magic formula once:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{231}\)</span>

<!--


                                                                                                      LXH ω = d(ιXH ω) + ιXH (dω) = d(−dH) = 0.                                                                                             (3.232)

-->

<p>

\begin{equation}
\mathcal {L}_{X_H} \omega = \dd (\iota _{X_H} \omega ) + \iota _{X_H}(\dd \omega ) = \dd (-\dd H) = 0.
\end{equation}

</p>

<p>
Where we used the fact that \(\omega \) is closed and Exercise&nbsp;<a href="chapter-3.html#exe:altdefomega">3.12</a>.
</p>

<p>
With this new baggage at hand, we can compare again Theorem&nbsp;<a href="chapter-3.html#thm:vf-infsym">3.16</a> and Theorem <a href="chapter-3.html#thm:ctiffs">3.22</a> to extend the previous result with the following theorem.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-251"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.25</span></span>. </span> Let \(X\) be an infinitesimal symplectomorphism on the symplectic manifold \((P,\omega )\), then
locally there exists a function \(H\) such that \(X = X_H\).
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-252"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">3.13</span></span><span class="amsthmnotedefinition"> (Time dependent hamiltonians)</span>. </span> <a
id="ex:timedepH"></a> It is possible to use the symplectic formulation to describe hamiltonian systems with an explicit time dependence. To this end, one needs to consider the extended phase space \(T^*M\times \mathbb {R}^2\), as we have
already seen in Section&nbsp;<a href="chapter-3.html#sec:timedepH">3.4.2</a>.
</p>

<p>
In the extended coordinates \((q^1, \ldots , q^n, p_1,\ldots ,p_n,t,E)\), the tautological one–form is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{232}\)</span>

<!--



                                                                                                                η = pi dq i − Edt,                                                                                                        (3.233)

-->

<p>


\begin{equation}
\eta = p_i\dd q^i -E\dd t,
\end{equation}


</p>

<p>
which leads to the symplectic form
</p>

<span class="hidden"> \(\seteqnumber{0}{}{233}\)</span>

<!--



                                                                                                          ω = dη = dpi ∧ dq i − dE ∧ dt.                                                                                                  (3.234)

-->

<p>


\begin{equation}
\omega = \dd \eta = \dd p_i \wedge \dd q^i -\dd E \wedge \dd t.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<!--
...... subsection Darboux Theorem ......
-->
<h5 id="autosec-253"><span class="sectionnumber">3.7.2&#x2003;</span>Darboux Theorem</h5>
<a id="hm-autopage-253"></a>


<p>
There seems to be more to symplectic manifolds that just cotangent bundles. However, as manifolds locally look like euclidean spaces, the following theorem tells us that symplectic manifolds locally look like cotangent bundles.
</p>

<p>
Here we will present a very hands-on proof, on the line of [<a href="chapter-6.html#LWR-ht-cite.0@book:lee">J.M13</a>, Problem 22-19]. For a more elegant approach, due to Moser and Weinstein, refer to [<a
href="chapter-6.html#LWR-ht-cite.0@book:lee">J.M13</a>, Chapter 22] or [<a href="chapter-6.html#LWR-ht-cite.0@book:knauf">Kna18</a>, Chapter 10.3].
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-254"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.26</span></span><span class="amsthmnoteplain"> (Darboux’ Theorem)</span>. </span> Let \((P, \omega )\) be a symplectic
manifold and \(\dim P = 2n\). Then, there exist local coordinates
</p>

<span class="hidden"> \(\seteqnumber{0}{}{234}\)</span>

<!--



                                                                                                   (q 1 , . . . , q n , p1 , . . . , pn )                                                                           (3.235)

-->

<p>


\begin{equation}
(q^1, \ldots , q^n, p_1, \ldots , p_n)
\end{equation}


</p>

<p>
around any point in \(P\) such that \(\omega = \dd p_i \wedge \dd q^i\).
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-255"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> The proof is a sort of Gram-Schmidt process. Let \(x\) be a local system of coordinates in a neighborhood \(U_{x_0}\) of a point \(x_0\in P\) and let \(\omega
= \omega _{ij}(x)\dd x^i\wedge \dd x^j\). We would like to find a change of variable that transforms \(\omega \) into \(\dd p_i \wedge \dd q^i\).
</p>

<p>
Let \(p_1=p_1(x)\) be a smooth function of \(x\) in a neighborhood of \(x_0\) such that \(p_1(x_0) = 0\). Define the nonzero vector field \(X_{p_1}\) with \(\iota _{X_{p_1}}\omega = -\dd p_1\). Then, by the rectification theorem, around
\(x_0\) we can find a system of coordinates \((q^1, y^0, y^1, \ldots , y^{n-2})\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{235}\)</span>

<!--


                                                                                                                             ∂
                                                                                                                    Xp1 =        ,                                                                                                            (3.236)
                                                                                                                            ∂q 1

-->

<p>


\begin{equation}
X_{p_1} = \frac {\partial }{\partial q^1},
\end{equation}


</p>

<p>
i.e., \(X_{p_1}\) generates translations in the coordinate \(q^1\). Being \(X_{p_1} p_1 = 0\), the function \(p_1\) cannot depend on \(q^1\) in these new local coordinates, thus we can instead choose the local system of coordinates \((q^1, p_1,
y^1, \ldots , y^{n-2})\). Furthermore, \(X_{p_1} q^1 = 1\) implies that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{236}\)</span>

<!--



                                                                                                                                                                                                                                              (3.237)
                                                                                                                     1
                                                                                                                     q , p1 = 1.

-->

<p>


\begin{equation}
\big \{q^1, p_1\big \} = 1.
\end{equation}


</p>

<p>
If \(n=1\) we are done, and the coordinates are simply \((q^1, p_1)\).
</p>

<p>
If \(n&gt;1\) we need to proceed by induction. Assume that Darboux’ theorem holds for \(\mathbb {R}^{2n-2}\) and consider the set \(S\) obtained by the intersection of the two hyperplanes
</p>

<span class="hidden"> \(\seteqnumber{0}{}{237}\)</span>

<!--



                                                                                                            p1 (x) = 0 and     q 1 (x) = 0.                                                                                                   (3.238)

-->

<p>


\begin{equation}
p_1(x) = 0 \quad \mbox {and}\quad q^1(x) = 0.
\end{equation}


</p>

<p>
As \(\omega (X_{p_1}, X_{q^1}) = \big \{q^1, p_1\big \} = 1\), the two hamiltonian vector fields \(X_{p_1}\) and \(X_{q^1}\) must be linearly independent in a neighborhood of \(x_0\). It follows that \(S\) is a manifold of dimension
\(2n-2\) in that neighborhood.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-256"></a>
<span class="amsthmnameplain">Lemma</span><span class="amsthmnumberplain"> <span class="textup">3.27</span></span>. </span> The symplectic structure \(\omega \) in \(\mathbb {R}^{2n}\) induces a symplectic structure in a
neighborhood \(V_{x_0}\subset S\).
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-257"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> We need to show that \(\omega |_S\) is non–degenerate.
</p>

<p>
For \(x\in V_{x_0}\), denote \(\Phi _\tau ^\xi \) the flow generated by the vector \(\xi \in T_x S\). By the constancy of \(p_1\) and \(q_1\) on \(S\), we have that for \(x\in S\)
</p>

<span class="hidden"> \(\seteqnumber{0}{}{238}\)</span>

<!--


                                                                                                       d                                      d
                                                                                            ξ(p1 ) =      p1 (Φξτ x)      = 0,     ξ(q1 ) =      q1 (Φξτ x)      = 0.                                                                   (3.239)
                                                                                                       dτ            τ =0                     dτ            τ =0


-->

<p>


\begin{equation}
\xi (p_1) = \frac {\dd }{\dd \tau } p_1(\Phi _\tau ^\xi x)\Big |_{\tau =0} = 0, \quad \xi (q_1) = \frac {\dd }{\dd \tau } q_1(\Phi _\tau ^\xi x)\Big |_{\tau =0} = 0.
\end{equation}


</p>

<p>
Therefore, for all \(\xi \in T_x S\),
</p>

<span class="hidden"> \(\seteqnumber{0}{}{239}\)</span>

<!--



                                                                                                ω(ξ, Xp1 ) = dp1 (ξ) = 0,         ω(ξ, Xq1 ) = −dq 1 (ξ) = 0.                                                                           (3.240)

-->

<p>


\begin{equation}
\omega (\xi , X_{p_1}) = \dd p_1(\xi ) = 0,\quad \omega (\xi , X_{q^1}) = -\dd q^1(\xi ) = 0.
\end{equation}


</p>

<p>
Therefore, \(T_x S\) is the symplectic complement to \(X_{p_1}\) and \(X_{q^1}\). The proof now follows from the non–degeneracy of \(\omega \) on \(\mathbb {R}^{2n}\): \(\omega \) must be non–degenerate on \(T_x S\), otherwise we would
have a contradiction. <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
By induction hypothesis, in a neighborhood \(V_{x_0}\subset S\) of the manifold \((S, \omega |_S)\) there are symplectic coordinates \((q^2, \ldots , q^n, p_2, \ldots , p_n)\). We want to extend \(q^2, \ldots , q^n\) and \(p_2,
\ldots , p_n\) to a neighborhood \(U_{x_0}\in \mathbb {R}^{2n}\).
</p>

<p>
It follows from the linear independence of \(X_{p_1}\) and \(X_{q^1}\) and their commutativity \([X_{p_1}, X_{q^1}] = -X_{\big \{q^1,p_1\big \}} = 0\) that, if \(s\) and \(t\) are small enough, any point \(z\in U_{x_0}\setminus
V_{x_0}\) can be written uniquely as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{240}\)</span>

<!--


                                                                                                                        1
                                                                                                            z = Φpt 1 Φqs x,     for some x ∈ Vx0 .                                                                                     (3.241)

-->

<p>


\begin{equation}
z = \Phi _t^{p_1}\Phi _s^{q^1} x, \quad \mbox {for some }x\in V_{x_0}.
\end{equation}


</p>

<p>
We define \(q^i(z) := q^i(x)\) and \(p_i(z) := p_i(x)\), \(i=2,\ldots ,n\). The \(2n\) coordinates \((q^1, \ldots , q^n, p_1, \ldots , p_n)\) define a system of local coordinates in the neighborhood of \(x_0\) in \(\mathbb
{R}^{2n}\). It remains to show that these coordinates are symplectic.
</p>

<p>
First of all, observe that, by construction, the coordinates \(q^2, \ldots , q^n\), \(p_2, \ldots , p_n\) are invariant with respect to \(\Phi _t^{p_1}\) and \(\Phi _s^{q^1}\) for small \(t\) and \(s\), and therefore
</p>

<span class="hidden"> \(\seteqnumber{0}{}{241}\)</span>

<!--



                                                                                                                                                                                                                                        (3.242)
                                                                                                     1 i
                                                                                                     q , q = q 1 , pi = p1 , q i = p1 , pi = 0,
                                                                                                                                


-->

<p>


\begin{equation}
\big \{q^1, q^i\big \} = \big \{q^1, p_i\big \} = \big \{p_1, q^i\big \} = \big \{p_1, p_i\big \} = 0,
\end{equation}


</p>

<p>
where \(i = 2,\ldots ,n\). It follows that \(X_{q^i}\) and \(X_{p_i}\) are tangent to the manifold \(s&apos;\) defined, for some small values \(c_1\) and \(c_2\), as \((q^1(z), p_1(z)) = (c_1, c_2)\). As such, they are hamiltonian vector
fields on \(S&apos;\) with hamiltonian functions \(q^i, p_i\), \(i=1,\ldots ,n\).
</p>

<p>
Furthermore, being \(\Phi _t^{p_1}\) and \(\Phi _s^{q^1}\) hamiltonian flows, they preserve the symplectic structure \(\omega \) and therefore
</p>

<span class="hidden"> \(\seteqnumber{0}{}{242}\)</span>

<!--



                                                                                             ω(Xqi , Xpj ) = ω(Xqi |S , Xpj |S ),     q i = q i (z),   pj = pj (z).                                                                     (3.243)

-->

<p>


\begin{equation}
\omega (X_{q^i}, X_{p_j}) = \omega (X_{q^i|_S}, X_{p_j|_S}), \quad q^i = q^i(z), \quad p_j = p_j(z).
\end{equation}


</p>

<p>
where \(i,j=2,\ldots ,n\). By induction hypothesis the coordinates on \(S\) are symplectic and, therefore, they are symplectic on the whole neighborhood \(U_{x_0}\) just constructed. This means that
</p>

<span class="hidden"> \(\seteqnumber{0}{}{243}\)</span>

<!--



                                                                                                                                                                                                                                        (3.244)
                                                                                               i
                                                                                               q , pj = δji ,
                                                                                                                  i j
                                                                                                                  q , q = pi , pj = 0,
                                                                                                                         
                                                                                                                                                  i, j = 2, . . . , n,

-->

<p>


\begin{equation}
\big \{q^i, p_j\big \} = \delta _j^i, \quad \big \{q^i, q^j\big \} = \big \{p^i, p_j\big \} = 0, \quad i,j=2,\ldots ,n,
\end{equation}


</p>

<p>
and thus on \(U_{x_0}\subset \mathbb {R}^{2n}\) the symplectic form \(\omega =\dd p_i \wedge \dd q^i\), proving Darboux’ Theorem. <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>
<!--
...... subsection Liouville theorem ......
-->
<h5 id="autosec-258"><span class="sectionnumber">3.7.3&#x2003;</span>Liouville theorem</h5>
<a id="hm-autopage-258"></a>


<p>
The symplectic formalism allows to prove in a rather immediate fashion a crucial property of hamiltonian systems: the conservation of phase space volume along the flow. This is called Liouville theorem, and will be at the center of attention in this
section. To start with, let’s prove the following lemma.
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-259"></a>
<span class="amsthmnameplain">Lemma</span><span class="amsthmnumberplain"> <span class="textup">3.28</span></span>. </span> On a manifold \(M\) of dimension \(n\), let \(\omega \) be the symplectic form <span
class="textup">(<a href="chapter-3.html#eq:canonical2form">3.201</a>)</span> on \(T^* M\). Then the exterior product of \(n\) copies of \(\omega \) is proportional to the volume form:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{244}\)</span>

<!--


                                                                                                    1
                                                                                             Ω :=      ω ∧ · · · ∧ ω = dp1 ∧ dq 1 ∧ · · · ∧ dpn ∧ dq n .                                                           (3.245)
                                                                                                    n!

-->

<p>


\begin{equation}
\Omega := \frac 1{n!} \omega \wedge \cdots \wedge \omega = \dd p_1 \wedge \dd q^1 \wedge \cdots \wedge \dd p_n \wedge \dd q^n.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-260"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> First of all observe that for two fixed indices \(i,j\)
</p>
<span class="hidden"> \(\seteqnumber{0}{}{245}\)</span>



<!--



                                                                                                         (dpi ∧ dq i ) ∧ (dpj ∧ dq j ) = (dpj ∧ dq j ) ∧ (dpi ∧ dq i )                                                                       (3.246)
                                                                                                                                      = (1 − δij )dpi ∧ dq i ∧ dpj ∧ dq j ,                                                                  (3.247)



-->



<p>


\begin{align}
(\dd p_i \wedge \dd q^i)\wedge (\dd p_j \wedge \dd q^j) &amp; = (\dd p_j \wedge \dd q^j)\wedge (\dd p_i \wedge \dd q^i) \\ &amp; = (1-\delta _i^j) \dd p_i \wedge \dd q^i \wedge \dd p_j \wedge \dd q^j,
\end{align}
i.e., only the terms with different indices survive. Therefore, in the exterior product of \(n\) copies of the two form \(\omega = \dd p_1 \wedge \dd q^1 + \cdot + \dd p_n \wedge \dd q^n\), there are \(n!\) terms surviving, all equal to \(\dd
p_1 \wedge \dd q^1 \wedge \cdots \wedge \dd p_n \wedge \dd q^n\). <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
This lemma immediately implies the invariance of phase space volume with respect to canonical transformations (or symplectomorphisms). Let \(D\subset T^*M\), we define the volume of \(D\) as the integral
</p>

<span class="hidden"> \(\seteqnumber{0}{}{247}\)</span>

<!--

                                                       Z
                                                                         1 n
                                           Vol(D) :=           Ω,   Ω=      ω = dp1 ∧ dq 1 ∧ · · · ∧ dpn ∧ dq n ,                                                   (3.248)                                   --><a id="eq:symplvolume"></a><!--
                                                           D             n!

-->

<p>

\begin{equation}
\label {eq:symplvolume} \Vol (D) :=\int _D \Omega , \quad \Omega = \frac 1{n!} \omega ^n = \dd p_1 \wedge \dd q^1 \wedge \cdots \wedge \dd p_n \wedge \dd q^n,
\end{equation}

</p>

<p>
provided that such integral exists. We call <em>measurable</em> the subsets \(D\) for which \(\Vol (D)\) is well defined.
</p>
<div class="amsthmbodydefinition">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-261"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">3.13</span></span>. </span> Show that the definition of volume \(\Vol (D)\) presented above does not depend on the
choice of local coordinates \(q^1, \ldots , q^n\) on \(M\).
</p>

</li>

</ul>

</div>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-262"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.29</span></span>. </span> <a id="thm:liouville"></a> Let \(\Phi :T^*M \to T^*M\) be a canonical transformation and
\(D\subset T^*M\) measurable, then
</p>

<span class="hidden"> \(\seteqnumber{0}{}{248}\)</span>

<!--



                                                                                                    Vol(Φ(D)) = Vol(D).                                                                                                  (3.249)

-->

<p>


\begin{equation}
\Vol (\Phi (D)) = \Vol (D).
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-263"></a>

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"> <span class="amsthmproofname">Proof.</span></span> The proof follows from the definition <span class="textup">(<a href="chapter-3.html#eq:symplvolume">3.248</a>)</span> using the formula for the change
of variable in the multiple integral
</p>

<span class="hidden"> \(\seteqnumber{0}{}{249}\)</span>

<!--

                                                                                                              Z               Z
                                                                                                                         Ω=       Φ∗ Ω,                                                                                          (3.250)
                                                                                                                  Φ(D)        D


-->

<p>


\begin{equation}
\int _{\Phi (D)}\Omega = \int _D \Phi ^*\Omega ,
\end{equation}


</p>

<p>
and applying the definition of symplectomorphism \(\Phi ^* \omega = \omega \) to \(\Phi ^* \Omega = \frac 1{n!}\Phi ^*\omega \wedge \cdots \wedge \Phi ^*\omega \). <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
The renown Liouville theorem is a special case of the theorem we just proved. For an alternative treatment of Liouville theorem, please refer to [<a href="chapter-6.html#LWR-ht-cite.0@book:arnold">Arn89</a>, Chapter 3.16].
</p>
<div class="amsthmbodyplain">

<ul class="list" style="list-style-type:none">



<li>
<p>
<span class="listmarker"><a id="hm-autopage-264"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">3.30</span></span><span class="amsthmnoteplain"> (Liouville theorem)</span>. </span> Let \(H\) be a hamiltonian function on
\(T^*M\). Then, the hamiltonian flow \(\Phi _t\) generated by \(H\) preserves the volume, that is, for every measurable subset \(D\subset T^*M\) and any \(t\) it holds
</p>

<span class="hidden"> \(\seteqnumber{0}{}{250}\)</span>

<!--



                                                                                                                Vol(Φt (D)) = Vol(D).                                                                                                       (3.251)

-->

<p>


\begin{equation}
\Vol (\Phi _t(D)) = \Vol (D).
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>

<p>
More general invariants can be found considering other products \(\omega ^k\) of the symplectic two–form for \(k\leq n\) and their integrals with respect to closed submanifolds or cycles. These are called <em>integral invariants of
Poincaré-Cartan</em>. We will not treat them further in these notes, but we refer interested readers to [<a href="chapter-6.html#LWR-ht-cite.0@book:arnold">Arn89</a>, Chapter 9.44].
</p>

<p>
A further interesting point of view on the meaning and consequences of Liouville theorem can be found in [<a href="chapter-6.html#LWR-ht-cite.0@lectures:tong">Ton05</a>, Chapters 4.2.1-4.2.2].
</p>

<p>
An important consequence of Theorem&nbsp;<a href="chapter-3.html#thm:liouville">3.29</a> is that we can apply a large corpus of methods from ergodic theory and, more generally, measure preserving dynamical systems to hamiltonian
systems.
</p>

<p>
These are methods that apply to systems with finite measure, however this is not an uncommon property of hamiltonian systems: for a mechanical system with energy \(E = T + U\), due to energy conservation and the positivity of \(T\), the
accessible phase space is contained in the spatial region \(U(q) &lt; E\). If, for example, \(U\) is bounded from below and unbounded from above then this is a region of phase space with bounded volume. You can read more about this in [<a
href="chapter-6.html#LWR-ht-cite.0@book:arnold">Arn89</a>, Chapter 3.16.C-D].
</p>

</section>

</main>

</div>


<nav class="botnavigation"><a href="index.html" class="linkhome" >
Home</a></nav>

</body>
</html>
