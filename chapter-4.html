
<!DOCTYPE html>
<html lang="en-UK">
<head>
<meta charset="UTF-8" />
<meta name="generator" content="LaTeX Lwarp package" />
<meta name="description" content="Lecture notes for Hamiltonian Mechanics" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<title>Hamiltonian Mechanics — Integrable systems</title>
<link rel="stylesheet" type="text/css" href="lwarp.css" />

<script>
// Lwarp MathJax emulation code
//
// Based on code by Davide P. Cervone.
// Equation numbering: https://github.com/mathjax/MathJax/issues/2427
// Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
// \left, \right delimiters: https://github.com/mathjax/MathJax/issues/2535
//
// Modified by Brian Dunn to adjust equation numbering and add subequations.
//
// LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
// subequations? is 0 usually, 1 if inside subequations.
// section is a string printed as-is, or empty.
// number is auto-incremented by MathJax between equations.
//
MathJax = {
    subequations: "0",
    section: "",
    loader: {
         load: ['[tex]/tagformat', '[tex]/textmacros'],
    },
    startup: {
         ready() {
             //      These would be replaced by import commands if you wanted to make
             //      a proper extension.
             const Configuration = MathJax._.input.tex.Configuration.Configuration;
             const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
             const Macro = MathJax._.input.tex.Symbol.Macro;
             const TexError = MathJax._.input.tex.TexError.default;
             const ParseUtil = MathJax._.input.tex.ParseUtil.default;
             const expandable = MathJax._.util.Options.expandable;


             //      Insert the replacement string into the TeX string, and check
             //      that there haven't been too many maxro substitutions (prevents
             //      infinite loops).
             const useArgument = (parser, text) => {
                 parser.string = ParseUtil.addArgs(parser, text, parser.string.slice(parser.i));
                 parser.i = 0;
                 if (++parser.macroCount > parser.configuration.options.maxMacros) {
                     throw new TexError('MaxMacroSub1',
                     'MathJax maximum macro substitution count exceeded; ' +
                     'is there a recursive macro call?');
                 }
             }


             //      Create the command map for:
             //          \ifstar, \ifnextchar, \ifblank, \ifstrequal, \seteqnumber
             new CommandMap('Lwarp-macros', {
                 ifstar: 'IfstarFunction',
                 ifnextchar: 'IfnextcharFunction',
                 ifblank: 'IfblankFunction',
                 ifstrequal: 'IfstrequalFunction',
                 seteqnumber: 'SeteqnumberFunction'
             }, {
                 //      This function implements an ifstar macro.
                 IfstarFunction(parser, name) {
                     const resultstar = parser.GetArgument(name);
                     const resultnostar = parser.GetArgument(name);
                     const star = parser.GetStar();                        // true if there is a *
                     useArgument(parser, star ? resultstar : resultnostar);
                 },


                 //      This function implements an ifnextchar macro.
                 IfnextcharFunction(parser, name) {
                     let whichchar = parser.GetArgument(name);
                     if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
                         // $ syntax highlighting
                         whichchar = String.fromCodePoint(parseInt(whichchar));
                     }
                     const resultnextchar = parser.GetArgument(name);
                     const resultnotnextchar = parser.GetArgument(name);
                     const gotchar = (parser.GetNext() === whichchar);
                     useArgument(parser, gotchar ? resultnextchar : resultnotnextchar);
                 },


                 // This function implements an ifblank macro.
                 IfblankFunction(parser, name) {
                     const blankarg = parser.GetArgument(name);
                     const resultblank = parser.GetArgument(name);
                     const resultnotblank = parser.GetArgument(name);
                     const isblank = (blankarg.trim() == "");
                     useArgument(parser, isblank ? resultblank : resultnotblank);
                 },


                 // This function implements an ifstrequal macro.
                 IfstrequalFunction(parser, name) {
                     const strequalfirst = parser.GetArgument(name);
                     const strequalsecond = parser.GetArgument(name);
                     const resultequal = parser.GetArgument(name);
                     const resultnotequal = parser.GetArgument(name);
                     const isequal = (strequalfirst == strequalsecond);
                     useArgument(parser, isequal ? resultequal : resultnotequal);
                 },


                 //      This function modifies the equation numbers.
                 SeteqnumberFunction(parser, name) {
                         //   Get the macro parameters
                         const star = parser.GetStar();                       // true if there is a *
                         const optBrackets = parser.GetBrackets(name);        // contents of optional brackets
                         const newsubequations = parser.GetArgument(name);       // the subequations argument
                         const neweqsection = parser.GetArgument(name);       // the eq section argument
                         const neweqnumber = parser.GetArgument(name);        // the eq number argument
                         MathJax.config.subequations=newsubequations ;        // a string with boolean meaning
                         MathJax.config.section=neweqsection ;                // a string with numeric meaning
                         parser.tags.counter = parser.tags.allCounter = neweqnumber ;
                 }


             });


             //      Create the Lwarp-macros package
             Configuration.create('Lwarp-macros', {
                 handler: {macro: ['Lwarp-macros']}
             });


             MathJax.startup.defaultReady();


             // For forward references:
             MathJax.startup.input[0].preFilters.add(({math}) => {
                 if (math.inputData.recompile){
                         MathJax.config.subequations = math.inputData.recompile.subequations;
                         MathJax.config.section = math.inputData.recompile.section;
                 }
             });
             MathJax.startup.input[0].postFilters.add(({math}) => {
                 if (math.inputData.recompile){
                         math.inputData.recompile.subequations = MathJax.config.subequations;
                         math.inputData.recompile.section = MathJax.config.section;
                 }
             });


                 // For \left, \right with unicode-math:
                 const {DelimiterMap} = MathJax._.input.tex.SymbolMap;
                 const {Symbol} = MathJax._.input.tex.Symbol;
                 const {MapHandler} = MathJax._.input.tex.MapHandler;
                 const delimiter = MapHandler.getMap('delimiter');
                 delimiter.add('\\lBrack', new Symbol('\\lBrack', '\u27E6'));
                 delimiter.add('\\rBrack', new Symbol('\\rBrack', '\u27E7'));
                 delimiter.add('\\lAngle', new Symbol('\\lAngle', '\u27EA'));
                 delimiter.add('\\rAngle', new Symbol('\\rAngle', '\u27EB'));
                 delimiter.add('\\lbrbrak', new Symbol('\\lbrbrak', '\u2772'));
                 delimiter.add('\\rbrbrak', new Symbol('\\rbrbrak', '\u2773'));
                 delimiter.add('\\lbag', new Symbol('\\lbag', '\u27C5'));
                 delimiter.add('\\rbag', new Symbol('\\rbag', '\u27C6'));
                 delimiter.add('\\llparenthesis', new Symbol('\\llparenthesis', '\u2987'));
                 delimiter.add('\\rrparenthesis', new Symbol('\\rrparenthesis', '\u2988'));
                 delimiter.add('\\llangle', new Symbol('\\llangle', '\u2989'));
                 delimiter.add('\\rrangle', new Symbol('\\rrangle', '\u298A'));
                 delimiter.add('\\Lbrbrak', new Symbol('\\Lbrbrak', '\u27EC'));
                 delimiter.add('\\Rbrbrak', new Symbol('\\Rbrbrak', '\u27ED'));
                 delimiter.add('\\lBrace', new Symbol('\\lBrace', '\u2983'));
                 delimiter.add('\\rBrace', new Symbol('\\rBrace', '\u2984'));
                 delimiter.add('\\lParen', new Symbol('\\lParen', '\u2985'));
                 delimiter.add('\\rParen', new Symbol('\\rParen', '\u2986'));
                 delimiter.add('\\lbrackubar', new Symbol('\\lbrackubar', '\u298B'));
                 delimiter.add('\\rbrackubar', new Symbol('\\rbrackubar', '\u298C'));
                 delimiter.add('\\lbrackultick', new Symbol('\\lbrackultick', '\u298D'));
                 delimiter.add('\\rbracklrtick', new Symbol('\\rbracklrtick', '\u298E'));
                 delimiter.add('\\lbracklltick', new Symbol('\\lbracklltick', '\u298F'));
                 delimiter.add('\\rbrackurtick', new Symbol('\\rbrackurtick', '\u2990'));
                 delimiter.add('\\langledot', new Symbol('\\langledot', '\u2991'));
                 delimiter.add('\\rangledot', new Symbol('\\rangledot', '\u2992'));
                 delimiter.add('\\lparenless', new Symbol('\\lparenless', '\u2993'));
                 delimiter.add('\\rparengtr', new Symbol('\\rparengtr', '\u2994'));
                 delimiter.add('\\Lparengtr', new Symbol('\\Lparengtr', '\u2995'));
                 delimiter.add('\\Rparenless', new Symbol('\\Rparenless', '\u2996'));
                 delimiter.add('\\lblkbrbrak', new Symbol('\\lblkbrbrak', '\u2997'));
                 delimiter.add('\\rblkbrbrak', new Symbol('\\rblkbrbrak', '\u2998'));
                 delimiter.add('\\lvzigzag', new Symbol('\\lvzigzag', '\u29D8'));
                 delimiter.add('\\rvzigzag', new Symbol('\\rvzigzag', '\u29D9'));
                 delimiter.add('\\Lvzigzag', new Symbol('\\Lvzigzag', '\u29DA'));
                 delimiter.add('\\Rvzigzag', new Symbol('\\Rvzigzag', '\u29DB'));
                 delimiter.add('\\lcurvyangle', new Symbol('\\lcurvyangle', '\u29FC'));
                 delimiter.add('\\rcurvyangle', new Symbol('\\rcurvyangle', '\u29FD'));
                 delimiter.add('\\Vvert', new Symbol('\\Vvert', '\u2980'));
         }       // ready
    },           // startup


    tex: {
         packages: {'[+]': ['tagformat', 'Lwarp-macros', 'textmacros']},
         tags: "ams",
                 tagformat: {
                         number: function (n) {
                              if(MathJax.config.subequations==0)
                                     return(MathJax.config.section + n);
                              else
                                     return(MathJax.config.section + String.fromCharCode(96+n));
                         },
                 },
    }
}
</script>


<script
         id="MathJax-script"
         src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
></script>

</head>
<body>


<a id="hm-autopage-268"></a>
<nav class="topnavigation"><a href="index.html" class="linkhome" >
Home</a></nav>


<div class="bodyandsidetoc">
<div class="sidetoccontainer">


<nav class="sidetoc">


<div class="sidetoctitle">

<p>
<span class="sidetocthetitle">Hamiltonian Mechanics</span>
</p>

<p>
Contents
</p>
</div>


<div class="sidetoccontents">

<p>
<a href="index.html" class="linkhome" >
Home</a>
</p>

<p>
<a href="chapter-1.html#autosec-7" class="tocchapter" >
<span class="sectionnumber">1</span>&#x2003;Classical mechanics</a>
</p>


<p>
<a href="chapter-1.html#autosec-8" class="tocsection" >
<span class="sectionnumber">1.1</span>&#x2003;Newtonian mechanics of point particles</a>
</p>


<p>
<a href="chapter-1.html#autosec-18" class="tocsection" >
<span class="sectionnumber">1.2</span>&#x2003;Hamilton’s variational principle</a>
</p>


<p>
<a href="chapter-1.html#autosec-46" class="tocsection" >
<span class="sectionnumber">1.3</span>&#x2003;First steps with conserved quantities</a>
</p>


<p>
<a href="chapter-1.html#autosec-71" class="tocsection" >
<span class="sectionnumber">1.4</span>&#x2003;Euler-Lagrange equations on smooth manifolds</a>
</p>


<p>
<a href="chapter-2.html#autosec-82" class="tocchapter" >
<span class="sectionnumber">2</span>&#x2003;Conservation Laws</a>
</p>


<p>
<a href="chapter-2.html#autosec-83" class="tocsection" >
<span class="sectionnumber">2.1</span>&#x2003;Noether theorem</a>
</p>


<p>
<a href="chapter-2.html#autosec-113" class="tocsection" >
<span class="sectionnumber">2.2</span>&#x2003;The spherical pendulum</a>
</p>


<p>
<a href="chapter-2.html#autosec-116" class="tocsection" >
<span class="sectionnumber">2.3</span>&#x2003;Intermezzo: small oscillations</a>
</p>


<p>
<a href="chapter-2.html#autosec-127" class="tocsection" >
<span class="sectionnumber">2.4</span>&#x2003;Motion in a central potential</a>
</p>


<p>
<a href="chapter-2.html#autosec-146" class="tocsection" >
<span class="sectionnumber">2.5</span>&#x2003;D’Alembert principle and systems with constraints</a>
</p>


<p>
<a href="chapter-3.html#autosec-161" class="tocchapter" >
<span class="sectionnumber">3</span>&#x2003;Hamiltonian mechanics</a>
</p>


<p>
<a href="chapter-3.html#autosec-162" class="tocsection" >
<span class="sectionnumber">3.1</span>&#x2003;The Legendre Transform in the euclidean plane</a>
</p>


<p>
<a href="chapter-3.html#autosec-164" class="tocsection" >
<span class="sectionnumber">3.2</span>&#x2003;Intermezzo: cotangent bundle and differential forms</a>
</p>


<p>
<a href="chapter-3.html#autosec-165" class="tocsection" >
<span class="sectionnumber">3.3</span>&#x2003;The Legendre Transform</a>
</p>


<p>
<a href="chapter-3.html#autosec-186" class="tocsection" >
<span class="sectionnumber">3.4</span>&#x2003;Poisson brackets and first integrals of motion</a>
</p>


<p>
<a href="chapter-3.html#autosec-199" class="tocsection" >
<span class="sectionnumber">3.5</span>&#x2003;Variational principles of hamiltonian mechanics</a>
</p>


<p>
<a href="chapter-3.html#autosec-212" class="tocsection" >
<span class="sectionnumber">3.6</span>&#x2003;Canonical transformations</a>
</p>


<p>
<a href="chapter-3.html#autosec-234" class="tocsection" >
<span class="sectionnumber">3.7</span>&#x2003;The symplectic structure on the cotangent bundle</a>
</p>


<p>
<a href="chapter-4.html#autosec-269" class="tocchapter" >
<span class="sectionnumber">4</span>&#x2003;Integrable systems</a>
</p>


<p>
<a href="chapter-4.html#autosec-270" class="tocsection" >
<span class="sectionnumber">4.1</span>&#x2003;Lagrangian submanifolds</a>
</p>


<p>
<a href="chapter-4.html#autosec-279" class="tocsection" >
<span class="sectionnumber">4.2</span>&#x2003;Canonical transformations revisited</a>
</p>


<p>
<a href="chapter-4.html#autosec-302" class="tocsection" >
<span class="sectionnumber">4.3</span>&#x2003;Hamilton-Jacobi equations</a>
</p>


<p>
<a href="chapter-4.html#autosec-316" class="tocsection" >
<span class="sectionnumber">4.4</span>&#x2003;The Liouville-Arnold theorem</a>
</p>


<p>
<a href="chapter-5.html#autosec-335" class="tocchapter" >
<span class="sectionnumber">5</span>&#x2003;Hamiltonian perturbation theory</a>
</p>


<p>
<a href="chapter-5.html#autosec-336" class="tocsection" >
<span class="sectionnumber">5.1</span>&#x2003;Small oscillations revisited</a>
</p>


<p>
<a href="chapter-5.html#autosec-344" class="tocsection" >
<span class="sectionnumber">5.2</span>&#x2003;Birkhoff normal forms</a>
</p>


<p>
<a href="chapter-5.html#autosec-348" class="tocsection" >
<span class="sectionnumber">5.3</span>&#x2003;A brief look at KAM theory</a>
</p>


<p>
<a href="chapter-5.html#autosec-352" class="tocsection" >
<span class="sectionnumber">5.4</span>&#x2003;Nekhoroshev theorem</a>
</p>


<p>
<a href="chapter-6.html#autosec-355" class="tocchapter" >
<span class="sectionnumber">6</span>&#x2003;Conclusion</a>
</p>


<p>
<a href="chapter-6.html#autosec-355" class="tocchapter" >
Bibliography</a>
</p>


<p>
<a href="index.html#autosec-356" class="tocchapter" >
Index</a>
</p>


</div>

</nav>

</div>


<main class="bodycontainer">


<section class="textbody">

<h1>Hamiltonian Mechanics</h1>

<!--MathJax customizations:-->


<div class="hidden">

\(\newcommand{\footnotename}{footnote}\)

\(\def \LWRfootnote {1}\)

\(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\let \LWRorighspace \hspace \)

\(\renewcommand {\hspace }{\ifstar \LWRorighspace \LWRorighspace }\)

\(\newcommand {\mathnormal }[1]{{#1}}\)

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\arabic }[1]{}\)

\(\newcommand {\number }[1]{}\)

\(\newcommand {\noalign }[1]{\text {#1}\notag \\}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\protect }{}\)

\(\def \LWRabsorbnumber #1 {}\)

\(\def \LWRabsorbquotenumber &quot;#1 {}\)

\(\newcommand {\LWRabsorboption }[1][]{}\)

\(\newcommand {\LWRabsorbtwooptions }[1][]{\LWRabsorboption }\)

\(\def \mathchar {\ifnextchar &quot;\LWRabsorbquotenumber \LWRabsorbnumber }\)

\(\def \mathcode #1={\mathchar }\)

\(\let \delcode \mathcode \)

\(\let \delimiter \mathchar \)

\(\def \oe {\unicode {x0153}}\)

\(\def \OE {\unicode {x0152}}\)

\(\def \ae {\unicode {x00E6}}\)

\(\def \AE {\unicode {x00C6}}\)

\(\def \aa {\unicode {x00E5}}\)

\(\def \AA {\unicode {x00C5}}\)

\(\def \o {\unicode {x00F8}}\)

\(\def \O {\unicode {x00D8}}\)

\(\def \l {\unicode {x0142}}\)

\(\def \L {\unicode {x0141}}\)

\(\def \ss {\unicode {x00DF}}\)

\(\def \SS {\unicode {x1E9E}}\)

\(\def \dag {\unicode {x2020}}\)

\(\def \ddag {\unicode {x2021}}\)

\(\def \P {\unicode {x00B6}}\)

\(\def \copyright {\unicode {x00A9}}\)

\(\def \pounds {\unicode {x00A3}}\)

\(\let \LWRref \ref \)

\(\renewcommand {\ref }{\ifstar \LWRref \LWRref }\)

\( \newcommand {\multicolumn }[3]{#3}\)

\(\require {textcomp}\)

\(\newcommand {\toprule }[1][]{\hline }\)

\(\let \midrule \toprule \)

\(\let \bottomrule \toprule \)

\(\def \LWRbooktabscmidruleparen (#1)#2{}\)

\(\newcommand {\LWRbooktabscmidrulenoparen }[1]{}\)

\(\newcommand {\cmidrule }[1][]{\ifnextchar (\LWRbooktabscmidruleparen \LWRbooktabscmidrulenoparen }\)

\(\newcommand {\morecmidrules }{}\)

\(\newcommand {\specialrule }[3]{\hline }\)

\(\newcommand {\addlinespace }[1][]{}\)

\(\newcommand {\intertext }[1]{\text {#1}\notag \\}\)

\(\let \Hat \hat \)

\(\let \Check \check \)

\(\let \Tilde \tilde \)

\(\let \Acute \acute \)

\(\let \Grave \grave \)

\(\let \Dot \dot \)

\(\let \Ddot \ddot \)

\(\let \Breve \breve \)

\(\let \Bar \bar \)

\(\let \Vec \vec \)

\(\require {physics}\)

\(\newcommand {\nicefrac }[3][]{\mathinner {{}^{#2}\!/\!_{#3}}}\)

\(\newcommand {\unit }[2][]{#1 \mathinner {#2}}\)

\(\newcommand {\unitfrac }[3][]{#1 \mathinner {{}^{#2}\!/\!_{#3}}}\)

\(\newcommand {\tcbset }[1]{}\)

\(\newcommand {\tcbsetforeverylayer }[1]{}\)

\(\newcommand {\tcbox }[2][]{\boxed {\text {#2}}}\)

\(\newcommand {\tcboxfit }[2][]{\boxed {#2}}\)

\(\newcommand {\tcblower }{}\)

\(\newcommand {\tcbline }{}\)

\(\newcommand {\tcbtitle }{}\)

\(\newcommand {\tcbsubtitle [2][]{\mathrm {#2}}}\)

\(\newcommand {\tcboxmath }[2][]{\boxed {#2}}\)

\(\newcommand {\tcbhighmath }[2][]{\boxed {#2}}\)

\( \DeclareMathOperator {\D }{D} \DeclareMathOperator {\Id }{Id} \DeclareMathOperator {\diag }{diag} \DeclareMathOperator {\mod }{mod} \DeclareMathOperator {\Vol }{Vol} \)

</div>

<p>
<!--................................-->
<h3 id="autosec-269"><span class="sectionnumber">4&#x2003;</span>Integrable systems</h3>
<a id="hm-autopage-269"></a>
<a id="hm-autofile-4"></a>

<p>
In this chapters we will develop further the theory to investigate a very important family of hamiltonian systems, the so-called integrable systems. In some sense we will generalize to higher dimensions the integration by quadrature that we had already
seen in the first chapter of these notes. Integrable systems will be central to our study of perturbation theory and play a big role in the study of hamiltonian systems, symplectic geometry and symplectic topology, not to mention their generalizations...
</p>
<!--................................-->
<h4 id="autosec-270"><span class="sectionnumber">4.1&#x2003;</span>Lagrangian submanifolds</h4>
<a id="hm-autopage-270"></a>



<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
Let \(M\) be smooth manifold of dimension \(n\). We call <em>lagrangian</em> any submanifold \(\Lambda \subset T^*M\), if \(\dim \Lambda = n\) and the symplectic two–form \(\omega \) vanishes on the corresponding tangent subbundle, i.e.,
\(\omega (X, Y) = 0\) for all \(X,Y \in \Gamma (T\Lambda )\).
</p>
</div>

</div>

<p>
As we will see by the end of this section, lagrangian submanifold have a crucial property: if a trajectory of the hamiltonian intersects one of them, then it is fully contained in it. In other words, the hamiltonian motion is constrained to happen in
lagrangian submanifolds. This generalizes our observation that the energy levels of one dimensional conservative systems fully contain (and separate) the solutions of the relative equations of motion.
</p>

<p>
In general, any submanifold \(\Lambda \subset T^*M\) of dimension \(n\) can be characterized, at least locally, by a family of \(n\) independent equations on \(T^*M\):
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{0}\)</span>

<!--


                                                             fi (q, p) = 0,   i = 1, . . . , n,                                                     (4.1)                                                         --><a id="eq:lagsubconstrf"></a><!--

-->

<p>

\begin{equation}
\label {eq:lagsubconstrf} f_i(q, p) = 0, \quad i=1,\ldots ,n,
\end{equation}

</p>

<p>
such that the \(2n\times n\) matrix \(\left (\frac {\partial f_i}{\partial q^j}, \frac {\partial f_i}{\partial p_k}\right )\) has full rank.
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-271"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.1</span></span>.               The submanifold \(\Lambda \) defined by <span class="textup">(<a
href="chapter-4.html#eq:lagsubconstrf">4.1</a>)</span> is lagrangian if and only if the functions \(f_i\) are in involution on \(\Lambda \), i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{1}\)</span>

<!--


                                                        
                                                            fi , f j   Λ
                                                                           = 0,   i, j = 1, . . . , n.                                         (4.2)                                                  --><a id="eq:charlagsm1"></a><!--

-->

<p>


\begin{equation}
\label {eq:charlagsm1} \big \{f_i, f_j\big \}\big |_\Lambda = 0, \quad i,j = 1,\ldots ,n.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-272"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> Let \(X_{f_i}\) be the vector fields generated by the \(f_i\), i.e., \(\omega (X_{f_i}, \cdot )=-\dd f_i\). The derivative of \(f_i\) in the direction of \(X_{f_j}\) is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{2}\)</span>

<!--


                                                                                                                            
                                                                                                                  X fj f i = f i , f j .                                                                                                     (4.3)

-->

<p>


\begin{equation}
X_{f_j}f_i = \big \{f_i,f_j\big \}.
\end{equation}


</p>

<p>
Assume that \(\Lambda \) is a lagrangian submanifold. Then, every \(Y\in \Gamma (T\Lambda )\) is characterized by the equation \(\dd f_i(Y) = 0\), i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{3}\)</span>

<!--



                                                           ω(Xfi , Y ) = 0,   i = 1, . . . , n.                                                       (4.4)                                                    --><a id="eq:charvtls"></a><!--

-->

<p>


\begin{equation}
\label {eq:charvtls} \omega (X_{f_i}, Y) = 0, \quad i=1,\ldots ,n.
\end{equation}


</p>

<p>
The set
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{4}\)</span>

<!--


                                                                                                         
                                                                                                  T Λ⊥ := Z ∈ T (T ∗ M ) | ω(Y, Z) = 0, ∀Y ∈ Γ(T Λ)                                                                                          (4.5)

-->

<p>


\begin{equation}
T\Lambda ^\perp := \big \{Z\in T(T^*M) \mid \omega (Y,Z) = 0, \; \forall Y\in \Gamma (T\Lambda )\big \}
\end{equation}


</p>

<p>
is called <em>symplectic complement</em> of \(T\Lambda \). The dimension of \(T\Lambda ^\perp \) is complementary to the one of \(T\Lambda \), and thus it is also \(n\). Since, by hypothesis, \(\omega \) vanishes on \(\Lambda \), it turns out
that \(T\Lambda \subseteq T\Lambda ^\perp \). Being subspaces of equal dimension, they must coincide: any vector orthogonal to \(T\Lambda \) belongs to \(T\Lambda \). Therefore, by <span class="textup">(<a
href="chapter-4.html#eq:charvtls">4.4</a>)</span>, the vectors \(X_{f_i}\) are tangent to \(\Lambda \) and, using again the fact that \(\Lambda \) is lagrangian, it holds
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{5}\)</span>

<!--


                                                                                                                               
                                                                                                            0 = ω(Xfi , Xfj ) = fi , fj    Λ
                                                                                                                                               .                                                                                             (4.6)

-->

<p>


\begin{equation}
0 = \omega (X_{f_i}, X_{f_j}) = \big \{f_i, f_j\big \}\big |_\Lambda .
\end{equation}


</p>

<p>
This proves the first implication.
</p>

<p>
If we assume <span class="textup">(<a href="chapter-4.html#eq:charlagsm1">4.2</a>)</span> to hold true, then on \(\Lambda \) we have \(X_{f_j}f_i = 0\), that is, the fields \(X_{f_j}\) are tangent to the surface. Furthermore, they are
linearly independent, as \(\dd f_j\) are linearly independent by hypothesis. This means that the vectors \(X_{f_j}\) are a basis of \(T\Lambda \). Since \(\omega (X_{f_i}, X_{f_j}) = \big \{f_i,f_j\big \}\), <span class="textup">(<a
href="chapter-4.html#eq:charlagsm1">4.2</a>)</span> implies also that \(\omega (X_{f_i}, X_{f_j}) = 0\) for all \(i,j=1,\ldots .n\). That is, \(\omega \) vanishes on \(T\Lambda \). <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-273"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">4.1</span></span>.                                            One of the simplest example of lagrangian submanifolds are
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{6}\)</span>



<!--



                                                                                                                         
                                                                                                                   Λq0 := (q, p) ∈ T ∗ M | q = q0                                                                                      (4.7)
                                                                                                                         
                                                                                                                   Λp0 := (q, p) ∈ T ∗ M | p = p0 .                                                                                    (4.8)



-->



<p>


\begin{align}
&amp; \Lambda _{q_0} := \big \{(q,p)\in T^*M \mid q=q_0\big \} \\ &amp; \Lambda _{p_0} := \big \{(q,p)\in T^*M \mid p=p_0\big \}.
\end{align}
Observe that the canonical transformation \((q,p) \mapsto (p,-q)\) exchanges one with the other.
</p>

</li>

</ul>

</div>

<p>
Any lagrangian submanifold can be written, locally, in a parametric fashion using the equations
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{8}\)</span>

<!--


                                                                                                  q i = q i (u1 , . . . , un ),   pi = pi (u1 , . . . , un ),   i = 1, . . . , n                                                       (4.9)

-->

<p>

\begin{equation}
q^i = q^i(u^1, \ldots , u^n), \quad p_i = p_i(u^1, \ldots , u^n), \quad i=1,\ldots ,n
\end{equation}

</p>

<p>
with the requirement that the \(n\times 2n\) matrix \(\left (\frac {\partial q^i}{\partial u^k}, \frac {\partial p_i}{\partial u^k}\right )_{i,k=1,\ldots ,n}\) is of full rank.
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-274"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.2</span></span>.   <a id="thm:charbrals"></a> The submanifold \(\Lambda \) is lagrangian if and only if the following equations
are satisfied:
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{9}\)</span>

<!--

                                                                                   
                                                              ∂pi ∂q i   ∂pi ∂q i
                                                                k    l
                                                                       −                = 0,   k, l = 1, . . . , n                                         (4.10)                              --><a id="eq:charbrals"></a><!--
                                                              ∂u ∂u      ∂ul ∂uk

-->

<p>


\begin{equation}
\label {eq:charbrals} \left (\frac {\partial p_i}{\partial u^k}\frac {\partial q^i}{\partial u^l} - \frac {\partial p_i}{\partial u^l}\frac {\partial q^i}{\partial u^k} \right ) = 0, \quad k,l=1,\ldots ,n
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-275"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> In canonical coordinates, the symplectic two–form takes the form \(\omega = \dd p_i \wedge \dd q^i\). If we substitute the parametric form of the coordinates, we obtain
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{10}\)</span>

<!--


                                                                                                                         ∂pi k ∂q i l
                                                                                                               ω|T Λ =       du ∧     du .                                                                                        (4.11)
                                                                                                                         ∂uk      ∂ul

-->

<p>


\begin{equation}
\omega |_{T\Lambda } = \frac {\partial p_i}{\partial u^k}\dd u^k \wedge \frac {\partial q^i}{\partial u^l}\dd u^l.
\end{equation}


</p>

<p>
Then <span class="textup">(<a href="chapter-4.html#eq:charbrals">4.10</a>)</span> is obtained by setting \(\omega |_{T\Lambda } = 0\) and recalling that \(\wedge \) is antisymmetric. <span
class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
Finally, in analogy with the one dimensional examples, let’s consider a special class of lagrangian submanifolds which are parametrically described by
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{11}\)</span>

<!--


                                                                         pi = Wi (q),   i = 1, . . . , n.                                                           (4.12)                             --><a id="eq:lagsbmPofQ"></a><!--

-->

<p>

\begin{equation}
\label {eq:lagsbmPofQ} p_i = W_i(q), \quad i=1,\ldots ,n.
\end{equation}

</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-276"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.3</span></span>.              <a id="thm:lsoform"></a> Equations <span class="textup">(<a
href="chapter-4.html#eq:lagsbmPofQ">4.12</a>)</span> define a lagrangian submanifold if and only if the following one–form on \(M\) is closed:
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{12}\)</span>

<!--



                                                                                                                 W = Wi dq i .                                                                  (4.13)

-->

<p>


\begin{equation}
W = W_i \dd q^i.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-277"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> Setting \(u^k = q^k\) in Theorem&nbsp;<a href="chapter-4.html#thm:charbrals">4.2</a>, we get the equations
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{13}\)</span>

<!--


                                                                                                                    ∂pk   ∂pl
                                                                                                                         − k = 0,                                                  (4.14)
                                                                                                                    ∂q l  ∂q

-->

<p>


\begin{equation}
\frac {\partial p_k}{\partial q^l} - \frac {\partial p_l}{\partial q^k} = 0,
\end{equation}


</p>

<p>
that is,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{14}\)</span>

<!--


                                                                                                                   ∂Wk     ∂Wl
                                                                                                                         −      =0                                                 (4.15)
                                                                                                                    ∂q l   ∂q k

-->

<p>


\begin{equation}
\frac {\partial W_k}{\partial q^l} - \frac {\partial W_l}{\partial q^k} = 0
\end{equation}


</p>

<p>
which, in turn, is equivalent to \(\dd W = 0\). <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
Since \(W\) is a closed form, it is locally exact and therefore there exists a function \(S: U \subset M \to \mathbb {R}\) such that \(\dd S = W\) or, in other words, such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{15}\)</span>

<!--

                                                                                                                              ∂S
                                                                                                                       pi =        .                                               (4.16)
                                                                                                                              ∂q i

-->

<p>

\begin{equation}
p_i = \frac {\partial S}{\partial q^i}.
\end{equation}

</p>

<p>
Such function \(S\) is called <em>generating function</em> of the lagrangian submanifold.
</p>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-278"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">4.1</span></span>.                             <a id="rmk:nfils"></a> For a hamiltonian system with hamiltonian \(H\), we can compute the
generating function of a lagrangian submanifold from \(n\) first integrals \(f_1, \ldots , f_n\) in involution such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{16}\)</span>

<!--

                                                                                              
                                                                                         ∂fi
                                                                               det                 6= 0.                                                                            (4.17)                             --><a id="eq:condlsgf"></a><!--
                                                                                         ∂pk

-->

<p>


\begin{equation}
\label {eq:condlsgf} \det \left (\frac {\partial f_i}{\partial p_k}\right ) \neq 0.
\end{equation}


</p>

<p>
For any fixed \(n\)-tuple \(a = (a_1, \ldots , a_n) \in \mathbb {R}^n\) and \(f=(f_1,\ldots ,f_n)\), let
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{17}\)</span>

<!--



                                                                                                           Λa = f −1 (a) := {(q, p) ∈ T ∗ M | f (q, p) = a}                                                                                        (4.18)

-->

<p>


\begin{equation}
\Lambda _a = f^{-1}(a) := \{(q,p)\in T^*M \;\mid \; f(q,p) = a\}
\end{equation}


</p>

<p>
be the lagrangian submanifold described by the equations
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{18}\)</span>

<!--



                                                                                                                   fk (q, p) = ak ,   k = 1, . . . , n.                                                                                            (4.19)

-->

<p>


\begin{equation}
f_k(q,p) = a_k, \quad k=1,\ldots ,n.
\end{equation}


</p>

<p>
Thanks to <span class="textup">(<a href="chapter-4.html#eq:condlsgf">4.17</a>)</span>, we can apply the implicit function theorem and invert the equations \(f_k(q,p) = a_k\) with respect to \(p_i\). In this way, we obtain the functions
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{19}\)</span>

<!--



                                                                                                                           pi = Wi (q, a).                                                                                                         (4.20)

-->

<p>


\begin{equation}
p_i = W_i(q,a).
\end{equation}


</p>

<p>
Since the equation above describes by construction the lagrangian submanifold \(\Lambda _a\), Theorem&nbsp;<a href="chapter-4.html#thm:lsoform">4.3</a> implies that the one form \(W_i\dd q^i\) is closed. Therefore, locally there is a
function \(S(q, a)\) such that \(p_i = \partial _{q_i} S\).
</p>

<p>
Furthermore, since \(\big \{f_i, H\big \} = 0\), the hamiltonian vector field satisfies the additional condition \(\omega (X_{f_i}, X_H) = 0\), which means that \(X_H\in T\Lambda _a\). Said in other words, <em>the trajectories of the
hamiltonian flow which intersect \(\Lambda _a\) are completely contained in \(\Lambda _a\)</em>.
</p>

</li>

</ul>

</div>
<!--................................-->
<h4 id="autosec-279"><span class="sectionnumber">4.2&#x2003;</span>Canonical transformations revisited</h4>
<a id="hm-autopage-279"></a>


<p>
Our aim is the characterization of canonical transformations. We will start by recalling a few of our previous results.
</p>

<p>
Let \(M\), as usual, be a smooth manifold of dimension \(n\). If \(T^*M\) is endowed with a Poisson bracket structure, we saw that a diffeomorphism \(\Phi :T^*M\to T^*M\) is a canonical transformation if its pullback \(\Phi ^*:\mathcal
{C}^\infty (T^*M)\to \mathcal {C}^\infty (T^*M)\) is an automorphism of the Lie algebra, i.e., \(\Phi ^*\big \{f,g\big \} = \big \{\Phi ^* f, \Phi ^* g\big \}\), see <span class="textup">(<a
href="chapter-3.html#eq:automorphism">3.129</a>)</span>.
</p>

<p>
Moreover, we know from Theorem&nbsp;<a href="chapter-3.html#thm:ctiffs">3.22</a> that any canonical transformation \(\Phi :T^*M\to T^*M\) of a symplectic manifold \((T^*M,\omega )\) is a symplectomorphism, i.e., \(\Phi ^* \omega =
\omega \).
</p>

<p>
We have also seen that a hamiltonian \(H(q,p)\) with canonical coordinates \((q,p)\) on \(T^*M\) gives rise to the hamiltonian system
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{20}\)</span>

<!--

                                                                                                                ∂H(q, p)               ∂H(q, p)
                                                                                                       q̇ i =            ,   ṗi = −            ,    i = 1, . . . , n.                                                                        (4.21)
                                                                                                                  ∂pi                    ∂q i

-->

<p>

\begin{equation}
\dot q^i = \frac {\partial H(q,p)}{\partial p_i},\quad \dot p_i = -\frac {\partial H(q,p)}{\partial q^i},\quad i=1,\ldots ,n.
\end{equation}

</p>

<p>
The action of the canonical transformation \(\Phi \) such that \((q^i, p_i) \mapsto (Q^i, P_i)\) defines a new hamiltonian \(K(Q,P) = H(q(Q,P), p(Q,P))\) keeping the symplectic form invariant, i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{21}\)</span>

<!--


                                                                                                                 dpi ∧ dq i = ω = Φ∗ ω = dPi ∧ dQi .                                                                                          (4.22)

-->

<p>

\begin{equation}
\dd p_i \wedge \dd q^i = \omega = \Phi ^* \omega = \dd P_i \wedge \dd Q^i.
\end{equation}

</p>

<p>
However, this means that the corresponding equations of motion must keep the same structure
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{22}\)</span>

<!--

                                                                                                              ∂K(Q, P )                ∂K(Q, P )
                                                                                                      Q̇i =             ,    Ṗi = −             ,     i = 1, . . . , n.                                                                      (4.23)
                                                                                                                ∂Pi                      ∂Qi

-->

<p>

\begin{equation}
\dot Q^i = \frac {\partial K(Q,P)}{\partial P_i},\quad \dot P_i = -\frac {\partial K(Q,P)}{\partial Q^i},\quad i=1,\ldots ,n.
\end{equation}

</p>

<p>
In general, a change of coordinates \(x\mapsto X=(\Phi ^1(x), \ldots , \Phi ^{2n}(x))\) requires to fix \(2n\) functions. As we already saw, when \(\Phi \) is canonical then it is uniquely determined by a single function, called <em>generating
function</em> of the canonical transformation.
</p>

<p>
The starting point for the construction of the generating function is Theorem&nbsp;<a href="chapter-3.html#thm:genfun">3.23</a>, which confirms the existence, locally, of a function \(S=S(q,p)\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{23}\)</span>

<!--


                                                                             pi dq i = Pi dQi + dS.                                                                        (4.24)                           --><a id="eq:coordgenfun"></a><!--

-->

<p>

\begin{equation}
\label {eq:coordgenfun} p_i \dd q^i = P_i \dd Q^i + dS.
\end{equation}

</p>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-280"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">4.2</span></span>.                  If \(q^i = Q^i\), \(i=1,\ldots ,n\), then the function \(S=S(q)\). In fact, in this case, <span
class="textup">(<a href="chapter-4.html#eq:coordgenfun">4.24</a>)</span> reads
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{24}\)</span>



<!--



                                                                                                       ∂Qi j         ∂Qi
                                                                                        pi dq i − Pi        dq − P i     dpj = (pi − Pi )dq i                                                                                                    (4.25)
                                                                                                       ∂q j          ∂pj
                                                                                                                                ∂S i      ∂S
                                                                                                                             =      dq +      dpi ,                                                                                              (4.26)
                                                                                                                               ∂q i       ∂pi



-->



<p>


\begin{align}
p_i \dd q^i - P_i \frac {\partial Q^i}{\partial q^j}\dd q^j - P_i \frac {\partial Q^i}{\partial p_j}\dd p_j &amp; = (p_i -P_i)\dd q^i \\ &amp; = \frac {\partial S}{\partial q^i}\dd q^i + \frac {\partial S}{\partial
p_i}\dd p_i,
\end{align}
which imply \(\frac {\partial S}{\partial p_i} = 0\) and, thus, \(p_i = P_i + \frac {\partial S(q)}{\partial q^i}\).
</p>

</li>

</ul>

</div>
<!--................................-->
<h5 id="autosec-281"><span class="sectionnumber">4.2.1&#x2003;</span>The generating function \(S_1\)</h5>
<a id="hm-autopage-281"></a>


<p>
Assume, now, that the \(2n\) functions \((q^i, Q^i)\) are independent, i.e., they define a system of coordinates on the manifold \(T^*M\). Recall that this is possible if the Jacobian determinant of the change of variable is non–zero, i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{26}\)</span>

<!--

                                                                                                                                                      
                                                                                                                          ∂(q, Q)                   ∂Q
                                                                                                                det                     = det                6= 0.                                                                                (4.27)
                                                                                                                          ∂(q, p)                   ∂p

-->

<p>

\begin{equation}
\det \left (\frac {\partial (q,Q)}{\partial (q,p)}\right ) = \det \left (\frac {\partial Q}{\partial p} \right )\neq 0.
\end{equation}

</p>

<p>
In this case, the function \(S\), locally, can be expressed in terms of the coordinates \(q\) and \(Q\), i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{27}\)</span>

<!--


                                                                                                                      S1 (q, Q) = S(q, p(q, Q)),                                                                                                  (4.28)

-->

<p>

\begin{equation}
S_1(q, Q) = S(q, p(q,Q)),
\end{equation}

</p>

<p>
and <span class="textup">(<a href="chapter-4.html#eq:coordgenfun">4.24</a>)</span> is equivalent to the equations
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{28}\)</span>

<!--

                                                                 ∂S1               ∂S1
                                                          pi =        ,   Pi = −       ,   i = 1, . . . , n.                                                         (4.29)                                      --><a id="eq:coordgenfun1"></a><!--
                                                                 ∂q i              ∂Qi

-->

<p>

\begin{equation}
\label {eq:coordgenfun1} p_i = \frac {\partial S_1}{\partial q^i}, \quad P_i = -\frac {\partial S_1}{\partial Q^i}, \quad i = 1,\ldots ,n.
\end{equation}

</p>

<p>
It is important to emphasize that the function \(S_1\) is not defined on the phase space \(T^*M\) but, instead, in a domain of the direct product of two euclidean \(n\)-dimensional coordinate spaces \(\mathbb {R}^n_q\times \mathbb {R}^n_Q\).
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-282"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.4</span></span>.           <a id="thm:S1"></a> Let \(S_1(q,Q)\) be a function defined in a neighborhood of the point \((q_0, Q_0)\) of
two euclidean coordinate spaces. If
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{29}\)</span>

<!--

                                                                                  
                                                                   ∂ 2 S1 (q, Q)
                                                         det                           6= 0                                            (4.30)                                                 --><a id="eq:coordgenfun1-ndeg"></a><!--
                                                                       ∂q∂Q

-->

<p>


\begin{equation}
\label {eq:coordgenfun1-ndeg} \det \left ( \frac {\partial ^2 S_1(q,Q)}{\partial q \partial Q} \right )\neq 0
\end{equation}


</p>

<p>
and <span class="textup">(<a href="chapter-4.html#eq:coordgenfun1">4.29</a>)</span> holds, then \(S_1\) is the generating function of a canonical transformation.
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-283"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> Consider <span class="textup">(<a href="chapter-4.html#eq:coordgenfun1">4.29</a>)</span> in the coordinates \(Q\):
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{30}\)</span>

<!--


                                                                                                                  ∂S1 (q, Q)
                                                                                                           pi =              ,   i = 1, . . . , n.                                                                                          (4.31)
                                                                                                                    ∂q i

-->

<p>


\begin{equation}
p_i = \frac {\partial S_1(q,Q)}{\partial q^i}, \quad i = 1,\ldots , n.
\end{equation}


</p>

<p>
Thanks to the non–degeneracy implied by <span class="textup">(<a href="chapter-4.html#eq:coordgenfun1-ndeg">4.30</a>)</span>, we can apply the implicit function theorem and resolve the equation for \(Q = Q(q,p)\) in a neighborhood
of a point \((q_0, p_0) := \left (q_0, \frac {\partial S_1}{\partial q}\Big |_{(q,Q) =(q_0, Q_0)}\right )\). Changing variables in the equations for \(P\) in <span class="textup">(<a
href="chapter-4.html#eq:coordgenfun1">4.29</a>)</span>, we get
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{31}\)</span>

<!--


                                                                                                                     ∂S1
                                                                                                     Pi (q, p) = −                ,     i = 1, . . . , n.                                                                                   (4.32)
                                                                                                                     ∂Qi Q=Q(q,p)

-->

<p>


\begin{equation}
P_i(q,p) = -\frac {\partial S_1}{\partial Q^i}\Big |_{Q=Q(q,p)},\quad i=1,\ldots ,n.
\end{equation}


</p>

<p>
The transformation \((q,p) \mapsto (Q(q,p), P(q,p))\) is then canonical because by construction
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{32}\)</span>



<!--



                                                                                                                       ∂S1 (q, Q) i ∂S1 (q, Q)
                                                                                                  pi dq i − Pi dQi =             dq +          dQi                                                                                          (4.33)
                                                                                                                         ∂q i         ∂Qi
                                                                                                                   = dS1 (q, Q).                                                                                                            (4.34)



-->



<p>


\begin{align}
p_i \dd q^i - P_i \dd Q^i &amp; = \frac {\partial S_1(q,Q)}{\partial q^i}\dd q^i + \frac {\partial S_1(q,Q)}{\partial Q^i}\dd Q^i \\ &amp; = \dd S_1(q,Q).
\end{align}
<span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
We call <em>free</em> a canonical transformation \(\Phi :T^*M\to T^* M\), \(\Phi (q,p) = (Q,P)\), for which we can choose \(q\) and \(Q\) as independent coordinates. In this case, the function \(S\) expressed in the coordinates \((q,Q)\) is
called generating function \(S_1\).
</p>
</div>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-284"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">4.3</span></span>.   Not all canonical transformations are free: the identical transformation is not free, as \(q=Q\) and
thus they are not independent.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-285"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">4.2</span></span>.                   <a id="ex:integrabilityho"></a> Let \(\omega &gt; 0\) be some fixed constant. Consider the
transformation \(\Phi \) given by
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{34}\)</span>

<!--

                                                                                                                     r                        !
                                                                                                                         2p        p
                                                                                              (q, p) 7→ (Q, P ) =           sin(q), 2pω cos(q) .                                                                                        (4.35)
                                                                                                                         ω

-->

<p>


\begin{equation}
(q,p) \mapsto (Q,P) = \left ( \sqrt {\frac {2p}{\omega }} \sin (q), \sqrt {2p\omega }\cos (q) \right ).
\end{equation}


</p>

<p>
In this case, the conservation of the symplectic form can be checked immediately:
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{35}\)</span>



<!--


                                                                                                          r                              
                                                                                                              ω             p
                                                                                              dP ∧ dQ =          cos(q)dp − 2pω sin(q)dq                                                                                                (4.36)
                                                                                                              2p
                                                                                                                               r             !
                                                                                                                1                2p
                                                                                                          ∧   √     sin(q)dp +      cos(q)dq                                                                                            (4.37)
                                                                                                                2ωp              ω

                                                                                                       = dp ∧ dq.                                                                                                                       (4.38)



-->



<p>


\begin{align}
\dd P\wedge \dd Q &amp; = \left (\sqrt {\frac {\omega }{2 p}}\cos (q)\dd p - \sqrt {2 p\omega } \sin (q)\dd q\right ) \\ &amp; \quad \wedge \left (\frac {1}{\sqrt {2\omega p}}\sin (q)\dd p + \sqrt {\frac {2
p}{\omega }} \cos (q)\dd q\right ) \\ &amp; = \dd p \wedge \dd q.
\end{align}


</p>

<p>
For \(S_1(q,Q) = -\frac {\omega }{2}Q^2\cot (q)\), one gets
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{38}\)</span>

<!--


                                                                                                 ∂S1      ωQ2               ∂S1
                                                                                                     =             ,            = −Qω cot(2q).                                                                                          (4.39)
                                                                                                 ∂q    2 sin2 (2q)          ∂Q

-->

<p>


\begin{equation}
\frac {\partial S_1}{\partial q} = \frac {\omega Q^2}{2\sin ^2(2q)}, \quad \frac {\partial S_1}{\partial Q} = - Q\omega \cot (2q).
\end{equation}


</p>

<p>
That is, \(S_1\) generates the canonical transformation \(\Phi \) since
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{39}\)</span>

<!--


                                                                                                       P                      Q2        p
                                                                                                         = ω cot(q),                 =    ,                                                                                             (4.40)
                                                                                                       Q                    sin2 (q)   πω

-->

<p>


\begin{equation}
\frac {P}{Q} = \omega \cot (q), \quad \frac {Q^2}{\sin ^2(q)} = \frac {p}{\pi \omega },
\end{equation}


</p>

<p>
which implies
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{40}\)</span>

<!--


                                                                                                                    ∂S1            ∂S1
                                                                                                           P =−         ,     p=       .                                                                                                (4.41)
                                                                                                                    ∂Q             ∂q

-->

<p>


\begin{equation}
P = -\frac {\partial S_1}{\partial Q}, \quad p = \frac {\partial S_1}{\partial q}.
\end{equation}


</p>

<p>
The hamiltonian \(H(Q,P) = \frac 12 (P^2 + \omega ^2 Q^2)\) is transformed into
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{41}\)</span>

<!--



                                                                                                                K(q, p) = ωp,                                                                                                           (4.42)

-->

<p>


\begin{equation}
K(q,p) = \omega p,
\end{equation}


</p>

<p>
and the linear equations of motion of \(H\) give rise to the equation for motion for \(K\):
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{42}\)</span>

<!--



                                                                                                               q̇ = ω,       ṗ = 0.                                                                                                    (4.43)

-->

<p>


\begin{equation}
\dot q = \omega , \quad \dot p = 0.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<!--................................-->
<h5 id="autosec-286"><span class="sectionnumber">4.2.2&#x2003;</span>The generating functions \(S_2\) and \(S_3\)</h5>
<a id="hm-autopage-286"></a>


<p>
We already know a trick to move from a generating function to a different one: the Legendre transform. For example, we could choose \((q,P)\) as coordinates and, if they are independent,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{43}\)</span>

<!--

                                                                                                                                                              
                                                                                                                                 ∂(q, P )                   ∂P
                                                                                                                       det                      = det                6= 0,                                                (4.44)
                                                                                                                                 ∂(q, p)                    ∂p

-->

<p>

\begin{equation}
\det \left ( \frac {\partial (q,P)}{\partial (q,p)}\right ) = \det \left ( \frac {\partial P}{\partial p} \right )\neq 0,
\end{equation}

</p>

<p>
by summing and subtracting \(Q^i\dd P_i\) and doing simple algebraic manipulations we end up with
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{44}\)</span>

<!--

                                                                                                                                                      
                                                                                                                        pi dq i + Qi dP i = d Pi Qi + S .                                                                 (4.45)

-->

<p>

\begin{equation}
p_i \dd q^i + Q_i \dd P^i = \dd (P_iQ^i + S).
\end{equation}

</p>

<p>
The quantity \(P_iQ^i + S\), expressed as function of \((q,P)\), is the new generating function:
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{45}\)</span>

<!--


                                                                                                                     S2 (q, P ) = Pi Qi (q, P ) + S(q, p(q, P )).                                                         (4.46)

-->

<p>

\begin{equation}
S_2(q,P) = P_i Q^i(q,P) + S(q, p(q,P)).
\end{equation}

</p>

<p>
The coordinates \(p\) and \(Q\) are expressed through \(S_2\) by the relations
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{46}\)</span>

<!--

                                                          ∂S2 (q, P )            ∂S2 (q, P )
                                                   pi =               ,   Qi =               ,   i = 1, . . . , n.                                                           (4.47)          --><a id="eq:coordgenfun2"></a><!--
                                                            ∂q i                   ∂Pi

-->

<p>

\begin{equation}
\label {eq:coordgenfun2} p_i = \frac {\partial S_2(q,P)}{\partial q^i},\quad Q^i = \frac {\partial S_2(q,P)}{\partial P_i},\quad i=1,\ldots ,n.
\end{equation}

</p>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-287"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">4.3</span></span>.                       Let \(Q=Q(q)\) be a change of coordinates on the base \(M\) of the cotangent bundle \(T^*M\). This
induces a transformation of the conjugate momenta \(p_i\mapsto P_i\) given by \(P_i = p_l \frac {\partial q^l}{\partial Q^i}\), and we already saw that \((q,p)\mapsto (Q,P)\) defines a canonical transformation. The generating function
of such transformation is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{47}\)</span>

<!--


                                                                                                                                  X
                                                                                                                                  n
                                                                                                                   S2 (q, P ) =         Pi Qi (q).                                                                                                (4.48)
                                                                                                                                  i=1


-->

<p>


\begin{equation}
S_2(q,P) = \sum _{i=1}^n P_i Q^i(q).
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>

<p>
In general, fixed a coordinate \(q\) we can choose one of \(2^n\) collections
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{48}\)</span>

<!--


                                                       Pi = (Pi1 , . . . , Pik ),   Qj = (Qj1 , . . . , Qjn−k ),                                           (4.49)                                               --><a id="eq:PQcollection"></a><!--

-->

<p>

\begin{equation}
\label {eq:PQcollection} P_{\vb *{i}} = (P_{i_1}, \ldots , P_{i_k}), \quad Q_{\vb *{j}} = (Q^{j_1}, \ldots , Q^{j_{n-k}}),
\end{equation}

</p>

<p>
where \((i_1, \ldots , i_k)\) and \((j_1, \ldots , j_{n-k})\) is a partition of \((1,\ldots ,n)\) in disjoint sets. These can be used to define a third common family of generating functions.
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-288"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.5</span></span>.                                              Let \(\Phi :T^*M \to T^* M\) be the canonical transformation defined by the functions \(P(q,p)\) and
\(Q(q,p)\). Then, in a neighborhood of a point \((q_0, p_0)\) it is possible to choose one of the \(2^n\) collections of functions \((q, Q^{\vb * j}, P_{\vb * i})\) from <span class="textup">(<a
href="chapter-4.html#eq:PQcollection">4.49</a>)</span> as independent coordinates, i.e., such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{49}\)</span>

<!--

                                                                                          
                                                                          ∂(q, Qj , Pi )
                                                              det                              6= 0.                                                                                (4.50)                                        --><a id="eq:choiceofcoordsS3"></a><!--
                                                                            ∂(q, p)

-->

<p>


\begin{equation}
\label {eq:choiceofcoordsS3} \det \left (\frac {\partial (q, Q^{\vb * j}, P_{\vb * i})}{\partial (q,p)}\right ) \neq 0.
\end{equation}


</p>

<p>
The canonical transformation can then be recovered from
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{50}\)</span>

<!--


                                                                                                                                     X
                                                                                                                                     k                  X
                                                                                                                                                        n−k                X
                                                                                                                                                                           n
                                                                                                               dS3 (q, Qj , Pi ) =         Qil dPil −         Pjh dQjh +         pi dq i                                                                                 (4.51)
                                                                                                                                     l=1                h=1                i=1


-->

<p>


\begin{equation}
\dd S_3(q, Q^{\vb * j}, P_{\vb * i}) = \sum _{l=1}^k Q^{i_l} \dd P_{i_l} -\sum _{h=1}^{n-k} P_{j_h} \dd Q^{j_h} + \sum _{i=1}^n p_i \dd q^i
\end{equation}


</p>

<p>
via the relations
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{51}\)</span>

<!--


                                                             ∂S3                   ∂S3                     ∂S3
                                                      pi =        ,       Q il =        ,      P jh = −        ,                                                                           (4.52)                                      --><a id="eq:coordgenfun3"></a><!--
                                                             ∂q i                  ∂Pil                   ∂Qjh

-->

<p>


\begin{equation}
\label {eq:coordgenfun3} p_i = \frac {\partial S_3}{\partial q^i}, \quad Q^{i_l} = \frac {\partial S_3}{\partial P_{i_l}}, \quad P_{j_h} = -\frac {\partial S_3}{\partial Q^{j_h}},
\end{equation}


</p>

<p>
where the indices run over the expected ranges \(i=1,\ldots ,n\), \(l=1,\ldots ,k\) and \(h = 1,\ldots ,n-k\).
</p>

<p>
Conversely, if \(S_3(q, Q^{\vb * j}, P_{\vb * i})\) is a transformation such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{52}\)</span>

<!--

                                                                                                                                               
                                                                                                                                         ∂ 2 S3
                                                                                                                              det                 ,   pe = (Qj , Pi ),                                                                                                   (4.53)
                                                                                                                                         ∂q∂ pe

-->

<p>


\begin{equation}
\det \left (\frac {\partial ^2 S_3}{\partial q \partial \widetilde p}\right ), \quad \widetilde p = (Q^{\vb * j}, P_{\vb * i}),
\end{equation}


</p>

<p>
then <span class="textup">(<a href="chapter-4.html#eq:coordgenfun3">4.52</a>)</span> define a canonical transformation around a point \((q_0, p_0)\).
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-289"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> The proof is practically identical to the one of Theorem&nbsp;<a href="chapter-4.html#thm:S1">4.4</a>, provided that we show the existence of a choice of coordinates satisfying <span
class="textup">(<a href="chapter-4.html#eq:choiceofcoordsS3">4.50</a>)</span>. This is however always possible since \(x=(q,p) \mapsto \Psi (x) = (Q,P)\) and its inverse are non–degenerate and therefore the corresponding \(2n\times
n\) matrix
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{53}\)</span>

<!--

                                                                                                                             
                                                                                                                    ∂Q ∂P
                                                                                                                       ,                                                                                                             (4.54)
                                                                                                                    ∂pk ∂pk

-->

<p>


\begin{equation}
\left (\frac {\partial Q}{\partial p_k}, \frac {\partial P}{\partial p_k}\right )
\end{equation}


</p>

<p>
has maximal rank. <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-290"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">4.4</span></span>.            Sometimes, in the literature you can find a different classification in the following terms:
</p>
<ul style="list-style-type:none">


<li>
<p>
1. \(S_1(q,Q) = S(q,p(q,Q))\), which depends only on the old and new generalized coordinates;
</p>


</li>
<li>


<p>
2. \(S_2(q,P) = - Q^i(q,P) P_i + S(q,p(q,P))\), which depends only on the old generalized coordinates and the new generalized momenta;
</p>


</li>
<li>


<p>
3. \(S_3(p,Q) = q^i(p,Q) p_i + S(q(p,Q),p)\), which depends only on the old generalized momenta and the new generalized coordinates;
</p>


</li>
<li>


<p>
4. \(S_4(p,P) = q^i(p,P) p_i - Q^i(p,P) P_i + S(q(p,P),p)\), which depends only on the old and new generalized momenta.
</p>
</li>
</ul>

<p>
Of course, as we also have shown, mixtures of these four types can exist.
</p>

</li>

</ul>

</div>
<!--................................-->
<h5 id="autosec-291"><span class="sectionnumber">4.2.3&#x2003;</span>Infinitesimal canonical transformations</h5>
<a id="hm-autopage-291"></a>


<p>
There is one more important family of transformations, that extends the \(S_2\) mentioned above and will allow us to discuss infinitesimal canonical transformations.
</p>

<p>
Suppose that we have a family of transformations depending on a parameter \(\epsilon \) and reducing to the identity for \(\epsilon = 0\), i.e., for \(\epsilon \in (-\epsilon _0, \epsilon _0)\),
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{54}\)</span>

<!--


                                                     Pi = pi + ϵhi (q, p; ϵ)   and   Qi = q i + ϵg i (q, p; ϵ),                                            (4.55)                                    --><a id="eq:infcantraf"></a><!--

-->

<p>

\begin{equation}
\label {eq:infcantraf} P_i = p_i + \epsilon h_i(q,p;\epsilon ) \quad \mbox {and}\quad Q^i = q^i + \epsilon g^i(q,p; \epsilon ),
\end{equation}

</p>

<p>
where \(h_i\) and \(g^i\) are smooth functions in some \(U\subset T^*M\) open and \(\epsilon _0 \ll 1\) is small enough so that the transformation is non–degenerate.
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-292"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.6</span></span>.          Every canonical transformation which is close to the identity admits a generating function of the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{55}\)</span>

<!--



                                                                  S2 (q, P ; ϵ) = q i Pi + ϵψ(q, P, ϵ),                                                (4.56)                                                 --><a id="eq:infS2"></a><!--

-->

<p>


\begin{equation}
\label {eq:infS2} S_2(q, P; \epsilon ) = q^i P_i + \epsilon \psi (q,P,\epsilon ),
\end{equation}


</p>

<p>
where \(\psi \) is a smooth function in the open \(U\times (-\epsilon _0,\epsilon _0)\).
</p>

</li>

</ul>

</div>

<p>
The proof follows along the lines of Theorem&nbsp;<a href="chapter-4.html#thm:S1">4.4</a> and will be omitted.
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
The change of coordinates <span class="textup">(<a href="chapter-4.html#eq:infcantraf">4.55</a>)</span> is an <em>infinitesimal canonical transformation</em> if
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{56}\)</span>

<!--

                                                                                       
                                                  Qi , Pj = δji + O(ϵ2 ),       Qi , Qj = Pi , Pj = O(ϵ2 ).                                   (4.57)                                                 --><a id="eq:definfcantraf"></a><!--

-->

<p>

\begin{equation}
\label {eq:definfcantraf} \big \{Q^i, P_j\big \} = \delta _j^i + O(\epsilon ^2), \quad \big \{Q^i, Q^j\big \} = \big \{P_i, P_j\big \} = O(\epsilon ^2).
\end{equation}

</p>

</div>

</div>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-293"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.7</span></span>.                           The change of coordinates <span class="textup">(<a
href="chapter-4.html#eq:infcantraf">4.55</a>)</span> is an infinitesimal canonical transformation if and only if there exists a function \(K=K(q,p)\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{57}\)</span>

<!--


                                                                                                            ∂K(q, p)                       ∂K(q, p)
                                                                                         hi (q, p, 0) = −            ,   g i (q, p, 0) =            ,   i = 1, . . . , n.                                                               (4.58)
                                                                                                              ∂q i                           ∂pi

-->

<p>


\begin{equation}
h_i(q,p,0) = -\frac {\partial K(q,p)}{\partial q^i}, \quad g^i(q,p,0) = \frac {\partial K(q,p)}{\partial p_i}, \quad i=1,\ldots ,n.
\end{equation}


</p>

<p>
In this case, we say that \(K\) is the hamiltonian associated to the infinitesimal canonical transformation. Moreover, \(K(q,p) = \psi (q,p,0)\) where \(\psi (q,p,\epsilon )\) is the function appearing in <span class="textup">(<a
href="chapter-4.html#eq:infS2">4.56</a>)</span>.
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-294"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> It is enough to use <span class="textup">(<a href="chapter-4.html#eq:infcantraf">4.55</a>)</span> in the Poisson bracket <span class="textup">(<a
href="chapter-4.html#eq:definfcantraf">4.57</a>)</span>. Comparing the terms of order \(\epsilon \) one gets the following conditions:
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{58}\)</span>



<!--



                                                                                                                       ∂hi (q, p, 0)   ∂g j (q, p, 0)
                                                                                                                                     +                = 0,                                                                                      (4.59)
                                                                                                                           ∂pj              ∂q i
                                                                                                                       ∂hi (q, p, 0)   ∂hj (q, p, 0)
                                                                                                                                     −                = 0,                                                                                      (4.60)
                                                                                                                           ∂pj              ∂pi
                                                                                                                       ∂g j (q, p, 0)   ∂g i (q, p, 0)
                                                                                                                                      −                = 0.                                                                                     (4.61)
                                                                                                                            ∂q i             ∂q j



-->



<p>


\begin{align}
&amp; \frac {\partial h_i(q,p,0)}{\partial p_j} + \frac {\partial g^j(q,p,0)}{\partial q^i} = 0, \\ &amp; \frac {\partial h_i(q,p,0)}{\partial p_j} - \frac {\partial h_j(q,p,0)}{\partial p_i} = 0, \\ &amp; \frac
{\partial g^j(q,p,0)}{\partial q^i} - \frac {\partial g^i(q,p,0)}{\partial q^j} = 0.
\end{align}
These equations, which should remind you of certain Poisson bracket terms, are exactly satisfied if in the open subset \(U\) there is a function \(K(q,p)\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{61}\)</span>

<!--


                                                                                                                       ∂K(q, p)                                ∂K(q, p)
                                                                                                     g i (q, p, 0) =                 and    hi (q, p, 0) = −            ,                                                                       (4.62)
                                                                                                                         ∂pi                                     ∂q i

-->

<p>


\begin{equation}
g^i(q,p,0) = \frac {\partial K(q,p)}{\partial p_i} \quad \mbox {and}\quad h_i(q,p,0) = -\frac {\partial K(q,p)}{\partial q^i},
\end{equation}


</p>

<p>
where \(i=1,\ldots ,n\). Using <span class="textup">(<a href="chapter-4.html#eq:coordgenfun2">4.47</a>)</span> and <span class="textup">(<a href="chapter-4.html#eq:definfcantraf">4.57</a>)</span>, we observe that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{62}\)</span>

<!--


                                                                                                              ∂ψ(q, p, 0)                                ∂ψ(q, p, 0)
                                                                                               Qi = q i + ϵ               + O(ϵ2 ),        Pi = pi − ϵ               + O(ϵ2 ),                                                                  (4.63)
                                                                                                                 ∂pi                                        ∂q i

-->

<p>


\begin{equation}
Q^i = q^i + \epsilon \frac {\partial \psi (q,p,0)}{\partial p_i} + O(\epsilon ^2),\quad P_i = p_i - \epsilon \frac {\partial \psi (q,p,0)}{\partial q^i} + O(\epsilon ^2),
\end{equation}


</p>

<p>
and therefore \(K(q,p) = \psi (q,p,0)\). <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
From the expressions above, we can conclude that an infinitesimal transformation can be written as
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{63}\)</span>

<!--

                                                                                                      
                                                                   Qi = q i + ϵ q i , K ,   Pi = pi + ϵ pi , K .                                                                 (4.64)                          --><a id="eq:forminfct"></a><!--

-->

<p>

\begin{equation}
\label {eq:forminfct} Q^i = q^i + \epsilon \big \{q^i, K\big \}, \quad P_i = p_i + \epsilon \big \{p_i, K\big \}.
\end{equation}

</p>

<p>
Up until now, we’ve been thinking of canonical transformations in a passive sense, with \((Q,P)\) labelling the same point in phase space as \((q, p)\), but in different coordinates. A one–parameter family \(\Phi _\alpha \) of canonical
transformations, however, could be interpreted in another, more dynamic, way: nothing prevents a transformations to take us from one point \((q,p)=(Q(0), P(0))\) in phase space to a different point
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{64}\)</span>

<!--


                                                                                                               (Q(α), P (α)) = (Q(q, p, α), P (q, p, α)).                                                                                       (4.65)

-->

<p>

\begin{equation}
(Q(\alpha ),P(\alpha )) = (Q(q,p,\alpha ), P(q,p,\alpha )).
\end{equation}

</p>

<p>
in the <em>same</em> phase space. In this active interpretation, as we vary the parameter \(\alpha \) we follow curves in phase space... we might as well relabel \(\alpha \) into \(t\) and see what happens. This is, in some sense, what we are
going to do in the next chapter.
</p>
<!--................................-->
<h5 id="autosec-295"><span class="sectionnumber">4.2.4&#x2003;</span>Time-dependent hamiltonian systems</h5>
<a id="hm-autopage-295"></a>


<p>
<span
    class="textcolor"
    style="color:#FF0000"
>TODO: correct and rewrite</span> To discuss canonical transformations for time-dependent hamiltonian systems, we consider again the extended phase space \(T^*M\times \mathbb {R}^2\) with the coordinates \((q^1,\ldots ,q^n,p_1,\ldots
,p_n, q^{n+1}=t, p_{n+1}=E)\) introduced in Section&nbsp;<a href="chapter-3.html#sec:timedepH">3.4.2</a> and symplectic form \(\widetilde \omega = \dd p_i\wedge \dd q^i - \dd E\wedge \dd t\) discussed in Example&nbsp;<a
href="chapter-3.html#ex:timedepH">3.13</a>.
</p>

<p>
In terms of the tautological one–form, we have
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{65}\)</span>

<!--


                                                                                                              e = de
                                                                                                              ω    η,   ηe = pi dq i − E dt .                                                                                       (4.66)

-->

<p>

\begin{equation}
\widetilde {\omega } = \dd {\widetilde {\eta }}, \quad \widetilde {\eta } = p_i \dd {q^i} - E \dd {t}.
\end{equation}

</p>

<p>
A transformation \(\widetilde \Phi : T^*M\times \mathbb {R}^2 \to T^*M\times \mathbb {R}^2\) that associates \((q,p,t,E)\) to \((Q,P,T,\widetilde E)\) is canonical if it preserves the symplectic form, that is, if \({\widetilde \Phi
}^* \widetilde \omega = \widetilde \omega \). Exactly as in the time-independent case, one can show that there exists a function \(S(q,p,t,E)\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{66}\)</span>

<!--


                                                                                      e
                                                             pi dq i − Edt − Pi dQi + EdT = dS(q, p, E, t).                                                         (4.67)                            --><a id="eq:timedepgen"></a><!--

-->

<p>

\begin{equation}
\label {eq:timedepgen} p_i \dd q^i -E \dd t - P_i \dd Q^i + \widetilde E \dd T = \dd S(q,p,E,t).
\end{equation}

</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-296"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.8</span></span>.                   <a id="thm:Ham0"></a> Let \((q,p,t,E) \to (Q,P,T,\widetilde E)\) be a canonical transformation in
\(T^*M\times \mathbb {R}^2\). If
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{67}\)</span>

<!--



                                                                                             Qi = Qi (q, p, t),   Pi = Pi (q, p, t),   i = 1, . . . , n,                                                                                   (4.68)

-->

<p>


\begin{equation}
Q^i = Q^i(q,p,t), \quad P_i = P_i(q,p,t), \quad i=1,\ldots ,n,
\end{equation}


</p>

<p>
and either \(T\) is constant or \(\dd T = \dd t\), then \(\frac {\partial S}{\partial E} = 0\).
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-297"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> It is enough to expand the differential in \(Q\) in <span class="textup">(<a href="chapter-4.html#eq:timedepgen">4.67</a>)</span> to observe that
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{68}\)</span>



<!--


                                                                                                                                                         
                                                                                                                             ∂Qi j ∂Qi              ∂Qi      e
                                                                                                         pi dq − Edt − Pi
                                                                                                               i
                                                                                                                                   dq +       dpj +     dt + EdT                                                                (4.69)
                                                                                                                              ∂q j        ∂pj        ∂t
                                                                                                             ∂S i      ∂S          ∂S      ∂S
                                                                                                          =       dq +     dpi +      dt +     dE.                                                                              (4.70)
                                                                                                             ∂q i      ∂pi         ∂t      ∂E



-->



<p>


\begin{align}
&amp; p_i \dd q^i -E \dd t - P_i \left ( \frac {\partial Q^i}{\partial q^j}\dd q^j +\frac {\partial Q^i}{\partial p_j}\dd p_j +\frac {\partial Q^i}{\partial t}\dd t \right ) + \widetilde E \dd T \\ &amp; = \frac
{\partial S}{\partial q^i}\dd q^i +\frac {\partial S}{\partial p_i}\dd p_i +\frac {\partial S}{\partial t}\dd t +\frac {\partial S}{\partial E}\dd E.
\end{align}
Comparing the corresponding elements one proves the claim. <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
If we choose as independent variables \((q,Q,t)\), we get
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{70}\)</span>

<!--


                                                                                                                                            e
                                                                                                                   pi dq i − Edt − Pi dQi + EdT = dS(q, Q, t),                                                                  (4.71)

-->

<p>

\begin{equation}
p_i \dd q^i - E \dd t -P_i \dd Q^i + \widetilde E\dd T = \dd S(q,Q,t),
\end{equation}

</p>

<p>
which, using the fact that \(\dd T = \dd t\), is equivalent to
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{71}\)</span>

<!--

                                                             ∂S                ∂S      e − E = ∂S .
                                                      pi =        ,   Pi = −       ,   E                                                                           (4.72)                           --><a id="eq:motionpPEtE"></a><!--
                                                             ∂q i              ∂Qi             ∂t

-->

<p>

\begin{equation}
\label {eq:motionpPEtE} p_i = \frac {\partial S}{\partial q^i}, \quad P_i = - \frac {\partial S}{\partial Q^i}, \quad \widetilde E - E = \frac {\partial S}{\partial t}.
\end{equation}

</p>

<p>
The last equation is usually written as a time reparametrization of hamiltonians:
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{72}\)</span>

<!--

                                                                                               ∂S(q, Q, t)
                                            K(Q, P (q, Q, t), T (t)) = H(q, p(q, Q, t), t) +               .                                                  (4.73)                            --><a id="eq:time-reparamqQt"></a><!--
                                                                                                  ∂t
-->

<p>

\begin{equation}
\label {eq:time-reparamqQt} K(Q, P(q,Q,t), T(t)) = H(q,p(q,Q,t),t) + \frac {\partial S(q,Q,t)}{\partial t}.
\end{equation}

</p>

<p>
In the same way, if we choose as independent variables \((q,P,t)\), we get
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{73}\)</span>


<!--


                                                                                                                   ∂S              ∂S
                                                                                                          pi =          ,   Qi =       ,                                                                                        (4.74)
                                                                                                                   ∂q i            ∂Pi
                                                                                                                                                            ∂S(q, P, t)
                                                                                                          K(Q(q, P, t), P, T (t)) = H(q, p(q, P, t), t) +       (4.75).                         --><a id="eq:time-reparamqPt"></a><!--
                                                                                                                                                               ∂t


-->


<p>

\begin{align}
&amp; p_i = \frac {\partial S}{\partial q^i}, \quad Q^i = \frac {\partial S}{\partial P_i}, \\ &amp; K(Q(q,P,t), P, T(t)) = H(q, p(q,P,t),t) + \frac {\partial S(q,P,t)}{\partial t}.\label {eq:time-reparamqPt}
\end{align}

</p>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-298"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">4.4</span></span>.                          Let \(H(q,p) = \frac {p^2}{2} + \alpha q\). Consider a time-dependent canonical
transformation \(\Phi _t\) generated by \(H\): let \(q(0) = Q\) and \(p(0) = P\) and
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{75}\)</span>

<!--


                                                                                             1 2
                                                         p(t) = P − αt,   q(t) = Q + P t −     αt .                                                         (4.76)                                                 --><a id="eq:unifaccm"></a><!--
                                                                                             2

-->

<p>


\begin{equation}
\label {eq:unifaccm} p(t) = P - \alpha t, \quad q(t) = Q + Pt - \frac {1}{2}\alpha t^2.
\end{equation}


</p>

<p>
How are these equations related to each other? Do they ring any bell?
</p>

<p>
We can compute the generating function for \(\Phi _t\) with a trick. Writing the change of coordinates in the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{76}\)</span>

<!--


                                                                                                                q−Q  1                  q−Q  1
                                                                                                           p=       − αt,         P =       + αt,                                                                                           (4.77)
                                                                                                                 t   2                   t   2

-->

<p>


\begin{equation}
p = \frac {q-Q}{t}-\frac 12\alpha t, \quad P = \frac {q-Q}{t} + \frac 12\alpha t,
\end{equation}


</p>

<p>
we see that \(S(q,Q,t)\) has to satisfy
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{77}\)</span>



<!--



                                                                                                                 ∂S(q, Q, t)   q−Q    1
                                                                                                              p=             =       − αt,                                                                                                  (4.78)
                                                                                                                    ∂q           t    2
                                                                                                                   ∂S(q, Q, t)   q−Q    1
                                                                                                              P =−             =      + αt.                                                                                                 (4.79)
                                                                                                                       ∂Q          t    2



-->



<p>


\begin{align}
&amp; p = \frac {\partial S(q,Q,t)}{\partial q} = \frac {q-Q}{t} - \frac 12\alpha t, \\ &amp; P = - \frac {\partial S(q,Q,t)}{\partial Q} = \frac {q-Q}{t} + \frac 12\alpha t.
\end{align}
These can be integrated to find
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{79}\)</span>

<!--


                                                                                                                        (q − Q)2  1
                                                                                                         S(q, Q, t) =            − α(q + Q)t + f (t),                                                                                       (4.80)
                                                                                                                           2t     2

-->

<p>


\begin{equation}
S(q,Q,t) = \frac {(q-Q)^2}{2t} - \frac 12 \alpha (q+Q) t + f(t),
\end{equation}


</p>

<p>
where \(f\) is arbitrary and does only depend on time.
</p>

<p>
The new hamiltonian \(K(q,Q,t)\) is then computed as follows
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{80}\)</span>



<!--



                                                                                                      K(q, Q, t) = K(Q, P (q, Q, t), T (t))                                                                                                 (4.81)
                                                                                                                                    ∂S(q, Q, t)
                                                                                                                 = H(q, p(q, Q, t)) +                                                                                                       (4.82)
                                                                                                                                        ∂t
                                                                                                                   (q − Q)2    1 2 2 1
                                                                                                                 =          + α t − α(q − Q) + αq                                                                                           (4.83)
                                                                                                                      2t2      2       2
                                                                                                                     (q − Q)2    1
                                                                                                                   −           − α(q + Q) + f ′ (t)                                                                                         (4.84)
                                                                                                                        2t2      2
                                                                                                                   1 2 2     ′
                                                                                                                 = α t + f (t).                                                                                                             (4.85)
                                                                                                                   8



-->



<p>


\begin{align}
K(q,Q,t) &amp; = K(Q, P(q,Q,t), T(t)) \\ &amp; = H(q, p(q,Q,t)) + \frac {\partial S (q,Q,t)}{\partial t} \\ &amp; = \frac {(q-Q)^2}{2t^2} + \frac 12 \alpha ^2 t^2 - \frac 12 \alpha (q-Q) + \alpha q \\ &amp; \quad -
\frac {(q-Q)^2}{2t^2} - \frac 12 \alpha (q+Q) + f&apos;(t) \\ &amp; = \frac {1}{8}\alpha ^2t^2 + f&apos;(t).
\end{align}
Since \(f\) does not affect Hamilton’s equation for the new hamiltonian \(K\), we can use it to our advantage: choosing \(f&apos;(t) = - \frac {1}{8}\alpha ^2t^2\) the hamiltonian vanishes identically, \(K\equiv 0\).
</p>

<p>
As a side remark, observe that the same result can be obtained also by directly checking that \(\dot P = \dot Q = 0\).
</p>

</li>

</ul>

</div>

<p>
Equations <span class="textup">(<a href="chapter-4.html#eq:unifaccm">4.76</a>)</span> represent the motion in phase space of a point particle in uniformly accelerated linear motion, which is, in fact, the solution of the hamiltonian system
of the example. In other words, the one–parameter group of canonical transformation in the previous example is the hamiltonian flow itself!
</p>

<p>
The example above is a particular instance of the following more general fact.
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-299"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.9</span></span>.   The hamiltonian flow is a canonical transformation.
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-300"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> Let \(H = H(q,p,t)\) be a hamiltonian transformation and \(\phi (t) = (q(t), p(t))\) its associated hamiltonian flow. As in the previous example, let \((Q, P) = \phi (0) = (q(0), p(0))\)
be the variables at \(t=0\) and \((q, p) = (q(Q,P,t), p(Q,P,t))\) the ones at time \(t\). Define the function
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{85}\)</span>

<!--

                                                                                                      Z t                                                                
                                                                                                                             ∂q j (Q, P, s)
                                                                                       S(Q, P, t) =           pj (Q, P, s)                  − H(q(Q, P, s), p(Q, P, s), s) ds.                                                    (4.86)
                                                                                                       0                           ∂s

-->

<p>


\begin{equation}
S(Q,P,t) = \int _0^t\left ( p_j(Q,P,s)\frac {\partial q^j(Q,P,s)}{\partial s} - H(q(Q,P,s), p(Q,P,s), s) \right )\dd s.
\end{equation}


</p>

<p>
We can directly verify that such \(S\) is the generating function of the canonical transformation. Indeed, we have
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{86}\)</span>



<!--



                                                                                                      ∂S                  ∂q j
                                                                                                         i
                                                                                                           = pj (Q, P, t)      − Pi                                                                                               (4.87)
                                                                                                      ∂Q                  ∂Qi
                                                                                                      ∂S                  ∂q j
                                                                                                          = pj (Q, P, t)                                                                                                          (4.88)
                                                                                                      ∂Pi                 ∂P i
                                                                                                      ∂S                 ∂q j
                                                                                                          = pj (Q, P, t)       − H(q(Q, P, t), p(Q, P, t), t),                                                                    (4.89)
                                                                                                      ∂t                 ∂t



-->



<p>


\begin{align}
&amp; \frac {\partial S}{\partial Q^i} = p_j(Q,P,t) \frac {\partial q^j}{\partial Q^i} - P_i \\ &amp; \frac {\partial S}{\partial P_i} = p_j(Q,P,t) \frac {\partial q^j}{\partial P^i} \\ &amp; \frac {\partial
S}{\partial t} = p_j(Q,P,t) \frac {\partial q^j}{\partial t} - H(q(Q,P,t), p(Q,P,t), t),
\end{align}
which imply
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{89}\)</span>



<!--



                                                                                                           dS(Q, P, t) = pi (Q, P, t)dq i (Q, P, t) − Pi dQi                                                                      (4.90)
                                                                                                                             − H(q(Q, P, t), p(Q, P, t), t)dt,                                                                    (4.91)



-->



<p>


\begin{align}
\dd S(Q, P, t) &amp; = p_i(Q, P, t) \dd q^i (Q, P, t) - P_i \dd Q^i \\ &amp; \quad - H(q(Q,P,t), p(Q,P,t), t) \dd t,
\end{align}
or, more compactly,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{91}\)</span>

<!--



                                                                                                                    dS = pi dq i − Pi dQi − Hdt.                                                                                  (4.92)

-->

<p>


\begin{equation}
\dd S = p_i \dd q^i - P_i \dd Q^i - H \dd t.
\end{equation}


</p>

<p>
Therefore, the reparametrized hamiltonian is \(K\equiv 0\). <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-301"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">4.5</span></span>.         <a id="rmk:genfnhamflowct"></a> Choosing \((q,Q,t)\) as independent variables in the proof
above one gets
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{92}\)</span>

<!--


                                                                                                                      ∂S(q, Q, t)
                                                                                              H(q, p(q, Q, t), t) =               .                                                                                            (4.93)
                                                                                                                         ∂t

-->

<p>


\begin{equation}
H(q, p(q,Q,t), t) = \frac {\partial S(q,Q,t)}{\partial t}.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<!--................................-->
<h4 id="autosec-302"><span class="sectionnumber">4.3&#x2003;</span>Hamilton-Jacobi equations</h4>
<a id="hm-autopage-302"></a>


<p>
In the previous chapter, we saw that the problem of integrating the equations of motion of a hamiltonian system with hamiltonian \(H(q,p,t)\), can be reduced to finding a one–parameter group of canonical transformations \(\Phi _t\) from the
variables \((q,p)\) into the variables \((Q(q,p,t), P(q,p,t), t)\) such that the new Hamiltonian \(K(Q,P,t) \equiv 0\).
</p>

<p>
Indeed, the equations for \(Q\) and \(P\) are immediately integrated as
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{93}\)</span>

<!--


                                                                                                                                    Qi = ai ,        P i = bi ,      i = 1, . . . , n,                                                                                  (4.94)

-->

<p>

\begin{equation}
Q^i = a^i, \quad P_i = b_i, \quad i = 1,\ldots ,n,
\end{equation}

</p>

<p>
where \((a,b)\in \mathbb {R}^{n}\times \mathbb {R}^n\) are arbitrary constants related to the initial conditions \((q(0), p(0))\). Then, if \(S = S(q,P,t)\) denotes the generating function of \(\Phi _t\), the condition \(P_i=b_i\) and
<span class="textup">(<a href="chapter-4.html#eq:time-reparamqQt">4.73</a>)</span> imply that \(S\) satisfies the <em>Hamilton-Jacobi equation</em>:
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{94}\)</span>

<!--

                                                                                       
                                                                          ∂S(q, b, t)      ∂S(q, b, t)
                                                             H       q,               ,t +             = 0.                                                                                                (4.95)                      --><a id="eq:Hamilton-Jacobi"></a><!--
                                                                             ∂q               ∂t

-->

<p>

\begin{equation}
\label {eq:Hamilton-Jacobi} H\left (q, \frac {\partial S(q,b,t)}{\partial q}, t\right ) + \frac {\partial S(q,b,t)}{\partial t} = 0.
\end{equation}

</p>

<p>
Once we know \(S\), equation <span class="textup">(<a href="chapter-4.html#eq:time-reparamqPt">4.75</a>)</span> implies
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{95}\)</span>

<!--

                                                                                                                                               ∂S(q, b, t)
                                                                                                                                        ai =               ,       i = 1, . . . , n,                                                                                    (4.96)
                                                                                                                                                 ∂bi

-->

<p>

\begin{equation}
a^i = \frac {\partial S(q,b,t)}{\partial b_i}, \quad i =1,\ldots ,n,
\end{equation}

</p>

<p>
which, for non–degenerate \(S\), can be inverted to find \(q^i = q^i(a,b,t)\). The conjugate momenta are then immediately obtained by
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{96}\)</span>

<!--

                                                                                                                                               ∂S(q, b, t)
                                                                                                                                        pi =               ,       i = 1, . . . , n,                                                                                    (4.97)
                                                                                                                                                 ∂q i

-->

<p>

\begin{equation}
p_i = \frac {\partial S(q,b,t)}{\partial q^i}, \quad i =1,\ldots ,n,
\end{equation}

</p>

<p>
which confirms that integrating the equations of motion can be reduced to determining \(S(q,b,t)\).
</p>

<p>
If the hamiltonian \(H\) does not depend on the time, we have \(H=E=\mathrm {const}\) and, therefore, we can write \(S\) in the simpler form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{97}\)</span>

<!--


                                                                                                                                          S(q, b, t) = S0 (q, b) − Et,                                                                                                  (4.98)

-->

<p>

\begin{equation}
S(q,b,t) = S_0(q,b) - E t,
\end{equation}

</p>

<p>
which gives the Hamilton-Jacobi equation
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{98}\)</span>

<!--

                                                                                                       
                                                                                           ∂S0 (q, b)
                                                                                H       q,                  = E.                                                                                                    (4.99)                    --><a id="eq:HJnotime"></a><!--
                                                                                             ∂q

-->

<p>

\begin{equation}
\label {eq:HJnotime} H\left (q, \frac {\partial S_0(q,b)}{\partial q}\right ) = E.
\end{equation}

</p>

<p>
The equations of motion can then be integrated as we did before.
</p>

<p>
We can give an interpretation of <span class="textup">(<a href="chapter-4.html#eq:HJnotime">4.99</a>)</span> in the following way. Assume that the coordinate transformation generated by \(S_0(q,b)\) maps \(H(q,p)\) to the new
hamiltonian \(K(Q,P)=P_n\). In this case, the energy \(E\) would simply be the constant \(b_n\) and the integration of the equations of motion in the \((Q,P)\) coordinates would be
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{99}\)</span>


<!--



                                                                                                                                 Pi (t) = Pi (0) = bi ,            i = 1, . . . , n,                                                                                   (4.100)
                                                                                                                                    i            i
                                                                                                                                Q (t) = Q (0) = a ,        i
                                                                                                                                                                   i = 1, . . . , n − 1,                                                                               (4.101)
                                                                                                                                Qn (t) = t − t0 .                                                                                                                      (4.102)



-->


<p>

\begin{align}
P_i(t) &amp; = P_i(0) = b_i, \quad i=1,\ldots ,n, \\ Q^i(t) &amp; = Q^i(0) = a^i, \quad i=1,\ldots ,n-1, \\ Q^n(t) &amp; = t- t_0.
\end{align}
Then, we obtain the variables \((q,p)\) from \(S_0(q,b)\) using the relation
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{102}\)</span>


<!--


                                                                                                                                          ∂S0 (q, b)
                                                                                                                                        ai =         ,             i = 1, . . . , n − 1,                                                                               (4.103)
                                                                                                                                            ∂bi
                                                                                                                                          ∂S0 (q, b)
                                                                                                                                 t − t0 =            .                                                                                                                 (4.104)
                                                                                                                                            ∂bn


-->


<p>

\begin{align}
a^i &amp; = \frac {\partial S_0(q,b)}{\partial b_i}, \quad i=1,\ldots ,n-1, \\ t-t_0 &amp; = \frac {\partial S_0(q,b)}{\partial b_n}.
\end{align}
Under suitable assumptions on \(S_0\), these can be solved to get \(q^i = q^i(a,b,t)\). With \(q\) out of the way, we can then get the conjugate momenta from \(p_i = \frac {\partial S_0(q,b)}{\partial q^i}\).
</p>

<p>
The <em>Jacobi method</em> generalizes the approach above by assuming that the coordinate transformation generated by \(S_0(q,b)\) maps \(H(q,p)\) to \(K = K(P)\), i.e., the coordinates \(Q\) are cyclic. The integration of the motion in the
coordinates \((Q,P)\), then, becomes
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{104}\)</span>

<!--

                                                                                                               ∂K(P )
                                                        Pi = b i ,        Q i = k i t + ai ,    k i = Q̇i =           ,      i = 1, . . . , n.                                                                               (4.105)           --><a id="eq:JacobiM"></a><!--
                                                                                                                ∂Pi

-->

<p>

\begin{equation}
\label {eq:JacobiM} P_i = b_i, \quad Q^i = k^i t + a^i, \quad k^i = \dot Q^i = \frac {\partial K(P)}{\partial P_i}, \quad i = 1,\ldots ,n.
\end{equation}

</p>

<p>
In this case, the energy is \(E = K(P) = K(b)\), and the integrated equations of motion for \(H\) have the form
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{105}\)</span>


<!--



                                                                                                                   q i = q i (k1 t + a1 , . . . , k n t + an , b1 , . . . , bn ),      i = 1, . . . , n,                                                               (4.106)
                                                                                                                                1        1           n         n
                                                                                                                   pi = pi (k t + a , . . . , k t + a , b1 , . . . , bn ),             i = 1, . . . , n.                                                               (4.107)



-->


<p>

\begin{align}
q^i &amp; = q^i(k^1 t + a^1, \ldots , k^n t + a^n, b_1, \ldots , b_n), \quad i=1,\ldots ,n, \\ p_i &amp; = p_i(k^1 t + a^1, \ldots , k^n t + a^n, b_1, \ldots , b_n), \quad i=1,\ldots ,n.
\end{align}

</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
We say that the Hamilton-Jacobi equation <span class="textup">(<a href="chapter-4.html#eq:HJnotime">4.99</a>)</span> admits a <em>complete integral</em> if the function \(S\) which solves it depends on \(n\) constants.
</p>
</div>

</div>

<p>
The process described above, once developed in all its details, leads to the following theorem.
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-303"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.10</span></span>.                                Let \(H(q,p,t)\) be an hamiltonian function and \(S(q,b,t)\) be a complete integral of the Hamilton-Jacobi
equation <span class="textup">(<a href="chapter-4.html#eq:Hamilton-Jacobi">4.95</a>)</span> depending on \(n\) constants \(b=(b_1,\ldots ,b_n)\). If \(S\) satisfies the non–degeneracy condition
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{107}\)</span>

<!--

                                                                                                                                        
                                                                                                                               ∂2S
                                                                                                                    det                      6= 0,                                                                                                        (4.108)
                                                                                                                              ∂q i ∂bj

-->

<p>


\begin{equation}
\det \left (\frac {\partial ^2 S}{\partial q^i \partial b_j}\right ) \neq 0,
\end{equation}


</p>

<p>
then the determination of integral curves of Hamilton’s equations for \(H(q,p,t)\) only involves operations of inversion and substitution.
</p>

</li>

</ul>

</div>

<p>
Despite the fact that the integration of partial differential equations is usually more diﬀicult than solving ordinary equations, the Hamilton-Jacobi theory proved to be a powerful tool in the study of problems of optics, mechanics, geometry and
optimal control.
</p>

<p>
Furthermore, for a hamiltonian system with \(n\) degrees of freedom, we can combine Theorem&nbsp;<a href="chapter-4.html#thm:lsoform">4.3</a> and Remark&nbsp;<a href="chapter-4.html#rmk:nfils">4.1</a> to show the equivalence
between the existence of \(n\) first integrals in involution and the existence of a complete integral of the Hamilton-Jacobi equation. A result which is also known as Liouville theorem.
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-304"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.11</span></span><span class="amsthmnoteplain"> (Liouville theorem)</span>.   Let \(H(q,p)\) denote the hamiltonian of a
hamiltonian system with \(n\) degrees of freedom. Assume that there exist \(n\) first integral \(f_i\) of \(H\) which are in involution, i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{108}\)</span>

<!--


                                                                                                                
                                                                                                                    fi , fj = 0,     i, j = 1, . . . , n,                                                                (4.109)

-->

<p>


\begin{equation}
\big \{ f_i, f_j\big \} = 0, \quad i,j = 1,\ldots , n,
\end{equation}


</p>

<p>
such that the levelsets
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{109}\)</span>

<!--



                                                                                                                 fi (q, p) = ai ,        i = 1, . . . , n,                                                               (4.110)

-->

<p>


\begin{equation}
f_i(q,p) = a_i, \quad i=1,\ldots ,n,
\end{equation}


</p>

<p>
define a lagrangian submanifold \(\Lambda _a = f^{-1}(a)\).
</p>

<p>
If the following non–degeneracy condition is satisfied,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{110}\)</span>

<!--

                                                                                                                                        
                                                                                                                                   ∂fi
                                                                                                                         det                 6= 0,                                                                       (4.111)
                                                                                                                                   ∂pk

-->

<p>


\begin{equation}
\det \left (\frac {\partial f_i}{\partial p_k}\right )\neq 0,
\end{equation}


</p>

<p>
then there exists, locally, a function \(S=S(q,a)\) which is also a complete integral of the Hamilton-Jacobi equation.
</p>

</li>

</ul>

</div>
<!--................................-->
<h5 id="autosec-305"><span class="sectionnumber">4.3.1&#x2003;</span>Separable hamiltonians</h5>
<a id="hm-autopage-305"></a>


<a id="sec:sepsys"></a>

<p>
In many relevant cases, it is possible to find a complete integral of the Hamilton-Jacobi equation with the so-called <em>separation of variables</em>.
</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
A coordinate, which we will denote \(q^1\), is called <em>separable</em> if there exists a function \(W_1(q^1, b)\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{111}\)</span>

<!--


                                                                                                                   S(q, b) = S0 (q 2 , . . . , q n , b) + W1 (q 1 , b),                                       (4.112)

-->

<p>

\begin{equation}
S(q,b) = S_0(q^2, \ldots , q^n, b) + W_1(q^1, b),
\end{equation}

</p>

<p>
and the dependence of the hamiltonian \(H\) from \(q^1\) and \(W_1\) is of the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{112}\)</span>

<!--

                                                                                                                                                                             
                                                                                                              ∂S        e                           ∂S0            ∂W1 (q 1 , b)
                                                                                                 H       q,            =H       q2 , . . . , qn ,       , ψ1 q 1 ,                  ,                         (4.113)
                                                                                                              ∂q                                    ∂q               ∂q 1

-->

<p>

\begin{equation}
H\left (q,\frac {\partial S}{\partial q}\right ) = \widetilde H\left (q^2, \ldots , q^n , \frac {\partial S_0}{\partial q}, \psi _1\left (q^1, \frac {\partial W_1(q^1, b)}{\partial q^1}\right ) \right ),
\end{equation}

</p>

<p>
for some function \(\psi _1\left (q^1, \frac {\partial W_1(q^1, b)}{\partial q^1}\right )\) that does not contain other coordinates.
</p>
</div>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-306"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">4.5</span></span>.                                                        Cyclic coordinates are an immediate example of separable coordinates. Assume for example that
\(q^1\) is cyclic, then the conjugate momentum \(p_1 = b_1\) is constant. The generating function has the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{113}\)</span>

<!--



                                                                                                                     S(q, b) = S0 (q 2 , . . . , q n , b) + q 1 b1 ,                                                                                                            (4.114)

-->

<p>


\begin{equation}
S(q,b) = S_0(q^2, \ldots , q^n, b) + q^1 b_1,
\end{equation}


</p>

<p>
and the hamiltonian has the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{114}\)</span>

<!--


                                                                                                                                             ∂S0           ∂S0
                                                                                                                     H(q 2 , . . . , q n ,        , . . . , n , b1 ).                                                                                                           (4.115)
                                                                                                                                             ∂q 2          ∂q

-->

<p>


\begin{equation}
H(q^2, \ldots , q^n, \frac {\partial S_0}{\partial q^2}, \ldots , \frac {\partial S_0}{\partial q^n}, b_1).
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
A hamiltonian system is called <em>separable</em> if all its \(n\) coordinates are separable.
</p>
</div>

</div>

<p>
In this case, the function \(S\) becomes \(S(q,b) = \sum _{i=1}^n W_i(q^i, b)\) and the hamiltonian takes the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{115}\)</span>

<!--

                                                                                                                                                                                           
                                                                                                       ∂S        e                 1  ∂W1 (q 1 , b)                           n  ∂Wn (q n , b)
                                                                                           H        q,          =H       ψ1       q ,                     , . . . , ψn       q ,                      ,                                                                         (4.116)
                                                                                                       ∂q                               ∂q 1                                       ∂q n

-->

<p>

\begin{equation}
H\left (q,\frac {\partial S}{\partial q}\right ) = \widetilde H\left ( \psi _1\left (q^1, \frac {\partial W_1(q^1, b)}{\partial q^1}\right ), \ldots , \psi _n\left (q^n, \frac {\partial W_n(q^n, b)}{\partial
q^n}\right ) \right ),
\end{equation}

</p>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-307"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">4.6</span></span>.       A simple example of separable system is given by a sum of hamiltonians depending each on just one
pair of conjugate coordinates:
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{116}\)</span>

<!--


                                                                                                             X
                                                                                                             n
                                                                                                 H(q, p) =         hi (q i , pi ).                                                                                              (4.117)
                                                                                                             i=1


-->

<p>


\begin{equation}
H(q,p) = \sum _{i=1}^n h_i(q^i, p_i).
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-308"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">4.7</span></span><span class="amsthmnotedefinition"> (Planar harmonic oscillator)</span>.                           <a
id="ex:integrabilitypho"></a> Let’s reconsider an old friend of ours, the planar harmonic oscillator defined by a point particle of mass \(m\) attracted by an elastic force centered at \(0\in \mathbb {R}^2\) with stiffness \(k\).
</p>

<p>
The hamiltonian in cartesian coordinates \(x=(x_1, x_2)\) has the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{117}\)</span>

<!--


                                                                                                                              1
                                                                                                          H(x, p) =             (p2x1 + p2x2 ) + k(x21 + x22 ).                                                                            (4.118)
                                                                                                                             2m

-->

<p>


\begin{equation}
H(x,p) = \frac {1}{2m}(p_{x_1}^2 + p_{x_2}^2) + k(x_1^2 + x_2^2).
\end{equation}


</p>

<p>
Choosing the generating function
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{118}\)</span>

<!--



                                                                                                  S(x1 , x2 , b, E, t) = W1 (x1 , b, E) + W2 (x2 , b, E) − Et,                                                                             (4.119)

-->

<p>


\begin{equation}
S(x_1, x_2, b, E, t) = W_1(x_1, b, E) + W_2(x_2, b, E) - E t,
\end{equation}


</p>

<p>
we obtain the Hamilton-Jacobi equation
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{119}\)</span>

<!--

                                                                                                              2                 2
                                                                                                         ∂W1                 ∂W2
                                                                                                                    +                   + 2mk(x21 + x22 ) = 2mE,                                                                           (4.120)
                                                                                                         ∂x1                 ∂x2

-->

<p>


\begin{equation}
\left (\frac {\partial W_1}{\partial x_1}\right )^2 + \left (\frac {\partial W_2}{\partial x_2}\right )^2 + 2m k (x_1^2 + x_2^2) = 2m E,
\end{equation}


</p>

<p>
which can be separated into the two equations
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{120}\)</span>

<!--

                                                                                                                   2
                                                                                                              ∂Wi
                                                                                                                          + 2mkx2i = 2mkbi ,               i = 1, 2,                                                                       (4.121)
                                                                                                              ∂xi

-->

<p>


\begin{equation}
\left (\frac {\partial W_i}{\partial x_i}\right )^2 + 2m k x_i^2 = 2m k b_i, \quad i=1,2,
\end{equation}


</p>

<p>
such that \(K(b_1,b_2) := k(b_1 + b_2) = E\).
</p>

<p>
The rest now follows from the Jacobi method. Since we are in the case described by <span class="textup">(<a href="chapter-4.html#eq:JacobiM">4.105</a>)</span>, it holds
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{121}\)</span>

<!--


                                                                                                                    ∂Wi   ∂K
                                                                                                                        =     t + ci ,              i = 1, 2,                                                                              (4.122)
                                                                                                                    ∂bi   ∂bi

-->

<p>


\begin{equation}
\frac {\partial W_i}{\partial b_i} = \frac {\partial K}{\partial b_i}t + c_i, \quad i=1,2,
\end{equation}


</p>

<p>
where \(c_i\) are integration constants, we get
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{122}\)</span>

<!--

                                                                                                               r                             
                                                                                                    ∂Wi             mk                 xi
                                                                                                        =              arcsin          √          = kt + ci ,    i = 1, 2.                                                                 (4.123)
                                                                                                    ∂bi              2                   bi

-->

<p>


\begin{equation}
\frac {\partial W_i}{\partial b_i} = \sqrt {\frac {mk}{2}}\arcsin \left (\frac {x_i}{\sqrt {b_i}}\right ) = kt + c_i, \quad i=1,2.
\end{equation}


</p>

<p>
Some algebra and some care in checking domains of definition lead to
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{123}\)</span>

<!--

                                                                                                                                 r                 !
                                                                                                                    √                2k
                                                                                                          xi =          bi sin          t + ci         ,   i = 1, 2.                                                                       (4.124)
                                                                                                                                     m

-->

<p>


\begin{equation}
x_i = \sqrt {b_i} \sin \left (\sqrt {\frac {2k}{m}} t + c_i\right ), \quad i=1,2.
\end{equation}


</p>

<p>
The complete integral is thus given by the generating function
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{124}\)</span>

<!--



                                                                                               S(x1 , x2 , b1 , b2 , t) = W1 (x1 , b1 ) + W2 (x2 , b2 ) − K(b1 , b2 )t,                                                                    (4.125)

-->

<p>


\begin{equation}
S(x_1,x_2,b_1,b_2,t) = W_1(x_1, b_1) + W_2(x_2,b_2) - K(b_1, b_2) t,
\end{equation}


</p>

<p>
which depends on time, the two (generalized) coordinates \((x_1, x_2)\) and the two integration constants \((b_1, b_2)\). Note that you may as well stick with \(S\) in terms of \((E, b)\), as we will do in the next example: what you end up
choosing is just a matter of convenience.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-309"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">4.8</span></span>.                                                <a id="ex:kepler3dseparable"></a> Let’s consider a more involved example of a point of mass
\(m\) moving in \(\mathbb {R}^3\) under the influence of an arbitrary potential \(U\).
</p>

<p>
In spherical coordinates, the hamiltonian has the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{125}\)</span>

<!--

                                                                                                                                                             !
                                                                                                                       1             p2            p2ϕ
                                                                                                      H(r, ϕ, θ, p) =           p2r + 2θ +                       + U (r, ϕ, θ).                                                                                       (4.126)
                                                                                                                      2m                 r      r sin2 θ
                                                                                                                                                 2



-->

<p>


\begin{equation}
H(r,\phi ,\theta , p) = \frac {1}{2m}\left (p_r^2 + \frac {p_\theta ^2}{r^2} + \frac {p_\phi ^2}{r^2\sin ^2\theta }\right ) + U(r,\phi ,\theta ).
\end{equation}


</p>

<p>
Separation of variables is possible if
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{126}\)</span>

<!--


                                                                                                                                                γ(ϕ)      β(θ)
                                                                                                               U (r, ϕ, θ) = α(r) +                      + 2 ,                                                                                                        (4.127)
                                                                                                                                             r2 sin2 (θ)   r

-->

<p>


\begin{equation}
U(r,\phi ,\theta ) = \alpha (r) + \frac {\gamma (\phi )}{r^2 \sin ^2(\theta )} + \frac {\beta (\theta )}{r^2},
\end{equation}


</p>

<p>
for some functions \(\alpha (r)\), \(\beta (\theta )\), \(\gamma (\phi )\).
</p>

<p>
For simplicity, let’s assume that \(\gamma (\phi ) = 0\), then \(\phi \) becomes a cyclic coordinate and \(p_\phi = \mathrm {const} =: b_\phi \). The corresponding Hamilton-Jacobi equation for \(S\) becomes
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{127}\)</span>

<!--

                                                                                               2                             2                  !                             2
                                                                                           ∂S                   1          ∂S                                    1            ∂S
                                                                                                     + 2mα(r) + 2                    + 2mβ(θ)           +                               = 2mE,                                                                        (4.128)
                                                                                           ∂r                  r           ∂θ                               r2 sin2 (θ)       ∂ϕ

-->

<p>


\begin{equation}
\left (\frac {\partial S}{\partial r}\right )^2 + 2m\alpha (r) + \frac {1}{r^2}\left ( \left (\frac {\partial S}{\partial \theta }\right )^2 + 2m\beta (\theta ) \right ) + \frac {1}{r^2\sin ^2(\theta )}\left (\frac
{\partial S}{\partial \phi }\right )^2 = 2mE,
\end{equation}


</p>

<p>
where we are looking for a solution of the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{128}\)</span>

<!--



                                                                                                                 S0 (r, ϕ, θ) = ϕbϕ + W1 (r) + W2 (θ).                                                                                                                (4.129)

-->

<p>


\begin{equation}
S_0(r,\phi ,\theta ) = \phi b_\phi + W_1(r) + W_2(\theta ).
\end{equation}


</p>

<p>
Replacing the ansatz for \(S\) in the equation above, we get
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{129}\)</span>



<!--


                                                                                                                          2
                                                                                                                     ∂W2                            b2ϕ
                                                                                                                                + 2mβ(θ) +                = bθ ,                                                                                                      (4.130)
                                                                                                                      ∂θ                         sin2 (θ)
                                                                                                                          2
                                                                                                                     ∂W1                         bθ
                                                                                                                                + 2mα(r) +          = 2mE.                                                                                                            (4.131)
                                                                                                                      ∂r                         r2



-->



<p>


\begin{align}
&amp; \left (\frac {\partial W_2}{\partial \theta }\right )^2 + 2m \beta (\theta ) + \frac {b_\phi ^2}{\sin ^2(\theta )} = b_\theta , \\ &amp; \left (\frac {\partial W_1}{\partial r}\right )^2 + 2m \alpha (r) +
\frac {b_\theta }{r^2} = 2mE.
\end{align}


</p>

<p>
Integrating, we end up with
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{131}\)</span>



<!--



                                                                                                               S0 = ϕbϕ                                                                                                                                               (4.132)
                                                                                                                    Z p
                                                                                                                  +     2m(E − α(r)) − bθ /r2 dr                                                                                                                      (4.133)
                                                                                                                    Z q
                                                                                                                  +     bθ − 2mβ(θ) − b2ϕ /sin2 (θ)dθ.                                                                                                                (4.134)

                                                                                                                                                                                                                                                                      (4.135)



-->



<p>


\begin{align}
S_0 &amp; = \phi b_\phi \\ &amp; + \int \sqrt {2m(E-\alpha (r))-{b_\theta }/{r^2}}\dd r \\ &amp; + \int \sqrt {b_\theta -2m\beta (\theta )-{b_\phi ^2}/{\sin ^2(\theta )}}\dd \theta . \\
\end{align}


</p>

<p>
The complete integral is then the generating function
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{135}\)</span>

<!--



                                                                                                 S(r, ϕ, θ, E, bϕ , bθ , t) = ϕbϕ + W1 (r, E, bθ ) + W2 (θ, bϕ , bθ ) − Et,                                                                                           (4.136)

-->

<p>


\begin{equation}
S(r,\phi ,\theta ,E,b_\phi ,b_\theta ,t) = \phi b_\phi + W_1(r, E, b_\theta ) + W_2(\theta , b_\phi , b_\theta ) - E t,
\end{equation}


</p>

<p>
depending on time, the three (generalized) coordinates \((r,\phi ,\theta )\) and the three integration constants \((E,b_\phi ,b_\theta )\).
</p>

<p>
To obtain \(r(t)\) and \(\theta (t)\) we then need to invert the integrals
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{136}\)</span>

<!--


                                                                                                      ∂S                          ∂S                         ∂S
                                                                                                         = Q E = t − t0 ,             = Qθ = c 1 ,               = Qϕ = c 2 ,                                                                                         (4.137)
                                                                                                      ∂E                          ∂bθ                        ∂bϕ

-->

<p>


\begin{equation}
\frac {\partial S}{\partial E} = Q_E = t-t_0, \quad \frac {\partial S}{\partial b_\theta } = Q_\theta = c_1, \quad \frac {\partial S}{\partial b_\phi } = Q_\phi = c_2,
\end{equation}


</p>

<p>
where \(c_1\) and \(c_2\) are arbitrary constants. The momenta \(p_\theta \) and \(p_r\) are then given by
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{137}\)</span>

<!--


                                                                                                                                  ∂S                ∂S
                                                                                                                           pr =      ,       pθ =      .                                                                                                              (4.138)
                                                                                                                                  ∂r                ∂θ

-->

<p>


\begin{equation}
p_r = \frac {\partial S}{\partial r}, \quad p_\theta = \frac {\partial S}{\partial \theta }.
\end{equation}


</p>

<p>
Doing these last computations analytically is generally hard or impossible because of complicated integrals and people refer to numerical investigations. On the other hand, by setting the constants to \(0\), they often allow to compute explicit
equations for the trajectories – without time dependence – and to obtain useful asymptotic approximations.
</p>

</li>

</ul>

</div>
<!--................................-->
<h5 id="autosec-310"><span class="sectionnumber">4.3.2&#x2003;</span>A few exercises</h5>
<a id="hm-autopage-310"></a>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-311"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">4.1</span></span>.                       Show that the infinitesimal transformation
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{138}\)</span>

<!--



                                                                                                        q = Q + ϵQ2 sin(P ),   p = P + 2ϵQ(1 + cos(P )),                                                        (4.139)

-->

<p>


\begin{equation}
q = Q + \epsilon Q^2 \sin (P), \quad p = P + 2\epsilon Q(1+\cos (P)),
\end{equation}


</p>

<p>
is a canonical transformation and determine its domain. Compute the hamiltonian \(K(Q,P)\) associated to the transformation.
</p>

<p>
Consider then the transformation
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{139}\)</span>



<!--



                                                                                                                X∞
                                                                                                                    (2j − 1)!! j j
                                                                                        q = Q + ϵQ2 sin(P ) +                 2 ϵ sinj (P )Qj+1 ,                                                               (4.140)
                                                                                                                j=2
                                                                                                                     (j + 1)!
                                                                                                                                                                   !
                                                                                                    2
                                                                                                                                   X∞
                                                                                                                                       (2j − 1)!! j j
                                                                                        p = P + 2ϵQ (1 + cos(P )) 1 + ϵQ sin(P ) +               2 ϵ sinj (P )Qj       .                                        (4.141)
                                                                                                                                   j=2
                                                                                                                                        (j + 1)!



-->



<p>


\begin{align}
q &amp; = Q + \epsilon Q^2 \sin (P) + \sum _{j=2}^\infty \frac {(2j-1)!!}{(j+1)!}2^j \epsilon ^j \sin ^j(P) Q^{j+1}, \\ p &amp; = P + 2\epsilon Q^2\left (1+\cos (P)\right )\left ( 1 + \epsilon Q \sin (P) + \sum
_{j=2}^\infty \frac {(2j-1)!!}{(j+1)!}2^j \epsilon ^j \sin ^j(P) Q^{j} \right ).
\end{align}
Show that it is a canonical transformation and compute its generating function.<br />
<i>Hint: use the following series expansion \(\sqrt {1-x} = 1 - \frac {x}{2} + \sum _{j=2}^\infty \frac {(2j-3)!!}{j! 2^j} x^j\).</i>
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-312"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">4.2</span></span>.   Let \(Q = q^2 + \frac 12 \cos (q)\). Find \(P(q,p)\) such that the corresponding coordinate
transformation is canonical. Compute the corresponding generating function.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-313"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">4.3</span></span><span class="amsthmnotedefinition"> (Parabolic coordinates)</span>.   Let \((r,\phi ,z)\) denote
the cylindrical coordinates in \(\mathbb {R}^3\). Find the complete integral of the Hamilton-Jacobi equations for a point particle of mass \(m\) under the influence of the potential
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{141}\)</span>

<!--


                                                                                                                                  α
                                                                                                              U (r, ϕ, z) = √            − F z.                                                                         (4.142)
                                                                                                                                r2 + z 2

-->

<p>


\begin{equation}
U(r,\phi ,z) = \frac {\alpha }{\sqrt {r^2+z^2}} - F z.
\end{equation}


</p>

<p>
To this end, introduce the parabolic coordinates \((\xi , \eta , \phi )\) obtained from the equations
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{142}\)</span>

<!--


                                                                                                                     1                  p
                                                                                                                z=     (ξ − η),    r=       ξη.                                                                         (4.143)
                                                                                                                     2

-->

<p>


\begin{equation}
z = \frac 12(\xi - \eta ), \quad r = \sqrt {\xi \eta }.
\end{equation}


</p>

<p>


</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-314"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">4.4</span></span><span class="amsthmnotedefinition"> (Prolate spheroidal coordinates)</span>.                        Consider a point
particle of mass \(m\) under the gravitational attraction of two bodies which are fixed at the points \((d,0,0)\) and \((-d,0,0)\), \(d&gt;0\). Show that the Hamilton-Jacobi equation is separable introducing the prolate spheroidal coordinates
obtained by
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{143}\)</span>

<!--



                                                                                          x = d cosh ξ cos η,   y = d sinh ξ sin η cos ϕ,   z = d sinh ξ sin η sin ϕ,                                                                          (4.144)

-->

<p>


\begin{equation}
x = d \cosh \xi \cos \eta , \quad y = d \sinh \xi \sin \eta \cos \phi , \quad z = d \sinh \xi \sin \eta \sin \phi ,
\end{equation}


</p>

<p>
where \(\xi \in \mathbb {R}_+\), \(0\leq \eta \leq \phi \) and \(0\leq \phi \leq 2\pi \).
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-315"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">4.5</span></span>.               Consider the motion of a free particle of mass \(m\) on a surface \(S\subset \mathbb {R}^3\)
parametrized by
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{144}\)</span>

<!--



                                                                                                    x = u cos v,   y = u sin v,   z = ψ(u),                                                                                              (4.145)

-->

<p>


\begin{equation}
x = u \cos v, \quad y = u \sin v, \quad z = \psi (u),
\end{equation}


</p>

<p>
with \(u\in \mathbb {R}\) and \(0\leq v\leq 2\pi \). Determine the conjugate momenta associated to the variables \(v\) and \(u\) and show that the corresponding hamiltonian system is separable.
</p>

</li>

</ul>

</div>
<!--................................-->
<h4 id="autosec-316"><span class="sectionnumber">4.4&#x2003;</span>The Liouville-Arnold theorem</h4>
<a id="hm-autopage-316"></a>


<a id="sec:intsys"></a>

<p>
We have seen that the equations of motion of a lagrangian with one degree of freedom are integrable by quadratures. In fact, throughout the previous chapters we have seen more.
</p>

<p>
The trajectories of the motion are the level curves \(\lambda _E =: H^{-1}(E) = \{H(q,p) = E\}\) of the hamiltonian \(H(q,p)\) whose dynamics is obtained integrating
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{145}\)</span>

<!--

                                                                                                                      dq            dp
                                                                                                           dt =              =−                                                                                                   (4.146)
                                                                                                                  ∂p H(q, p)    ∂q H(q, p)

-->

<p>

\begin{equation}
\dd t = \frac {\dd q}{\partial _p H(q,p)} = - \frac {\dd p}{\partial _q H(q,p)}
\end{equation}

</p>

<p>
over \(\lambda _E\). If \(\lambda _E\) is compact, then the motion is finite and periodic with period
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{146}\)</span>

<!--

                                                                                                                              I
                                                                                                                        T =            dt.                                                                                        (4.147)
                                                                                                                                  λE


-->

<p>

\begin{equation}
T = \oint _{\lambda _E}\dd t.
\end{equation}

</p>

<p>
If \(\lambda _E\) is smooth, then the gradient \((\partial _q H, \partial _p H)\neq 0\) over \(\lambda _E\), therefore we can reparametrize the motion as \((q,p) = (q(\phi , E), p(\phi , E))\) where
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{147}\)</span>

<!--

                                                    Z                         Z
                                               2π              dq        2π             dp
                                          ϕ=                          =−                                                                     (4.148)                                                     --><a id="eq:phirep1d"></a><!--
                                               T        λE ∂p H(q, p)    T        λE ∂q H(q, p)


-->

<p>

\begin{equation}
\label {eq:phirep1d} \phi = \frac {2\pi }{T}\int _{\lambda _E} \frac {\dd q}{\partial _p H(q,p)} = -\frac {2\pi }{T}\int _{\lambda _E} \frac {\dd p}{\partial _q H(q,p)}
\end{equation}

</p>

<p>
and the functions \(q(\phi , E)\) and \(p(\phi , E)\) are \(2\pi \)-periodic in \(\phi \). In fact, in such case, we also saw that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{148}\)</span>

<!--

                                                                                                                   I                    I
                                                                                                                                    d
                                                                                                             T =            dt =                  pdq.                                                                            (4.149)
                                                                                                                       λE          dE        λE


-->

<p>

\begin{equation}
T = \oint _{\lambda _E}\dd t = \frac {\dd }{\dd E} \oint _{\lambda _E} p\dd q.
\end{equation}

</p>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-317"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">4.6</span></span>. In the integral <span class="textup">(<a href="chapter-4.html#eq:phirep1d">4.148</a>)</span>
you can choose the initial point arbitrarily as long as it varies smoothly with respect to \(E\).
</p>

</li>

</ul>

</div>

<p>
With such reparametrization we end up with a periodic motion of the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{149}\)</span>

<!--

                                                                                                          (                       
                                                                                                              q = q ωt + ϕ0 , E               2π
                                                                                                                              0    ,   ω=       ,    ϕ0 arbitrary.                                                                              (4.150)
                                                                                                              p = p ωt + ϕ , E                T

-->

<p>

\begin{equation}
\left \lbrace \begin{aligned} &amp; q = q\left (\omega t + \phi ^0, E\right ) \\ &amp; p = p\left (\omega t + \phi ^0, E\right ) \end {aligned} \right ., \quad \omega = \frac {2\pi }{T}, \quad \phi ^0\mbox {
arbitrary}.
\end{equation}

</p>


<div
    class="tcolorbox"
    style=" border: 1px solid #404040; background: #F2F2F2; "
>


<div
    class="tcolorboxupper"
    style=" color: #000000; "
>

<p>
Consider now a hamiltonian system \(H(q,p)\) with \(n\) degrees of freedom. If the system admits \(n\) independent first integrals \(H_1(q,p), H_2(q,p), \ldots , H_n(q,p)\) in involution, i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{150}\)</span>

<!--

                                                                                                                    
                                                                                                                        Hi , Hj = 0,     i, j = 1, . . . , n,                                                                                    (4.151)

-->

<p>

\begin{equation}
\big \{H_i, H_j\big \} = 0,\quad i,j=1,\ldots ,n,
\end{equation}

</p>

<p>
we say that it is a <em>completely integrable hamiltonian system</em>.
</p>
</div>

</div>

<p>
Without loss of generality, let’s assume \(H_1 = H\). We will show that a completely integrable system shares the property of one–dimensional conservative hamiltonian systems: i.e., it is integrable by quadratures. Moreover, if for \(E = (E_1,
\ldots , E_n)\in \mathbb {R}^n\) the levelset
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{151}\)</span>

<!--

                                                  
                                  ME := H −1 (E) = (q, p) ∈ R2n | Hi (q, p) = Ei , i = 1, . . . , n                                           (4.152)                                                              --><a id="eq:levelsetE"></a><!--

-->

<p>

\begin{equation}
\label {eq:levelsetE} M_E := H^{-1}(E) = \big \{(q,p)\in \mathbb {R}^{2n} \;\mid \; H_i(q,p)=E_i,\;i=1,\ldots ,n \big \}
\end{equation}

</p>

<p>
is compact, then the motion is equivalent to the motion of a free flow on the torus. In fact, the integrability allows us to introduce some local canonical coordinates
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{152}\)</span>

<!--


                                               (ϕ1 , . . . , ϕn , I1 , . . . , In ) ∈ Tn × Rn                                             (4.153)                                                               --><a id="eq:actionalngle"></a><!--

-->

<p>

\begin{equation}
\label {eq:actionalngle} (\phi _1, \ldots , \phi _n, I_1, \ldots , I_n) \in \mathbb {T}^n\times \mathbb {R}^n
\end{equation}

</p>

<p>
such that the hamiltonian system takes the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{153}\)</span>

<!--


                                                                                                                 I˙k = 0,     ϕ̇k = ωk (I),    k = 1, . . . , n,                                                                                 (4.154)

-->

<p>

\begin{equation}
\dot I_k = 0, \quad \dot \phi _k = \omega _k(I), \quad k=1,\ldots ,n,
\end{equation}

</p>

<p>
whose corresponding solution is simply
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{154}\)</span>

<!--


                                                                                                      Ik (t) = Ik (0),      ϕk (t) = ϕk (0) + ωk (I)t,      k = 1, . . . , n.                                                                    (4.155)

-->

<p>

\begin{equation}
I_k(t)= I_k(0), \quad \phi _k(t) = \phi _k(0) + \omega _k(I)t, \quad k = 1,\ldots , n.
\end{equation}

</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-318"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.12</span></span><span class="amsthmnoteplain"> (Liouville-Arnold)</span>.     <a id="thm:liouvillearnold"></a> Consider a
completely integrable hamiltonian system on the phase space \(\mathbb {R}^{2n}\). Assume that there exists \(E^0 = (E^0_1, \ldots , E^0_n)\) such that the functions
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{155}\)</span>

<!--



                                                                                                                 H1 (q, p), . . . , Hn (q, p)                                                                          (4.156)

-->

<p>


\begin{equation}
H_1(q,p), \ldots , H_n(q,p)
\end{equation}


</p>

<p>
are independent at every point of the level surface \(M_{E^0}\) defined by <span class="textup">(<a href="chapter-4.html#eq:levelsetE">4.152</a>)</span>.
</p>

<p>
Then, for values of \(|E-E^0|\) small enough, the following holds
</p>
<ul style="list-style-type:none">


<li>
<p>
• the level surfaces \(M_E\) are smooth \(n\)-dimensional lagrangian submanifolds in \(\mathbb {R}^{2n}\) which are invariant under the hamiltonian flow;
</p>


</li>
<li>


<p>
• the hamiltonian flow on \(M_E\) is integrable by quadratures.
</p>
</li>
</ul>

<p>
Furthermore, if \(M_{E^0}\) is compact and connected, then, for values of \(|E-E^0|\) small enough, the level surfaces \(M_E\), are diffeomorphic to a \(n\)-dimensional torus,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{156}\)</span>

<!--


                                         
                                ME ' Tn = (ϕ1 , . . . , ϕn ) ∈ Rn | ϕi ∼ ϕi + 2π, i = 1, . . . , n ,                               (4.157)                                                 --><a id="eq:idtorusstd"></a><!--

-->

<p>


\begin{equation}
\label {eq:idtorusstd} M_E \simeq \mathbb {T}^n = \big \{ (\phi _1, \ldots , \phi _n)\in \mathbb {R}^n \;\mid \; \phi _i \sim \phi _i+2\pi , \; i=1,\ldots ,n \big \},
\end{equation}


</p>

<p>
and the motion on the tori \(M_E\) is <em>conditionally periodic</em>. That is, in the coordinates \((\phi _1, \ldots , \phi _n)\) the motion takes the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{157}\)</span>

<!--



                                      ϕ1 (t) = ω1 (E)t + ϕ01 ,   ...   ϕn (t) = ωn (E)t + ϕ0n ,                                   (4.158)                                                 --><a id="eq:condperflow"></a><!--

-->

<p>


\begin{equation}
\label {eq:condperflow} \phi _1(t) = \omega _1(E) t + \phi _1^0, \quad \ldots \quad \phi _n(t) = \omega _n(E) t + \phi _n^0,
\end{equation}


</p>

<p>
where \(\omega _1(E),\ldots ,\omega _n(E)\) are constants which only depend on \(E\) and the phases \(\phi _1^0,\ldots ,\phi _n^0\) are arbitrary.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-319"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">4.7</span></span>.                A separable hamiltonian system is completely integrable. Indeed, for a separable system there exists a
canonical transformation \((q,p) \mapsto (Q,P)\) such that the hamiltonian \(H\) in the new coordinates does not depend on \(Q\), \(H=H(P)\). The functions \(P_1, \ldots , P_n\), which are in involution by construction, commute with \(H\).
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-320"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> The independence of the functions \(H_1(q,p), \ldots , H_n(q,p)\) at every point in \(M_{E^0}\) implies their independence on nearby energy levels. The implicit function theorem then yields the
smoothness of the \(n\)-dimensional submanifolds \(M_E\) for \(|E-E^0|\) small enough.
</p>

<p>
Recall that the hamiltonian vector field \(X_H\) is tangent to the levelset \(F(x)=C\) of any first integral \(\big \{H,F\big \} = 0\). Therefore, the hamiltonian vector fields \(X_{H_1}, \ldots , X_{H_n}\) are <em>tangent</em> to \(M_E\) for all
values of \(E=(E_1,\ldots , E_n)\). They are also linearly independent, since the differentials \(\dd H_i\) are linearly independent at every point on \(M_E\). In summary, we have shown that for \(|E-E^0|\) small enough
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{158}\)</span>

<!--



                                                                                                               span(XH1 , . . . , XHn ) x∈M = Tx ME .                                                                                          (4.159)
                                                                                                                                                 E



-->

<p>


\begin{equation}
\mathrm {span}(X_{H_1}, \ldots , X_{H_n}) \big |_{x\in M_E} = T_x M_E.
\end{equation}


</p>

<p>
Furthermore,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{159}\)</span>

<!--


                                                                                                                        
                                                                                                         ω(XHi , XHj ) = Hi , Hj = 0,                i, j = 1, . . . , n,                                                                      (4.160)

-->

<p>


\begin{equation}
\omega (X_{H_i}, X_{H_j}) = \big \{H_i, H_j\big \} =0, \quad i,j=1,\ldots ,n,
\end{equation}


</p>

<p>
which implies that \(M_E\) is a lagrangian submanifold. Proving the first part of the first statement.
</p>

<p>
To show integrability by quadratures, we need to find a good family of local coordinates. To this end we will rely on our newly acquired knowledge of canonical transformations.
</p>

<p>
The independence of the functions implies that the \(n\times 2n\)-matrix \(\left ( \frac {\partial H_i}{\partial q^j}, \frac {\partial H_i}{\partial p_j} \right )_{M_{E^0}}\) has rank \(n\). Without loss of generality, we assume
that for a point \(x_0 \in M_{E^0}\), \(x_0 =(q_0,p_0)\), the Jacobian with respect to \(p\) is non–degenerate, i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{160}\)</span>

<!--

                                                                   
                                                              ∂Hi
                                                                             6= 0.                                                            (4.161)                                                            --><a id="eq:nondegHip"></a><!--
                                                              ∂pj       x0


-->

<p>


\begin{equation}
\label {eq:nondegHip} \left ( \frac {\partial H_i}{\partial p_j} \right )_{x_0} \neq 0.
\end{equation}


</p>

<p>
The equations
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{161}\)</span>



<!--



                                                                                                                 Hi (q0 , p(E)) = Ei ,       i = 1, . . . , n,                                                                                 (4.162)
                                                                                                                     0
                                                                                                                 p(E ) = p0 ,                                                                                                                  (4.163)



-->



<p>


\begin{align}
&amp; H_i(q_0, p(E)) = E_i,\quad i = 1,\ldots ,n, \\ &amp; p(E^0) = p_0,
\end{align}
determine,for all \(E\) close enough to \(E^0\), a point \(x_0(E) = (q_0, p(E))\in M_E\) on all the surfaces \(M_E\) which depends smoothly on \(E\). Thanks to <span class="textup">(<a
href="chapter-4.html#eq:nondegHip">4.161</a>)</span> and the implicit function theorem, the lagrangian submanifold \(M_E\) can be represented in a neighborhood of \(x_0(E)\) in the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{163}\)</span>

<!--


                                                                                                                                         ∂S(q, E)
                                                                                                                      p = p(q, E) =               .                                                                                            (4.164)
                                                                                                                                           ∂q

-->

<p>


\begin{equation}
p = p(q,E) = \frac {\partial S(q,E)}{\partial q}.
\end{equation}


</p>

<p>
Moreover, the variables \(q=(q^1, \ldots , q^n)\), \(E= (E_1,\ldots ,E_n)\) can be used as local coordinates in a neighborhood of \(x_0(E^0)\). A generating function \(S=S(q,E)\) could be, for example, the quadrature
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{164}\)</span>

<!--

                                                                                                                                 Z (q,p(q,E))
                                                                                                                     S(q, E) =                       pdq                                                                                       (4.165)
                                                                                                                                    x0 (E)


-->

<p>


\begin{equation}
S(q,E) = \int _{x_0(E)}^{(q,p(q,E))} p \dd q
\end{equation}


</p>

<p>
along a curve on the lagrangian submanifold \(M_E\) (one can show that such integral does not depend on the choice of the integration path).
</p>

<p>
Using the generating function \(S(q,E)\) one obtains a canonical transformation
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{165}\)</span>



<!--



                                                                                                                                    ∂S(q, E)
                                                                                                         (q, p) 7→ (ψ, E),   ψi =            ,          i = 1, . . . , n,                                                                      (4.166)
                                                                                                                                      ∂Ei
                                                                                                         dp ∧ dq = dE ∧ dψ.                                                                                                                    (4.167)



-->



<p>


\begin{align}
&amp; (q,p)\mapsto (\psi , E), \quad \psi _i = \frac {\partial S(q,E)}{\partial E_i}, \quad i=1,\ldots ,n, \\ &amp; \dd p \wedge \dd q = \dd E \wedge \dd \psi .
\end{align}
In the canonical coordinates \((\psi , E)\), we have that \(\{\psi _i, E_j\} = \delta _{ij}\) and the hamiltonian \(H = H_1(q,p)\) transforms to \(H(\psi , E) = E_1\). Then the hamiltonian flow \(\dot x = \{x, E_1\}\), i.e.,
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{167}\)</span>



<!--



                                                                                                                  ψ̇1 = 1,   ψ̇i = 0,        i = 2, . . . , n                                                                                  (4.168)
                                                                                                                  Ėj = 0,   j = 1, . . . , n,                                                                                                 (4.169)



-->



<p>


\begin{align}
&amp; \dot \psi _1 = 1, \quad \dot \psi _i = 0, \quad i=2,\ldots ,n \\ &amp; \dot E_j = 0, \quad j = 1,\ldots , n,
\end{align}
becomes immediately integrable and concludes the first part of the proof.
</p>

<p>
To show the second part of the theorem we need an intermediate geometric lemma.
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-321"></a>
<span class="amsthmnameplain">Lemma</span><span class="amsthmnumberplain"> <span class="textup">4.13</span></span>.                           <a id="lemma:isotn"></a> Let \(M\) be a \(n\)-dimensional compact connected manifold. Assume that at all
points \(x\in M\) there exist \(n\) linearly independent vector fields \(X_1, \ldots , X_n\) which are pairwise commuting, i.e.,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{169}\)</span>

<!--



                                                                                                             [Xi , Xj ] = 0,   i, j = 1, . . . , n.                                                                                              (4.170)

-->

<p>


\begin{equation}
[X_i, X_j] = 0, \quad i,j = 1,\ldots ,n.
\end{equation}


</p>

<p>
Then, \(M \simeq \mathbb {T}^n\) is diffeomorphic to a torus.
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-322"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> Since \(M\) is compact, the one–parameter group of diffeomorphisms
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{170}\)</span>

<!--


                                                                                                                                d i
                                                                                                           Φit : M → M,            Φt (x)     = Xi (x)                                                          (4.171)
                                                                                                                                dt        t=0


-->

<p>


\begin{equation}
\Phi _t^i: M \to M, \quad \dv {t} \Phi _t^i(x)\Big |_{t=0} = X_i(x)
\end{equation}


</p>

<p>
generated by the vector fields is well defined for all \(t\in \mathbb {R}\). The commutativity of the vector fields implies the commutativity of the groups, that is,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{171}\)</span>

<!--



                                                                                                               Φis ◦ Φjt = Φjt ◦ Φis ,    ∀s, t ∈ R.                                                            (4.172)

-->

<p>


\begin{equation}
\Phi ^i_s \circ \Phi ^j_t = \Phi ^j_t \circ \Phi ^i_s, \quad \forall s,t\in \mathbb {R}.
\end{equation}


</p>

<p>
Such flows allows us to define an action of the abelian group \(\mathbb {R}^n\) on the manifold \(M\) by
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{172}\)</span>



<!--



                                                                                                       Φt := ϕ1t1 ◦ · · · ◦ ϕn
                                                                                                                             tn ,   t = (t1 , . . . , tn ) ∈ Rn ,                                               (4.173)
                                                                                                       Φt+s = Φt ◦ Φs ,       ∀t, s ∈ R . n
                                                                                                                                                                                                                (4.174)



-->



<p>


\begin{align}
&amp; \Phi _{\vb *{t}} := \phi _{t_1}^1 \circ \cdots \circ \phi _{t_n}^n, \quad \vb *{t} = (t_1, \ldots , t_n)\in \mathbb {R}^n, \\ &amp; \Phi _{\vb * t + \vb * s} = \Phi _{\vb * t} \circ \Phi _{\vb * s}, \quad
\forall \vb * t, \vb * s \in \mathbb {R}^n.
\end{align}


</p>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-323"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">4.6</span></span>.   Show that the action \(\Phi _{\vb * t}\) is transitive, that is, for every two points \(x, y\in M\),
there exists \(\vb * t\in \mathbb {R}^n\) such that \(y = \Phi _{\vb * t} (x)\).
</p>

</li>

</ul>

</div>

<p>
For any \(x_0 \in M\), the map
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{174}\)</span>

<!--



                                                                  Rn → M,    t 7→ Φt (x0 )                                                     (4.175)                                            --><a id="eq:diffeoRnM"></a><!--

-->

<p>


\begin{equation}
\label {eq:diffeoRnM} \mathbb {R}^n \to M, \quad \vb * t \mapsto \Phi _{\vb * t}(x_0)
\end{equation}


</p>

<p>
is smooth, and the set
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{175}\)</span>

<!--



                                                                                                Γ = {t ∈ Rn | Φt (x0 ) = x0 }                                                                                                   (4.176)

-->

<p>


\begin{equation}
\Gamma = \left \{ \vb * t \in \mathbb {R}^n \;\mid \; \Phi _{\vb * t}(x_0) = x_0\right \}
\end{equation}


</p>

<p>
is a subgroup of \(\mathbb {R}^n\), called the <em>isotropy</em> subgroup.
</p>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-324"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">4.7</span></span>.              Show that the subgroup \(\Gamma \) does not depend on \(x_0\). <i>Hint: \(\Gamma \) is
transitive.</i> Furthermore, \(\Gamma \) is a <em>discrete</em> subgroup of \(\mathbb {R}^n\), that is, there is an open set \(U \ni \vb * 0\) such that \(U\cap \Gamma = \{\vb * 0\}\).
</p>

</li>

</ul>

</div>

<p>
Discrete subgroups of \(\mathbb {R}^n\) admit a very nice description, which will be handy also later (for the proof see [<a href="index.html#??">Kna18</a>, Lemma 13.4]).
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-325"></a>
<span class="amsthmnameplain">Lemma</span><span class="amsthmnumberplain"> <span class="textup">4.14</span></span>.                                      <a id="lem:reprTm"></a> Let \(\Gamma \) be a discrete subgroup of \(\mathbb {R}^n\). Then, there exist
\(m\) linearly independent vectors \(e_1, \ldots , e_m \in \mathbb {R}^n\), \(0\leq m \leq n\), such that
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{176}\)</span>



<!--



                                                                                                     Γ = spanZ (e1 , . . . , em )                                                                                                                            (4.177)
                                                                                                         = {k1 e1 + · · · + km em | (k1 , . . . , km ) ∈ Z } .        m
                                                                                                                                                                                                                                                             (4.178)



-->



<p>


\begin{align}
\Gamma &amp; = \mathrm {span}_{\mathbb {Z}}(e_1, \ldots , e_m) \\ &amp; = \left \{ k_1 e_1 + \cdots + k_m e_m \;\mid \; (k_1, \ldots , k_m)\in \mathbb {Z}^m \right \}.
\end{align}


</p>

</li>

</ul>

</div>

<p>
To conclude the proof of the lemma we just need to observe that \(M\) is diffeomorphic to the quotient
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{178}\)</span>

<!--



                                                                                                                              M ' Rn /Γ                                                                                                                      (4.179)

-->

<p>


\begin{equation}
M \simeq \mathbb {R}^n / \Gamma
\end{equation}


</p>

<p>
via the diffeomorphism <span class="textup">(<a href="chapter-4.html#eq:diffeoRnM">4.175</a>)</span>. Furthermore, if we extend the basis \(e_1, \ldots , e_m\) to a basis \(e_1, \ldots , e_m, e_{m+1}, \ldots ,e_n\) of \(\mathbb
{R}^n\), Lemma&nbsp;<a href="chapter-4.html#lem:reprTm">4.14</a> implies that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{179}\)</span>

<!--



                                                                                                                   M ' Rn /Γ ' Tm × Rn−m .                                                                                                                   (4.180)

-->

<p>


\begin{equation}
M \simeq \mathbb {R}^n / \Gamma \simeq \mathbb {T}^m \times \mathbb {R}^{n-m}.
\end{equation}


</p>

<p>
Since \(M\) is compact by hypothesis, \(n=m\).
</p>

<p>
With \(M\) being diffeomorphic to a torus, its points can be parametrized by \(n\) angles \(\phi _1, \ldots , \phi _n\) in such a way that every \(\vb * t \in \mathbb {R}^n/\Gamma \) can be written in the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{180}\)</span>

<!--


                                                                                                                           1
                                                                                                                  t=         (ϕ1 e1 + · · · + ϕn en ),                                                                                                       (4.181)
                                                                                                                          2π

-->

<p>


\begin{equation}
\vb * t = \frac 1{2\pi }(\phi _1 e_1 + \cdots + \phi _n e_n),
\end{equation}


</p>

<p>
which gives the identification with the standard torus <span class="textup">(<a href="chapter-4.html#eq:idtorusstd">4.157</a>)</span>. <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
The fact that \(M_E\simeq \mathbb {T}^n\) now follows applying Lemma&nbsp;<a href="chapter-4.html#lemma:isotn">4.13</a> with the vector fields \(X_{H_1}, \ldots , X_{H_n}\).
</p>

<p>
To conclude the proof, we only need to show that the hamiltonian dynamics of the angular coordinates \((\phi _1, \ldots , \phi _n)\) is linear. For each \(x_0\in M_E\), the mapping <span class="textup">(<a
href="chapter-4.html#eq:diffeoRnM">4.175</a>)</span>, \([0, 2\pi )^n \to M_E\),
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{181}\)</span>

<!--

                                                                                                                                             !
                                                                                                                           X
                                                                                                                           n
                                                                                                                             ϕi ei
                                                                                                (ϕ1 , . . . , ϕn ) 7→ Φ               , x0       := Φt (x0 )        Pn       ϕi ei
                                                                                                                                                                                                                                                             (4.182)
                                                                                                                           i=1
                                                                                                                                 2π                            t=      i=1    2π



-->

<p>


\begin{equation}
(\phi _1, \ldots , \phi _n)\mapsto \Phi \left (\sum _{i=1}^n \frac {\phi _i e_i}{2\pi }, x_0\right ) := \Phi _{\vb * t}(x_0)\Big |_{\vb * t = \sum _{i=1}^n \frac {\phi _i e_i}{2\pi }}
\end{equation}


</p>

<p>
is a bijection. Assume that the vector \((1, 0, \ldots , 0)\in \mathbb {R}^n\) is represented as \(\sum _{i=1}^n \frac {\omega _i}{2\pi } e_i\), then the flow generated by \(H\) is of the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{182}\)</span>

<!--

                                                                                                                                                                             !
                                                                                                                                                         X
                                                                                                                                                         n
                                                                                                                                                           ωi
                                                                                                   Φ1t1 (y) = Φ((t1 , 0, . . . , 0), y) = Ψ         t1              ei , y       ,                                                                           (4.183)
                                                                                                                                                         i=1
                                                                                                                                                               2π

-->

<p>


\begin{equation}
\Phi ^1_{t_1}(y) = \Phi ((t_1, 0, \ldots , 0), y) = \Psi \left (t_1 \sum _{i=1}^n \frac {\omega _i}{2\pi }e_i, y\right ),
\end{equation}


</p>

<p>
which means that the coordinates \(\phi _1(t), \ldots , \phi _n(t)\) of \(\Phi _t^1(y)\) satisfy <span class="textup">(<a href="chapter-4.html#eq:condperflow">4.158</a>)</span>. <span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-326"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">4.8</span></span>. Extend the proof to completely integrable system on an arbitrary symplectic manifold. (Solution: find
the differences between our proof and [<a href="index.html#??">Kna18</a>, Theorem 13.3]).
</p>

</li>

</ul>

</div>
<!--................................-->
<h5 id="autosec-327"><span class="sectionnumber">4.4.1&#x2003;</span>Action-angle variables</h5>
<a id="hm-autopage-327"></a>


<p>
Given a surface \(M_{E^0}\) on which the first integrals \(H_1, \ldots , H_n\) are independent everywhere (i.e., the differentials \(\dd H_1, \ldots , \dd H_n\) are linearly independent at all points), we would like to construct <em>globally</em>
the canonical coordinates \((\phi _1, \ldots , \phi _n, I_1, \ldots , I_n)\) from <span class="textup">(<a href="chapter-4.html#eq:actionalngle">4.153</a>)</span> on some neighborhood \(U(M_{E^0})\subset \mathbb {R}^{2n}\)
of \(M_{E^0}\) such that the \(\phi \) are the angular coordinates on the invariant tori \(M_E\) for \(E\) suﬀiciently close to \(E^0\).
</p>

<p>
Consider the symplectic manifold \(\mathbb {T}^n \times \mathbb {R}^n\) with canonical coordinates \((\phi , I)\) and the symplectic form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{183}\)</span>

<!--

                                                                                                                          X
                                                                                                                          n
                                                                                                              dI ∧ dϕ =         dIk ∧ dϕk .                                                                                                    (4.184)
                                                                                                                          k=1


-->

<p>

\begin{equation}
\dd I \wedge \dd \phi = \sum _{k=1}^n \dd I_k \wedge \dd \phi _k.
\end{equation}

</p>

<p>
Any ball \(B\subset \mathbb {R}^n\) centered at a point \(I^0 = (I^0_1, \ldots , I^0_n)\) gives a submanifold \(\mathbb {T}^n\times B \subset \mathbb {T}^n \times \mathbb {R}^n\).
</p>
<div class="amsthmbodyplain">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-328"></a>
<span class="amsthmnameplain">Theorem</span><span class="amsthmnumberplain"> <span class="textup">4.15</span></span>.                            Under the hypotheses of the Liouville-Arnold theorem (Theorem&nbsp;<a
href="chapter-4.html#thm:liouvillearnold">4.12</a>), for every compact connected component \(M_{E^0}\) there are a neighborhood \(M_{E^0}\subseteq U = U(M_{E^0}) \subseteq \mathbb {R}^{2n}\) and a symplectomorphism
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{184}\)</span>

<!--



                                                                                                                     Tn × B → U (ME 0 )                                                                                  (4.185)

-->

<p>


\begin{equation}
\mathbb {T}^n\times B \to U(M_{E^0})
\end{equation}


</p>

<p>
such that the hamiltonians become exclusively functions of the <em>action coordinates</em> \(I = (I_1, \ldots , I_n)\),
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{185}\)</span>



<!--



                                                                                                     H1 = H1 (I), . . . , Hn = Hn (I),           I ∈ B,                                                                  (4.186)
                                                                                                             0
                                                                                                     Hk (I       ) = Ek0 ,   k = 1, . . . , n,                                                                           (4.187)



-->



<p>


\begin{align}
&amp; H_1 = H_1(I), \ldots , H_n = H_n(I), \quad I\in B, \\ &amp; H_k(I^0) = E^0_k, \quad k=1,\ldots ,n,
\end{align}
and for every \(I\in B\) the <em>angle coordinates</em> \(\phi =(\phi _1, \ldots , \phi _n)\) are the angular coordinates on the invariant torus \(M_E\), \(E = (H_1(I), \ldots , H_n(I))\).
</p>

</li>

</ul>

</div>
<div class="amsthmproof">

<a id="hm-autopage-329"></a>

<ul style="list-style-type:none">



<li>
<p>
<span class="amsthmproofname">Proof.</span> We can start mimicking the first part of the proof of the Liouville-Arnold theorem.
</p>

<p>
Choosing a point \(x_0 = (q_0, p_0) \in M_{E^0}\) such that the \(p\)-Jacobian is non degenerate, we obtain a generating function \(S=S(q,E)\), with \(p = \frac {\partial S(q,E)}{\partial q}\), for the family of lagrangian submanifolds
\(M_E\). Locally, around \(x_0\), we can define \(\psi = \frac {\partial S(q,E)}{\partial E}\) to obtain a system of canonical coordinates \((\psi , E)\) with \(\dd p\wedge \dd q = \dd E\wedge \dd \psi \).
</p>

<p>
In the \(\psi \) coordinates, the hamiltonian flows \(\Phi _t^1, \ldots , \Phi _t^n\) generated by the hamiltonian vector fields \(X_{H_1}, \ldots , X_{H_n}\) are translations along the respective coordinate axis \(\phi _1, \ldots , \phi
_n\). Thus, the local coordinates \(\phi _1, \ldots , \phi _n\) are related to the <em>global</em> angular coordinates \(\phi _1, \ldots , \phi _n\) on the same torus \(M_E\) via a non–degenerate linear transformation:
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{187}\)</span>

<!--


                                                                                                               X
                                                                                                               n
                                                                                                      ψi =           ρij (E)ϕj ,       i = 1, . . . , n,      det(ρij ) 6= 0.                                                                     (4.188)
                                                                                                               j=1


-->

<p>


\begin{equation}
\psi _i = \sum _{j=1}^n \rho _{ij}(E)\phi _j, \quad i=1,\ldots ,n, \qquad \det (\rho _{ij})\neq 0.
\end{equation}


</p>

<p>
Since for every \(k\) the shift \(\phi _k \mapsto \phi _k + 2\pi \) is the identity on every \(M_E\) (in a neighborhood of \(M_{E^0}\)), then the translation
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{188}\)</span>

<!--


                                                                                                                                                                    
                                                                                                   ψ1 , . . . , ψ n , E →7 ψ1 + 2πρ1k (E), . . . , ψn + 2πρnk (E), E                                                                              (4.189)

-->

<p>


\begin{equation}
\big (\psi _1, \ldots , \psi _n, E\big ) \mapsto \big (\psi _1 + 2\pi \rho _{1k}(E), \ldots , \psi _n + 2\pi \rho _{nk}(E), E\big )
\end{equation}


</p>

<p>
is a canonical transformation. Then, in particular, we have
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{189}\)</span>

<!--


                                                                                                                                
                                                                                                 ψi + 2πρik (E), ψj + 2πρjk (E) = ψi , ψj = 0,                          i, j = 1, . . . , n,                                                      (4.190)

-->

<p>


\begin{equation}
\big \{ \psi _i + 2\pi \rho _{ik}(E), \psi _j + 2\pi \rho _{jk}(E) \big \} = \big \{\psi _i, \psi _j\big \} = 0, \quad i,j = 1, \ldots , n,
\end{equation}


</p>

<p>
and, for all \(i,j,k\),
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{190}\)</span>

<!--


                                                                                                                               ∂ρik (E)   ∂ρjk (E)
                                                                                                                                        =          .                                                                                              (4.191)
                                                                                                                                 ∂Ej        ∂Ei

-->

<p>


\begin{equation}
\frac {\partial \rho _{ik}(E)}{\partial E_j} = \frac {\partial \rho _{jk}(E)}{\partial E_i}.
\end{equation}


</p>

<p>
Therefore, locally around \(E^0\) there are functions \(I_1 = I_1(E), \ldots , I_2 = I_2(E)\) such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{191}\)</span>

<!--


                                                                                                                                  ∂Ik (E)
                                                                                                                 ρik (E) =                ,      i, k = 1, . . . , n,                                                                             (4.192)
                                                                                                                                   ∂Ei

-->

<p>


\begin{equation}
\rho _{ik}(E) = \frac {\partial I_k(E)}{\partial E_i}, \quad i,k=1,\ldots ,n,
\end{equation}


</p>

<p>
and, thanks to the non–degeneracy of the matrix \(\rho _{ij}(E)\), the change of coordinates \(E \mapsto I(E)\) is a local diffeomorphism.
</p>

<p>
We need to show that the functions \((\phi _1, \ldots , \phi _n, I_1, \ldots , I_n)\) that we just defined are the canonical coordinates. Using the fact that \((\psi , E)\) are canonical, we have
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{192}\)</span>

<!--


                                                                                                                                          ∂Ik
                                                                                                                              ψi , I k =       = ρik (E).                                                                                         (4.193)
                                                                                                                                           ∂Ei

-->

<p>


\begin{equation}
\big \{\psi _i, I_k\big \} = \frac {\partial I_k}{\partial E_i} = \rho _{ik}(E).
\end{equation}


</p>

<p>
On the other hand, using the substitution \(\psi _i = \sum _{j=1}^n \rho _{ij}(E)\phi _j\), one gets
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{193}\)</span>

<!--


                                                                                                                                      X
                                                                                                                                       n
                                                                                                                                                    
                                                                                                                          ψi , I k =         ρij (E) ϕj , Ik .                                                                                    (4.194)
                                                                                                                                       j=1


-->

<p>


\begin{equation}
\big \{\psi _i, I_k\big \} = \sum _{j=1}^n \rho _{ij}(E) \big \{\phi _j, I_k\big \}.
\end{equation}


</p>

<p>
A direct comparison of the last two equations yields the desired result, i.e.
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{194}\)</span>

<!--


                                                                                                                     
                                                                                                                         ϕj , Ik = δjk ,       j, k = 1, . . . , n.                                                                               (4.195)

-->

<p>


\begin{equation}
\big \{\phi _j, I_k\big \} = \delta _{jk}, \quad j,k=1,\ldots ,n.
\end{equation}


</p>

<p>
<span class="theoremendmark">&#x25A1;</span>
</p>

</li>

</ul>

</div>

<p>
For an alternative proof, you can refer to [<a href="index.html#??">Kna18</a>, Chapter 13.3].
</p>

<p>
As anticipated in the previous section, a completely integrable hamiltonian system with Hamiltonian \(H = H(q,p)\) in action–angle coordinates takes an extremely simple form:
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{195}\)</span>

<!--

                                                                                                                                                    ∂H(I)
                                                                                                    I˙k = 0,    ϕ̇k = ωk (I),          ωk (I) =           ,      k = 1, . . . , n,                                                                (4.196)
                                                                                                                                                     ∂Ik

-->

<p>

\begin{equation}
\dot I_k = 0, \quad \dot \phi _k = \omega _k(I), \quad \omega _k(I) = \frac {\partial H(I)}{\partial I_k}, \quad k=1,\ldots ,n,
\end{equation}

</p>

<p>
with \(H(I)\) being only a function of the canonical actions. Such equations are immediately integrated, yielding
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{196}\)</span>

<!--


                                                                                                    Ik (t) = Ik (0),          ϕk (t) = ϕk (0) + ωk (I)t,         k = 1, . . . , n.                                                                (4.197)

-->

<p>

\begin{equation}
I_k(t)= I_k(0), \quad \phi _k(t) = \phi _k(0) + \omega _k(I)t, \quad k = 1,\ldots , n.
\end{equation}

</p>

<p>
It is important to stress the importance of the canonical actions \(I_1, \ldots , I_n\). If we were sticking to our first integrals \(H_1, \ldots , H_n\), we would have had two “troubles” to deal with: first of all the flows generated by \(H_k\)
affect all the angle variables, and not just \(\phi _k\), secondly the coordinates \((\phi , E)\) would not in general be canonical.
</p>

<p>
Furthermore, due to their simplicity, the action–angle coordinates are the ideal starting point for the development of perturbation theory.
</p>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-330"></a>
<span class="amsthmnamedefinition">Remark</span><span class="amsthmnumberdefinition"> <span class="textup">4.8</span></span>.                                                      <a id="rmk:nonresonant"></a> Consider the (inverse) canonical transformation
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{197}\)</span>

<!--



                                                                                                         qk = qk (ϕ, I),           pk = pk (ϕ, I),             k = 1, . . . , n.                                                                                  (4.198)

-->

<p>


\begin{equation}
q_k = q_k(\phi , I), \quad p_k = p_k(\phi , I), \quad k=1,\ldots ,n.
\end{equation}


</p>

<p>
The smooth functions \(q\) and \(p\) are \(2\pi \)-periodic with respect to any of the angular variables \(\phi = (\phi _1, \ldots , \phi _n)\), and therefore they can be expanded in Fourier series:
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{198}\)</span>



<!--


                                                                                                            X                                                        X
                                                                                              xj =                          Ajk (I)ei(k1 ϕ1 +···+kn ϕn ) =                 Ajk (I)ei⟨k,ϕ⟩                                                                         (4.199)
                                                                                                     k=(k1 ,...,kn   )∈Zn                                           k∈Zn

                                                                                              x = (q, p),     j = 1, . . . , 2n.                                                                                                                                  (4.200)



-->



<p>


\begin{align}
&amp; x_j = \sum _{\vb * k = (k_1, \ldots , k_n)\in \mathbb {Z}^n} A^j_{\vb * k}(I) e^{i(k_1 \phi _1 + \cdots + k_n \phi _n)} = \sum _{\vb * k\in \mathbb {Z}^n} A^j_{\vb * k}(I) e^{i\langle \vb * k, \phi \rangle }
\\ &amp; x = (q,p), \quad j=1,\ldots ,2n.
\end{align}
Then, the dynamics of the hamiltonian system in the original coordinates is of the form
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{200}\)</span>



<!--


                                                                                                                              X                                        0
                                                                                                               xj (t) =               Ajk (I)eit⟨k,ω(I)⟩+i⟨k,ϕ ⟩                                                                                                  (4.201)
                                                                                                                             k∈Zn

                                                                                                               x = (q, p),            j = 1, . . . , 2n,                                                                                                          (4.202)



-->



<p>


\begin{align}
&amp; x_j(t) = \sum _{\vb * k\in \mathbb {Z}^n} A^j_{\vb * k}(I) e^{i t\langle \vb * k, \omega (I)\rangle + i\langle \vb * k,\phi ^0\rangle } \\ &amp; x = (q,p), \quad j=1,\ldots ,2n,
\end{align}
where \(\omega (I) = (\omega _1(I), \ldots , \omega _n(I))\) and the parameters \(I = (I_1, \ldots , I_n)\) and \(\phi ^0 = (\phi _1^0, \ldots , \phi _n^0)\) can be considered as constants of integration.
</p>

<p>
The solutions \(x(t) = (q(t), p(t))\) are periodic in \(t\) (and the period does not depend on the parameter \(\phi ^0\)) if the frequencies \(\omega (I)\) are rationally dependent, i.e., if there is \((k_1, \ldots , k_n)\in \mathbb {Z}^d\)
such that \(k_1\omega _1(I) + \ldots + k_n \omega _n(I) = 0\). If, instead, the frequencies are rationally independent, or <em>non–resonant</em>, then the trajectories are <em>dense</em> on the invariant torus \(M_{E(I)}\).
</p>

</li>

</ul>

</div>

<p>
What we have seen so far seems very abstract, however there is a practical and direct approach to make computations in the action–angle variables that also helps clarifying the first half of the name.
</p>

<p>
Since \(\dd {p} \wedge \dd {q} = \dd {I} \wedge \dd {phi}\), the difference \(p\dd q - I\dd \phi \) is a closed one–form on the neighborhood \(U(M_{E^0})\). Thus, locally,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{202}\)</span>

<!--


                                                                                                                               p dq − I dϕ = dS                                                                                                                   (4.203)

-->

<p>

\begin{equation}
p\dd {q} - I\dd {\phi } = \dd {S}
\end{equation}

</p>

<p>
for some generating function \(S = S(q,\phi )\). Consider the fundamental cycles \(\gamma _1, \ldots , \gamma _n\) on \(\mathbb {T}^n\),
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{203}\)</span>

<!--

                                                                                                   
                                                                                               γk = (ϕ1 , . . . , ϕn ) ∈ Tn | ϕj = const, j 6= k, ϕk ∈ [0, 2π] ,                                                                                                  (4.204)

-->

<p>

\begin{equation}
\gamma _k = \big \{ (\phi _1, \ldots , \phi _n) \in \mathbb {T}^n \;\mid \; \phi _j = \mathrm {const}, \; j\neq k,\; \phi _k \in [0,2\pi ] \big \},
\end{equation}

</p>

<p>
where \(k=1,\ldots ,n\). Integrating \(\dd S\) on the cycle \(\gamma _i\) one obtains
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{204}\)</span>

<!--

                                                                                                                                 I
                                                                                                                             1
                                                                                                                 Ik =                     p dq ,     k = 1, . . . , n.                                                                                            (4.205)
                                                                                                                            2π       γk


-->

<p>

\begin{equation}
I_k = \frac 1{2\pi } \oint _{\gamma _k} p \dd {q}, \quad k=1,\ldots ,n.
\end{equation}

</p>

<p>
This formula, that looks like Maupertuis action, can be used to compute the canonical actions. To compute the conjugate angles, we use the generating function \(\widetilde S = \widetilde S(q,I)\) of the canonical transformation \((q,p)
\mapsto (\phi , I)\). That is, the function such that
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{205}\)</span>

<!--


                                                                                                                              dSe = p dq − ϕ dI .                                                                                                                 (4.206)

-->

<p>

\begin{equation}
\dd {\widetilde {S}} = p\dd {q} - \phi \dd {I}.
\end{equation}

</p>

<p>
Since \(I = I(E)\), a restriction of the closed one–form \(\dd {\widetilde S}\) on the torus \(M_E\) can be written as \(\dd {\widetilde S}\big |_{M_E} = p\dd {q}\) and, therefore,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{206}\)</span>

<!--

                                                                                                                             Z (q,p(q,E))
                                                                                                             e I) =
                                                                                                             S(q,                                  p dq ,    E = E(I),                                                                                            (4.207)
                                                                                                                                 x0 (q,E)


-->

<p>

\begin{equation}
\widetilde S(q,I) = \int _{x_0(q,E)}^{(q, p(q,E))} p \dd {q}, \quad E = E(I),
\end{equation}

</p>

<p>
where the integral along a path on \(M_E\) <em>locally</em> does not depend on the choice of the path itself (globally this is generally false, a clarification would require a discussion of holonomy). Thus, the canonical angles can be determined as
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{207}\)</span>

<!--

                                                                                                                             Z (q,p(q,E))
                                                                                                                       ∂
                                                                                                            ϕk =                               pdq,         k = 1, . . . , n.                                                                                     (4.208)
                                                                                                                      ∂Ik     x0 (q,E)


-->

<p>

\begin{equation}
\phi _k = \frac {\partial }{\partial I_k} \int _{x_0(q,E)}^{(q, p(q,E))} p \dd q, \quad k=1,\ldots ,n.
\end{equation}

</p>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-331"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">4.9</span></span><span class="amsthmnotedefinition"> (Harmonic oscillator)</span>.                Consider, once again, the
hamiltonian of a harmonic oscillator with mass \(m\) and stiffness \(k&gt;0\):
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{208}\)</span>

<!--


                                                                                                                                       p2   kq 2
                                                                                                                       H(q, p) =          +      .                                                                                   (4.209)
                                                                                                                                       2m    2

-->

<p>


\begin{equation}
H(q,p) = \frac {p^2}{2m} + \frac {k q^2}{2}.
\end{equation}


</p>

<p>
We have seen a long time ago that for \(E&gt;0\) the curve \(H(q,p) = E\) is an ellipse and the motion on the ellipse is periodic with period
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{209}\)</span>

<!--

                                                                                                                                           r
                                                                                                                                 2π            m
                                                                                                                           T =      = 2π         .                                                                                   (4.210)
                                                                                                                                 ω             k

-->

<p>


\begin{equation}
T = \frac {2\pi }{\omega } = 2\pi \sqrt {\frac {m}{k}}.
\end{equation}


</p>

<p>
The canonical action variable
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{210}\)</span>

<!--

                                                                                                                                  I
                                                                                                                              1
                                                                                                                       I=                        pdq                                                                                 (4.211)
                                                                                                                             2π       H(q,p)=E


-->

<p>


\begin{equation}
I = \frac 1{2\pi }\oint _{H(q,p) = E} p \dd q
\end{equation}


</p>

<p>
is proportional to the area of the ellipse:
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{211}\)</span>

<!--

                                                                                                                                                     r
                                                                                                              1            p2   kq 2                       m  E
                                                                                                        I=      area          +      =E          =E          = .                                                                     (4.212)
                                                                                                             2π            2m    2                         k  ω

-->

<p>


\begin{equation}
I = \frac 1{2\pi } \mathrm {area}\left (\frac {p^2}{2m} + \frac {k q^2}{2} = E\right ) = E \sqrt {\frac {m}{k}} = \frac E \omega .
\end{equation}


</p>

<p>
The variable conjugate to \(I\), is generally non-trivial to obtain. In this case, it is obtained from the canonical transformation
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{212}\)</span>

<!--


                                                                                                              √                             √                      √
                                                                                                 q(I, ϕ) = ρ−1 2I cos ϕ,         p(I, ϕ) = ρ 2I sin ϕ,       ρ=        mω.                                                           (4.213)

-->

<p>


\begin{equation}
q(I, \phi ) = \rho ^{-1} \sqrt {2I} \cos \phi , \quad p(I, \phi ) = \rho \sqrt {2I} \sin \phi , \quad \rho = \sqrt {m \omega }.
\end{equation}


</p>

<p>
The change of coordinates \((q,p) \mapsto (I, \phi )\) maps the phase space flow onto a cylinder parametrized by \((I, \phi )\) so that the flows are now all straight lines in the new coordinates.
</p>

<p>
If you recall Example&nbsp;<a href="chapter-4.html#ex:integrabilityho">4.2</a> you can now see what we were doing. The construction in Example&nbsp;<a href="chapter-4.html#ex:integrabilitypho">4.7</a> is also not dissimilar: if
you observe that \(\dot W_i = \frac {\partial W_i}{\partial q^i} \dot q^i = p_i \dot q^i\), then you get \(W_i = \oint p_i\dd q^i\) which hints at the role of the \(W_i\) of the separated generating function in the context of the
action–angle variables.
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-332"></a>
<span class="amsthmnamedefinition">Example</span><span class="amsthmnumberdefinition"> <span class="textup">4.10</span></span><span class="amsthmnotedefinition"> (Kepler problem – elliptic motion)</span>.                              Let’s consider
once again the Kepler problem for negative energies and, therefore, elliptic motions. For conciseness, we assume that the system is already reduced to the planar system. In this case, the invariant tori are two dimensional:
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{213}\)</span>



<!--



                                                                                                                      pϕ = mr2 ϕ̇ = M                                                                                                               (4.214)
                                                                                                                       p2r           p2ϕ         k
                                                                                                                              +              −     = E < 0,                                                                                         (4.215)
                                                                                                                      2m            2mr2         r



-->



<p>


\begin{align}
&amp; p_\phi = m r^2 \dot \phi = M \\ &amp; \frac {p_r^2}{2 m} + \frac {p_\phi ^2}{2 m r^2} - \frac {k}{r} = E &lt;0,
\end{align}
where \((r,\phi )\) are polar coordinates on the orbit plane and the constants \((M,E)\), the angular momentum and the energy, parametrize the torus. The canonical actions, then, are
</p>
<span class="hidden"> \(\seteqnumber{0}{4.}{215}\)</span>



<!--


                                                                                                                      Z 2π
                                                                                                                   1
                                                                                                             Iϕ =          pϕ dϕ = M                                                                                                                (4.216)
                                                                                                                  2π 0
                                                                                                                      Z rmax
                                                                                                                   2
                                                                                                             Ir =            pr dr                                                                                                                  (4.217)
                                                                                                                  2π rmin
                                                                                                                     Z rmax p
                                                                                                                  1
                                                                                                                =              2m(E + k/r) − M 2 /r2 dr                                                                                             (4.218)
                                                                                                                  π rmin
                                                                                                                           r
                                                                                                                               m
                                                                                                                = −M + k           ,                                                                                                                (4.219)
                                                                                                                              2|E|



-->



<p>


\begin{align}
I_\phi &amp; = \frac {1}{2\pi } \int _0^{2\pi } p_\phi \dd \phi = M \\ I_r &amp; = \frac {2}{2\pi } \int _{r_{\mathrm {min}}}^{r_{\mathrm {max}}} p_r \dd r \\ &amp; = \frac 1\pi \int _{r_{\mathrm
{min}}}^{r_{\mathrm {max}}} \sqrt {2m(E + k/r) - M^2/r^2}\dd r \\ &amp; = - M + k \sqrt {\frac {m}{2|E|}},
\end{align}
where the latter follows from the identity
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{219}\)</span>

<!--

                                                                                                 Z rM r 
                                                                                                                    rm   rM        π              √
                                                                                                             1−               − 1 dr = (rm + rM ) − π rm rM .                                                                                       (4.220)
                                                                                                  rm                 r      r         2

-->

<p>


\begin{equation}
\int _{r_{m}}^{r_{M}} \sqrt {\left (1-\frac {r_m}r\right )\left (\frac {r_M}r-1\right )}\dd r = \frac {\pi }2(r_m + r_M) - \pi \sqrt {r_m r_M}.
\end{equation}


</p>

<p>
Then, the hamiltonian in the action angle variables takes the form
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{220}\)</span>

<!--


                                                                                                                                              mk2
                                                                                                                             H=−                        .                                                                                           (4.221)
                                                                                                                                           2(Ir + Iϕ )2

-->

<p>


\begin{equation}
H = - \frac {mk^2}{2(I_r + I_\phi )^2}.
\end{equation}


</p>

<p>
Observe that \(H\) is symmetric in the actions. This means that the associated frequencies,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{221}\)</span>

<!--


                                                                                                                                    ∂H                  ∂H
                                                                                                                        ωϕ =            ,        ωr =       ,                                                                                       (4.222)
                                                                                                                                    ∂Iϕ                 ∂Ir

-->

<p>


\begin{equation}
\omega _\phi = \frac {\partial H}{\partial I_\phi }, \quad \omega _r = \frac {\partial H}{\partial I_r},
\end{equation}


</p>

<p>
coincide for all values of \((M,E)\): they are degenerate. Which, in particular, means that the trajectories are always periodic.
</p>

<p>
This has major consequences in the quantum mechanics of the hydrogen atom. The actions are all quantized as integer multiples of Planck’s constant: from the formula above, the energy depends only on the sum of the quantum numbers. Thus,
above the ground state, energy levels are degenerate, which is why the energy spectrum of the hydrogen atom has the simple form so well explained by the Bohr model.
</p>

<p>
Recall the parametrization of the ellipse from <span class="textup">(<a href="chapter-2.html#eq:KeplerConic">2.129</a>)</span>, where the eccentricity, the focal parameter and the semiaxes of the ellipse where given respectively by
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{222}\)</span>

<!--

                                                                                                    r
                                                                                                             2EM 2                  M2                p                     p
                                                                                               e=       1+         ,         p=        ,       a=          ,      b= √           ,                                                                  (4.223)
                                                                                                              mk2                   mk              1 − e2                1 − e2

-->

<p>


\begin{equation}
e = \sqrt {1+ \frac {2EM^2}{mk^2}}, \quad p = \frac {M^2}{mk}, \quad a = \frac {p}{1-e^2}, \quad b = \frac {p}{\sqrt {1-e^2}}, \quad
\end{equation}


</p>

<p>
We can derive the following identities,
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{223}\)</span>

<!--

                                                                                                                                                                 
                                                                                                                             k                            Iϕ
                                                                                                                  |E| =         ,    e2 = 1 −                         ,                                                                             (4.224)
                                                                                                                             2a                         Iϕ + Ir

-->

<p>


\begin{equation}
|E| = \frac {k}{2a}, \quad e^2 = 1 - \left (\frac {I_\phi }{ I_\phi + I_r}\right ),
\end{equation}


</p>

<p>
which imply
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{224}\)</span>

<!--


                                                                                                                    b  p           Iϕ      |m|
                                                                                                                      = 1 − e2 =         =                                                                                                          (4.225)
                                                                                                                    a            Iϕ + Ir    n

-->

<p>


\begin{equation}
\frac {b}{a} = \sqrt {1-e^2} = \frac {I_\phi }{I_\phi + I_r} = \frac {|m|}{n}
\end{equation}


</p>

<p>
where the last equality is just a rewriting using the notation for the hydrogen quantum numbers: \(|m| \leq n\) is the orbital quantum number, \(n\) is the principal quantum number and the energy is \(E_n \sim n^{-2}\).
</p>

<p>
Compare this example with Example&nbsp;<a href="chapter-4.html#ex:kepler3dseparable">4.8</a>. It is instructive to derive the action–angle coordinates for the general system in \(\mathbb {R}^3\) using this procedure or the separation of
variables. The energy will have a similar form with the denominator including \(I_\theta \) in the sum and thus three degenerate frequencies. Reasoning on the frequencies and the actions, you can identify 5 constants of motion, which can be
associated to the angular momentum vector, the energy and the Laplace-Runge-Lenz vector. With some algebra, these constants can be associated to the five parameters of the planetary orbit: inclination angle, longitude of the ascending node,
semi–major axis, eccentricity and the angle of orientation in the orbital plane. You can read much more about this and how it is useful in perturbation theory, like the spin–orbit problem or the various restricted three-body problems, in [<a
href="index.html#??">AKN06</a>] or [<a href="index.html#??">Arn10</a>].
</p>

</li>

</ul>

</div>
<div class="amsthmbodydefinition">

<ul style="list-style-type:none">



<li>
<p>
<a id="hm-autopage-333"></a>
<span class="amsthmnamedefinition">Exercise</span><span class="amsthmnumberdefinition"> <span class="textup">4.9</span></span><span class="amsthmnotedefinition"> (Anharmonic oscillator)</span>.   Consider the following
hamiltonian system with one degree of freedom for a point particle of mass \(m\):
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{225}\)</span>

<!--


                                                                                                            p2           q
                                                                                                H(q, p) =      + V0 tan2     ,                                                                                           (4.226)
                                                                                                            2m            α

-->

<p>


\begin{equation}
H(q,p) = \frac {p^2}{2m} + V_0 \tan ^2\left (\frac {q}{\alpha }\right ),
\end{equation}


</p>

<p>
where \(V_0&gt;0\) and \(\alpha &gt;0\) are given constants.
</p>

<p>
Compute the action variable \(I\) and show that the energy \(E = E(I)\) is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{226}\)</span>

<!--

                                                                                                                 √
                                                                                                         I(I + 2α 2mV0 )
                                                                                                  E(I) =                 .                                                                                               (4.227)
                                                                                                              2mα2

-->

<p>


\begin{equation}
E(I) = \frac {I (I + 2\alpha \sqrt {2m V_0})}{2m\alpha ^2}.
\end{equation}


</p>

<p>
Verify that the period of the motion is
</p>

<span class="hidden"> \(\seteqnumber{0}{4.}{227}\)</span>

<!--


                                                                                                                 4πmα2
                                                                                                    T (I) =        √                                                                                                     (4.228)
                                                                                                              I − α 2mV0

-->

<p>


\begin{equation}
T(I) = \frac {4 \pi m \alpha ^2}{I - \alpha \sqrt {2mV_0}}
\end{equation}


</p>

<p>
and compute the angular variable.
</p>

</li>

</ul>

</div>

</section>

</main>

</div>


<nav class="botnavigation"><a href="index.html" class="linkhome" >
Home</a></nav>

</body>
</html>
